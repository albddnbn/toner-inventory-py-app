<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 13.1.1"/>
    <title>main API documentation</title>
            <link rel="icon" href="../../img/favicon.ico"/>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="index.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;
                Module Index
            </a>

<a href="../guide.html">            <img src="../../img/stock-ink-img.png" class="logo" alt="project logo"/>
</a>
            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#StackedApp">StackedApp</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#StackedApp.__init__">StackedApp</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.fill_columns">fill_columns</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.show_home_page">show_home_page</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.show_table_page">show_table_page</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.show_dashboard_page">show_dashboard_page</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.populate_dashboard">populate_dashboard</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.open_help_dialog">open_help_dialog</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.open_search_dialog">open_search_dialog</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.open_settings_dialog">open_settings_dialog</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.set_home_title">set_home_title</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.open_in_browser">open_in_browser</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.open_theme_dialog">open_theme_dialog</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.set_theme">set_theme</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.open_scan_dialog">open_scan_dialog</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.open_column_dialog">open_column_dialog</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.set_columns">set_columns</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.handle_item_dialog">handle_item_dialog</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.export_to_excel">export_to_excel</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.import_item_list">import_item_list</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.query_database">query_database</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.insert_into_db">insert_into_db</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.edit_db_item">edit_db_item</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.insert_item">insert_item</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.edit_app_item">edit_app_item</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.delete_from_db">delete_from_db</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.search_db_mode">search_db_mode</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.backup_to_csv">backup_to_csv</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.build_qcompleters">build_qcompleters</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.build_tray">build_tray</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.gen_notification">gen_notification</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.change_table_columns">change_table_columns</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.change_icon_colors">change_icon_colors</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.reset_database">reset_database</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.check_for_duplicates_popup">check_for_duplicates_popup</a>
                        </li>
                        <li>
                                <a class="function" href="#StackedApp.check_for_duplicates_action">check_for_duplicates_action</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MainWindowShell">MainWindowShell</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MainWindowShell.__init__">MainWindowShell</a>
                        </li>
                        <li>
                                <a class="function" href="#MainWindowShell.build_menu">build_menu</a>
                        </li>
                        <li>
                                <a class="function" href="#MainWindowShell.closeEvent">closeEvent</a>
                        </li>
                </ul>

            </li>
    </ul>


            <footer>Printer Inventory App 1.0.1 - abuddenb - 05-08-23</footer>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
main    </h1>

                
                        <input id="mod-main-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-main-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="kn">import</span> <span class="nn">sys</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="kn">import</span> <span class="nn">yaml</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="kn">import</span> <span class="nn">webbrowser</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a>    <span class="n">QMainWindow</span><span class="p">,</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a>    <span class="n">QApplication</span><span class="p">,</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a>    <span class="n">QStackedWidget</span><span class="p">,</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a>    <span class="n">QCompleter</span><span class="p">,</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a>    <span class="n">QAction</span><span class="p">,</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a>    <span class="n">QPushButton</span><span class="p">,</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a>    <span class="n">QVBoxLayout</span><span class="p">,</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a>    <span class="n">QWidget</span><span class="p">,</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a>    <span class="n">QSystemTrayIcon</span><span class="p">,</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a>    <span class="n">QMenu</span><span class="p">,</span> <span class="n">QFileDialog</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QComboBox</span><span class="p">,</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a>    <span class="n">QDialog</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QSystemTrayIcon</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="p">)</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">QSize</span><span class="p">,</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QModelIndex</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="kn">import</span> <span class="n">QColor</span><span class="p">,</span> <span class="n">QColor</span><span class="p">,</span> <span class="n">QIcon</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="kn">import</span> <span class="nn">qtawesome</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="c1"># Application-specific imports</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="kn">from</span> <span class="nn">widgets.radialframe</span> <span class="kn">import</span> <span class="n">RadialFrame</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="kn">from</span> <span class="nn">widgets.dialogs</span> <span class="kn">import</span> <span class="n">ColumnSelection</span><span class="p">,</span> <span class="n">FindItemDialog</span><span class="p">,</span> <span class="n">HelpPopup</span><span class="p">,</span> <span class="n">ItemPopup</span><span class="p">,</span> <span class="n">ApiLookup</span><span class="p">,</span> <span class="n">SearchColumnsPopup</span><span class="p">,</span> <span class="n">ThemePopup</span><span class="p">,</span> <span class="n">WarningPopup</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="kn">from</span> <span class="nn">widgets.barcodescan</span> <span class="kn">import</span> <span class="n">ScanInputWindow</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="kn">from</span> <span class="nn">widgets.columnchoices</span> <span class="kn">import</span> <span class="n">ColumnEdit</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="kn">from</span> <span class="nn">widgets.layouts</span> <span class="kn">import</span> <span class="n">HomeLayout</span><span class="p">,</span> <span class="n">TableLayout</span><span class="p">,</span> <span class="n">DashboardLayout</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="kn">from</span> <span class="nn">widgets.itemframe</span> <span class="kn">import</span> <span class="n">ItemFrame</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="kn">from</span> <span class="nn">widgets.settingsdialog</span> <span class="kn">import</span> <span class="n">SettingsPopup</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="kn">from</span> <span class="nn">widgets.tonertoolbar</span> <span class="kn">import</span> <span class="n">TonerToolbar</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="kn">from</span> <span class="nn">utils.toner_utils</span> <span class="kn">import</span> <span class="n">connect_to_db</span><span class="p">,</span> <span class="n">initialize_config</span><span class="p">,</span> <span class="n">write_log</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="kn">from</span> <span class="nn">utils.createreport</span> <span class="kn">import</span> <span class="n">ReportDialog</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="kn">from</span> <span class="nn">utils.backup_to_csv</span> <span class="kn">import</span> <span class="n">DataBackup</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="kn">from</span> <span class="nn">utils.upclookup</span> <span class="kn">import</span> <span class="n">ItemLookup</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="kn">from</span> <span class="nn">utils.fillout_columns</span> <span class="kn">import</span> <span class="n">DBHousekeeping</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="k">class</span> <span class="nc">StackedApp</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span><span class="n">QMainWindow</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="sd">        __init__ This is the main QWidget used by the app GUI. The QMainWindow is just a shell that holds this widget, because QMainWindows come with the main menubars built-in and made building the GUI easier.</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="sd">        The main widget inside of this class, is saved in the &#39;stack&#39; property, which is a QStackedWidget. This widget is used to switch between the three main pages of the app: home, table, and dashboard using the statement: self.stack.setCurrentIndex(index).</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="sd">        Args:</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="sd">            parent (QMainWindow, optional): _description_. Defaults to None.</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">StackedApp</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a>        <span class="n">initialize_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>        <span class="c1"># this dictionary is to change the menubar icon colors, based on whether the user has a light or dark theme set:</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">icon_strings</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>            <span class="s2">&quot;search&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;fa5s.search&quot;</span><span class="p">],</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a>            <span class="s2">&quot;reset&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi6.database-refresh&quot;</span><span class="p">],</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a>            <span class="s2">&quot;import&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi.import&quot;</span><span class="p">],</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a>            <span class="s2">&quot;home&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi.home&quot;</span><span class="p">],</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>            <span class="s2">&quot;insert&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi.plus-box-outline&quot;</span><span class="p">],</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a>            <span class="s2">&quot;edit&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi6.database-edit-outline&quot;</span><span class="p">],</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a>            <span class="s2">&quot;theme&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi6.monitor-eye&quot;</span><span class="p">],</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>            <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ri.insert-column-left&quot;</span><span class="p">],</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>            <span class="s2">&quot;settings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi6.cog&quot;</span><span class="p">],</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>            <span class="s2">&quot;about&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi.information-outline&quot;</span><span class="p">]</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>        <span class="p">}</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>        <span class="c1"># create the three QWidgets</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_page</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_page</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_page</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tray_icon</span><span class="p">,</span> <span class="n">tray_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_tray</span><span class="p">()</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span> <span class="o">=</span> <span class="n">QStackedWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a>        <span class="c1"># set each qwidgets layout to be the corresponding page</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span> <span class="o">=</span> <span class="n">HomeLayout</span><span class="p">()</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_page</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="p">)</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span> <span class="o">=</span> <span class="n">TableLayout</span><span class="p">()</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">rowclicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_app_item</span><span class="p">)</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_page</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="p">)</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span> <span class="o">=</span> <span class="n">DashboardLayout</span><span class="p">()</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_page</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="p">)</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">home_page</span><span class="p">)</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_page</span><span class="p">)</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dashboard_page</span><span class="p">)</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a>        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>        <span class="c1"># set up qcompleters for the textbox on home window</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">printer_models_qcompleter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">codes_qcompleter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_qcompleters</span><span class="p">()</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>        <span class="c1"># TODO: attach either the printer models or item codes q completer based on user selection (will have to add buttons next to the QlineEdit on the home page or something similar)</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">setCompleter</span><span class="p">(</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">printer_models_qcompleter</span><span class="p">)</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">setCompleter</span><span class="p">(</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">printer_models_qcompleter</span><span class="p">)</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>        <span class="c1"># connections</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">completer</span><span class="p">()</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>            <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_dashboard_page</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;home&quot;</span><span class="p">))</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">search_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>            <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_dashboard_page</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;home&quot;</span><span class="p">))</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">search_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>            <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_dashboard_page</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;dashboard&quot;</span><span class="p">))</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>        <span class="c1"># connect the search bar button to search function</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>        <span class="c1"># if enter is pressed</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>        <span class="c1"># self.table_layout.search_bar.completer().activated.connect(</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>        <span class="c1">#     lambda: self.show_dashboard_page(window=&quot;home&quot;))</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">search_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_db_mode</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;table&quot;</span><span class="p">))</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>        <span class="c1"># connect main buttons on home layout</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">button</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>                <span class="n">button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>                    <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_table_page</span><span class="p">,</span> <span class="n">manufacturer</span><span class="o">=</span><span class="n">k</span><span class="p">))</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>        <span class="c1"># -- SET the THEME --</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">theme</span><span class="p">)</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_layout_assigned</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>        <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;APP START&quot;</span><span class="p">,</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>                  <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;Application started&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Application started&quot;</span><span class="p">,</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>                              <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Printer Supply App started&quot;</span><span class="p">)</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>    <span class="k">def</span> <span class="nf">fill_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a><span class="sd">        fill_columns run the fillout_columns.py utility in the utils folder. This file (the DBHousekeeping class) will try to fill in any empty or invalid values held by items for columns including brand, type, color, and possibly more.</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a><span class="sd">        fillout_columns.py can also be used independent of the application.</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>        <span class="n">DBHousekeeping</span><span class="p">()</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>        <span class="c1"># messagebox popup saying columns have been filled in as much as possible</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a>        <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columns have been filled in as much as possible.&quot;</span><span class="p">)</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Columns Filled&quot;</span><span class="p">)</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>        <span class="n">ok_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">)</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>        <span class="n">ok_button</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">35</span><span class="p">)</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="n">ok_button</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">AcceptRole</span><span class="p">)</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>    <span class="k">def</span> <span class="nf">show_home_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a><span class="sd">        show_home_page shows the main window of the application.</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a><span class="sd">        Displays the campus (set in config) above a QLineEdit (textbox) where the user can search by printer model. Four buttons are stacked beneath the textbox which lead to the app&#39;s spreadsheet view.</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>    <span class="k">def</span> <span class="nf">show_table_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">manufacturer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">table_query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a><span class="sd">        show_table_page displays the spreadsheet view of the stacked widget, index 1. The home page/view is index 0, and the dashboard view is index 2.</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a><span class="sd">        Using a QStackedWidget allows to easily change between the app&#39;s 3 different windows, and change the actual data that the windows use to display information as well.</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a><span class="sd">        Args:</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a><span class="sd">            manufacturer (str, optional): manufacturer of items being shown. &lt;b&gt;If this argument is supplied, it means one of the home page&#39;s buttons is being clicked, or one of the View options in menubar&lt;/b&gt;. Defaults to None.</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a><span class="sd">            table_query (str, optional): query that the app will use to populate the table with items. Defaults to None.</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>        <span class="n">column_str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>        <span class="c1"># if the manufacturer argument is supplied, it means either the main page buttons or the View &gt; Spreadsheet buttons are being clicked</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>        <span class="c1"># --------------------------------------------------------------------------------------------------------------------------------------</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>        <span class="k">if</span> <span class="n">manufacturer</span> <span class="ow">and</span> <span class="p">(</span><span class="n">manufacturer</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;others&quot;</span><span class="p">):</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">(</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>                <span class="n">query</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;SELECT </span><span class="si">{</span><span class="n">column_str</span><span class="si">}</span><span class="s2"> FROM inventory WHERE brand=&#39;</span><span class="si">{</span><span class="n">manufacturer</span><span class="si">}</span><span class="s2">&#39;;&quot;</span><span class="p">)</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>            <span class="k">if</span> <span class="n">manufacturer</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;hp&quot;</span><span class="p">:</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">manufacturer</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> Inventory&quot;</span><span class="p">)</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">manufacturer</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> Inventory&quot;</span><span class="p">)</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>        <span class="k">elif</span> <span class="n">manufacturer</span> <span class="ow">and</span> <span class="p">(</span><span class="n">manufacturer</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;others&quot;</span><span class="p">):</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">(</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>                <span class="n">query</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;SELECT </span><span class="si">{</span><span class="n">column_str</span><span class="si">}</span><span class="s2"> FROM inventory WHERE LOWER(brand) NOT IN (&#39;hp&#39;, &#39;lexmark&#39;, &#39;dell&#39;)&quot;</span><span class="p">)</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">manufacturer</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> Inventory&quot;</span><span class="p">)</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>        <span class="c1"># if the manufacturer argument is not supplied, but query is, use that to grab the table data</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>        <span class="k">elif</span> <span class="n">table_query</span><span class="p">:</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">table_query</span><span class="p">)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>            <span class="c1"># TODO: come up with better looking title than whats below</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Results: </span><span class="si">{</span><span class="n">table_query</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>        <span class="c1"># --------------------------------------------------------------------------------------------------------------------------------------</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>        <span class="c1"># set stacked widget to show the table view</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>        <span class="c1"># THE IF STATEMENT BELOW IS NECESSARY BECAUSE - without it, the table will make the doubleclicked connection to edit_app_item multiple times (every time the table page is reloaded)</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>        <span class="c1"># edit item dialog will popup more and more times</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_layout_assigned</span><span class="p">:</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">doubleClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_app_item</span><span class="p">)</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout_assigned</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>    <span class="k">def</span> <span class="nf">show_dashboard_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;home&quot;</span><span class="p">):</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a><span class="sd">        show_dashboard_page displays the second index of the QStackedWidget that the application uses - the dashboard view.</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a><span class="sd">        A printer model&#39;s &quot;dashboard&quot; will show all of the items held in inventory that are compatible with that printer model. It&#39;s a quick way to see if you have enough resources for a particular model, providing the compatible printers column of the inventory table has been filled out correctly.</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a><span class="sd">        Args:</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a><span class="sd">            window (str, optional): the window that the app is leaving to come into the dashboard view. Defaults to &quot;home&quot;.</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>        <span class="c1"># get the current text from the home layout search bar</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>        <span class="k">if</span> <span class="n">window</span> <span class="o">==</span> <span class="s2">&quot;home&quot;</span><span class="p">:</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>            <span class="n">home_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>            <span class="n">printer_model</span> <span class="o">=</span> <span class="n">home_model</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>            <span class="n">dash_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>            <span class="n">printer_model</span> <span class="o">=</span> <span class="n">dash_model</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>        <span class="c1"># check if printer model is in the qcompleter list - if it&#39;s not, it won&#39;t be a valid printer model from printers column in database</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>        <span class="k">if</span> <span class="n">printer_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer_models_qcompleter</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">stringList</span><span class="p">():</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>            <span class="k">if</span> <span class="n">printer_model</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;hp&quot;</span><span class="p">):</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>                <span class="n">model_name</span> <span class="o">=</span> <span class="n">printer_model</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>            <span class="k">elif</span> <span class="n">printer_model</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;dell&quot;</span><span class="p">):</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>                <span class="n">model_name</span> <span class="o">=</span> <span class="n">printer_model</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>            <span class="k">elif</span> <span class="n">printer_model</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;lexmark&quot;</span><span class="p">):</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>                <span class="n">model_name</span> <span class="o">=</span> <span class="n">printer_model</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>            <span class="k">elif</span> <span class="n">printer_model</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;brother&quot;</span><span class="p">):</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>                <span class="n">model_name</span> <span class="o">=</span> <span class="n">printer_model</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>                <span class="n">model_name</span> <span class="o">=</span> <span class="n">printer_model</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>            <span class="c1"># set title of dashboard padge</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">set_model_title</span><span class="p">(</span><span class="n">printer_model</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>            <span class="c1"># construct the query</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM inventory WHERE FIND_IN_SET(</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, LOWER(printers))&quot;</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>            <span class="c1"># query the database</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_database</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">populate_dashboard</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>    <span class="k">def</span> <span class="nf">populate_dashboard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a><span class="sd">        populate_dashboard function to populate the app&#39;s dashboard view with widgets. Toner and ink items have the colored radials as their widgets.</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a><span class="sd">        As of 5/6/23, other items like fusers, drums, waste containers, all use the same stock dashboard widget. &lt;b&gt;It&#39;d be great to get some help coming up with ideas for widgets for these item types!&lt;/b&gt;</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="sd">        Args:</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a><span class="sd">            results (list): a list of item dictionaries that the app will use to populate the dashboard with item widgets.</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">count</span><span class="p">())):</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>        <span class="n">toner_radials</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;radial_widgets&quot;</span><span class="p">):</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">radial_widgets</span><span class="p">:</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">radial_widgets</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">radial_widgets</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>        <span class="n">x2</span><span class="o">=</span><span class="mi">0</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>        <span class="n">y2</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>            <span class="c1"># if its toner or ink, create a circular progress bar (radial)</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;toner&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ink&quot;</span><span class="p">):</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>                <span class="c1"># this creates the frame that holds the radial / labels for a toner object</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>                <span class="n">toner_radials</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">RadialFrame</span><span class="p">(</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>                    <span class="n">item</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">())</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>                <span class="c1"># connect the radials signal to edit function</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>                <span class="n">toner_radials</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">userClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">edit_app_item</span><span class="p">)</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>                    <span class="n">toner_radials</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]],</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>                <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>                <span class="c1"># this (along with lines in elif statement) will try to separate the toner/ink radials from the other item widgets on the dashboard</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>                <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>                    <span class="n">y</span> <span class="o">+=</span> <span class="mi">2</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>                    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>            <span class="k">elif</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>                <span class="s2">&quot;drum&quot;</span><span class="p">,</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>                <span class="s2">&quot;fuser&quot;</span><span class="p">,</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>                <span class="s2">&quot;transfer&quot;</span><span class="p">,</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>                <span class="s2">&quot;waste&quot;</span><span class="p">,</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>                <span class="s2">&quot;developer&quot;</span><span class="p">,</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>                <span class="s2">&quot;cleaner&quot;</span><span class="p">,</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>                <span class="s2">&quot;roller&quot;</span><span class="p">,</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>                <span class="s2">&quot;toner&quot;</span><span class="p">,</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>                <span class="s2">&quot;paper&quot;</span><span class="p">,</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>            <span class="p">]:</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;aframe&quot;</span><span class="p">)</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>                <span class="n">aframe</span> <span class="o">=</span> <span class="n">ItemFrame</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">())</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>                <span class="c1"># aframe.userClicked.connect(self.edit_item)</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>                <span class="n">aframe</span><span class="o">.</span><span class="n">userClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_app_item</span><span class="p">)</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">aframe</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>                <span class="n">x2</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>                <span class="k">if</span> <span class="n">x2</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>                    <span class="n">y2</span> <span class="o">+=</span> <span class="mi">2</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>                    <span class="n">x2</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>    <span class="c1"># Opening dialogs/popups: help dialog, search, add item, edit item, etc.</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>    <span class="c1"># ----------------------------------------------------------------------------------------------------------</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>    <span class="k">def</span> <span class="nf">open_help_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;open_help_dialog Function opens the help dialog window&quot;&quot;&quot;</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>        <span class="n">help_dialog</span> <span class="o">=</span> <span class="n">HelpPopup</span><span class="p">()</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>        <span class="n">help_dialog</span><span class="o">.</span><span class="n">docs_clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_in_browser</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">docs_file</span><span class="p">))</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>        <span class="n">help_dialog</span><span class="o">.</span><span class="n">app_guide_clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_in_browser</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">guide_file</span><span class="p">))</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>        <span class="n">help_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>    <span class="k">def</span> <span class="nf">open_search_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a><span class="sd">        open_search_dialog opens the popup dialog that has a QComboBox, QLineEdit, and QPushButton, so the user can choose a column and enter a search term to display items that fit those criteria.</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a><span class="sd">        The search dialog is displayed by clicking the search option on either the main menubar or the app&#39;s secondary toolbar.</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>        <span class="c1"># show the search dialog</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>        <span class="n">search_dialog</span> <span class="o">=</span> <span class="n">SearchColumnsPopup</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>        <span class="n">search_dialog</span><span class="o">.</span><span class="n">dataEntered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_db_mode</span><span class="p">)</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>        <span class="n">search_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>    <span class="k">def</span> <span class="nf">open_settings_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;open_settings_dialog Function opens the settings dialog window&quot;&quot;&quot;</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>        <span class="n">settings_dialog</span> <span class="o">=</span> <span class="n">SettingsPopup</span><span class="p">()</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>        <span class="c1"># if the settings dialog returns accepted() signal</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>        <span class="k">if</span> <span class="n">settings_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">():</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>            <span class="c1"># the setting that you really notice right away when it doesn&#39;t take effect, is the theme</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>            <span class="c1"># so we just run set_theme after initializing the config</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>            <span class="n">initialize_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>            <span class="n">initialize_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">())</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theme</span><span class="p">)</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_home_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">campus</span><span class="p">)</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>    <span class="k">def</span> <span class="nf">set_home_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">campus</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;set_home_title Function sets the title of the home page&quot;&quot;&quot;</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">campus</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> Printer Inventory&quot;</span><span class="p">)</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>    <span class="k">def</span> <span class="nf">open_in_browser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;open_in_browser Function opens the filepath in the default browser&quot;&quot;&quot;</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>        <span class="c1"># Convert the file path to a QUrl object</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open_new_tab</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>    <span class="c1"># App theme functions</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a>    <span class="c1"># --------------------------------------------------------------------------------------</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>    <span class="k">def</span> <span class="nf">open_theme_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;open_theme_dialog Function opens the theme dialog window&quot;&quot;&quot;</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>        <span class="n">theme_dialog</span> <span class="o">=</span> <span class="n">ThemePopup</span><span class="p">()</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>        <span class="n">theme_dialog</span><span class="o">.</span><span class="n">themeSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_theme</span><span class="p">)</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>        <span class="n">theme_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;set_theme Function sets the theme of the application based on the config file&quot;&quot;&quot;</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>    <span class="k">def</span> <span class="nf">set_theme</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theme</span><span class="p">):</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a><span class="sd">        set_theme sets the QSS stylesheet and theme of the app based on the configuration file, or the user&#39;s choices in one of the settings popups.</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a><span class="sd">        _extended_summary_</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a><span class="sd">        Args:</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a><span class="sd">            theme (str): a filename of a QSS stylesheet, without the .qss file extension.</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>        <span class="c1"># make sure the user chose a theme:</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>        <span class="k">if</span> <span class="n">theme</span> <span class="o">==</span> <span class="s2">&quot;Select a theme&quot;</span><span class="p">:</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>            <span class="k">return</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>        <span class="c1"># set current app config theme to be the new theme</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">theme</span> <span class="o">=</span> <span class="n">theme</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>        <span class="c1"># load the new theme stylesheet and apply to app</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>        <span class="c1"># try this - unless file isn&#39;t found, then load elegantdark</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;themes/</span><span class="si">{</span><span class="n">theme</span><span class="si">}</span><span class="s2">.qss&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>                <span class="n">app</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>        <span class="c1"># if somethings wrong and the specified theme file isn&#39;t found, load elegantdark (hopefully no one deletes this one?)</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>        <span class="c1"># TODO: fallback to blank style / no file?</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>            <span class="n">theme</span> <span class="o">=</span> <span class="s2">&quot;ElegantDark&quot;</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">theme</span> <span class="o">=</span> <span class="n">theme</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;themes/</span><span class="si">{</span><span class="n">theme</span><span class="si">}</span><span class="s2">.qss&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>                <span class="n">app</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>        <span class="c1"># either way,</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>        <span class="c1"># rewrite the ./config/config.yaml to show the new [app][theme]</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./config/config.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">][</span><span class="s2">&quot;theme&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">theme</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./config/config.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>        <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;THEME CHANGE&quot;</span><span class="p">,</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>                  <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Theme set to </span><span class="si">{</span><span class="n">theme</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">change_icon_colors</span><span class="p">()</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>    <span class="k">def</span> <span class="nf">open_scan_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a><span class="sd">        open_scan_dialog open the popup that the user can use to scan printer-related item codes into the database.</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a><span class="sd">        it has a red and greed &#39;LED&#39; widget that will light up green when its ok to keep scanning, and red when you need to stop. The app will also play a sound when the red LED lights up, and play a relatively pleasant chime sound on a successful scan event.</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_window</span> <span class="o">=</span> <span class="n">ScanInputWindow</span><span class="p">(</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>            <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">systemtray</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tray_icon</span><span class="p">)</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># display the input window</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>        <span class="c1"># set focus on the textEdit widget, hopefully place users cursor inside textbox</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_window</span><span class="o">.</span><span class="n">textEdit</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>    <span class="c1"># ----------------------------------------------------------------------------------------</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>    <span class="c1"># Application Column-Selection related Functions:</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>    <span class="c1"># ----------------------------------------------------------------------------------------</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>    <span class="k">def</span> <span class="nf">open_column_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;open_column_dialog Function opens the column dialog window&quot;&quot;&quot;</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>        <span class="c1"># check to make sure a table is currently being displayed</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Table not showing&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Table must be visible to change columns in view.&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>            <span class="k">return</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>        <span class="n">column_dialog</span> <span class="o">=</span> <span class="n">ColumnSelection</span><span class="p">()</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>        <span class="n">column_dialog</span><span class="o">.</span><span class="n">data_ready</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_columns</span><span class="p">)</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>        <span class="n">column_dialog</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">styleSheet</span><span class="p">())</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>    <span class="k">def</span> <span class="nf">set_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">unselected</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a><span class="sd">        set_columns sets the columns of the table based on the config file</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a><span class="sd">        _extended_summary_</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a><span class="sd">        Args:</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a><span class="sd">            selected (list): list of selected columns (in text / header form, not index)</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a><span class="sd">            unselected (list): list of unselected columns in text</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>        <span class="c1"># loop through self.columns.items() and get the selected indices and unused indices</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>        <span class="n">selected_indices</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>        <span class="n">unused_indices</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">col_name_list</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>            <span class="k">if</span> <span class="n">col_name_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">:</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>                <span class="n">selected_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>                <span class="n">unused_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>        <span class="c1"># open config/config.yaml and set all 4 config variables after converting the lists to comma separated strings</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./config/config.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;preferences&quot;</span><span class="p">][</span><span class="s2">&quot;selectedcolumns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;preferences&quot;</span><span class="p">][</span><span class="s2">&quot;selectedindices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>                <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">selected_indices</span><span class="p">])</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;preferences&quot;</span><span class="p">][</span><span class="s2">&quot;unusedcolumns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unselected</span><span class="p">)</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;preferences&quot;</span><span class="p">][</span><span class="s2">&quot;unusedindices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>                <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">unused_indices</span><span class="p">])</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./config/config.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>        <span class="c1"># hide/show the correct columns with selected/unused indices</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">selected_indices</span><span class="p">:</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setColumnHidden</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">unused_indices</span><span class="p">:</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setColumnHidden</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>        <span class="c1"># reset the table model</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">()</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>    <span class="k">def</span> <span class="nf">handle_item_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">operation</span><span class="p">):</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a><span class="sd">        handle_item_dialog handles the signals emitted from the item dialog</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a><span class="sd">        _extended_summary_</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a><span class="sd">        Args:</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a><span class="sd">            item (dict): dictionary containing details about an item.</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a><span class="sd">            operation (str): string containing the operation to perform on the item. (edit, delete, insert)</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>        <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;edit&quot;</span><span class="p">:</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edit_db_item</span><span class="p">(</span><span class="n">item</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>        <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;delete&quot;</span><span class="p">:</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">delete_from_db</span><span class="p">(</span><span class="n">input_arg</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>        <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;insert&quot;</span><span class="p">:</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">insert_into_db</span><span class="p">(</span><span class="n">item_dict</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>            <span class="k">return</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>    <span class="c1"># ----------------------------------------------------------------------------------------</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>    <span class="c1"># Import UPC text file &amp; Export Excel report:</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>    <span class="c1"># ----------------------------------------------------------------------------------------</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>    <span class="k">def</span> <span class="nf">export_to_excel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>        <span class="c1"># TODO: Get report type and some other details into the log</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>        <span class="n">ReportDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>        <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;REPORT CREATED&quot;</span><span class="p">,</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>                  <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Report created&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Report Created&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Report created successfully&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>    <span class="k">def</span> <span class="nf">import_item_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>        <span class="n">upcfile</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>            <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Choose file to import&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;Text Files (*.txt)&quot;</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>        <span class="p">)</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>        <span class="n">lookup_fails</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>        <span class="k">if</span> <span class="n">upcfile</span><span class="p">:</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">upcfile</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>                <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>                <span class="c1"># for each code</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>                <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>                    <span class="n">lookup_result</span> <span class="o">=</span> <span class="n">ItemLookup</span><span class="p">(</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>                        <span class="n">input_code</span><span class="o">=</span><span class="n">code</span><span class="p">,</span> <span class="n">systemtray</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tray_icon</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>                    <span class="p">)</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">lookup_result</span><span class="o">.</span><span class="n">look_up_code</span><span class="p">():</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>                        <span class="n">lookup_fails</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>            <span class="c1"># write failed lookups to file</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;failed-lookups.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>                <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">lookup_fails</span><span class="p">)</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>            <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;FILE IMPORT&quot;</span><span class="p">,</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>                      <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Imported </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span><span class="si">}</span><span class="s2"> items from </span><span class="si">{</span><span class="n">upcfile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>            <span class="c1"># TODO: write system tray notification function that can do informational, alert, warning, etc. with a title and a message argument</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Import Complete&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Imported </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span><span class="si">}</span><span class="s2"> items from </span><span class="si">{</span><span class="n">upcfile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>            <span class="k">pass</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>    <span class="c1"># ----------------------------------------------------------------------------------------</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>    <span class="c1"># DATABASE Procedure functions:</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>    <span class="c1"># Query for results</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>    <span class="k">def</span> <span class="nf">query_database</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fetch_num</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">):</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a><span class="sd">        query_database takes arguments of: 1. an SQL query as a string, and 2. the number of results to fetch (all or one) and returns the results of the query</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a><span class="sd">        The results of the query are returned as a list of dictionaries. Each dictionary represents a row in the database table and the keys are the column names.</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a><span class="sd">        Args:</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a><span class="sd">            query (str): SQL query to execute</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a><span class="sd">            fetch_num (str, optional): how many rows or items to get (fetchall, fetchone...). Defaults to &quot;all&quot;.</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a><span class="sd">        Returns:</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a><span class="sd">            _type_: _description_</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>        <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>            <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>            <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>            <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>            <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>            <span class="n">dicttrue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>        <span class="p">)</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>        <span class="k">if</span> <span class="n">fetch_num</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>        <span class="k">elif</span> <span class="n">fetch_num</span> <span class="o">==</span> <span class="s2">&quot;one&quot;</span><span class="p">:</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>        <span class="k">return</span> <span class="n">results</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>    <span class="c1"># insert item into database</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>    <span class="k">def</span> <span class="nf">insert_into_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>        <span class="c1"># connect to the database</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>        <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>            <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>            <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>            <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>            <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>            <span class="n">dicttrue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>        <span class="p">)</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>        <span class="c1"># construct the query</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>        <span class="n">insert_statement</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;INSERT INTO inventory (brand,description,code,upc,stock,part_num,color,yield,type,comments,linked_codes,needed) VALUES (</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;brand&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;upc&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;stock&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;part_num&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;yield&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;comments&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;linked_codes&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;needed&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>        <span class="c1"># TODO: check to make sure user has entered the 3 -5 required fields</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_statement</span><span class="p">)</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>        <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;INSERT&quot;</span><span class="p">,</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>                  <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> into database&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Inserted&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> into database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>        <span class="c1"># TODO: add write_log statement for inserting item</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>        <span class="c1"># TODO: make a sheet of all the log statements - insert, update, etc. - for the app guide</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>    <span class="c1"># Edit</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>    <span class="k">def</span> <span class="nf">edit_db_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a><span class="sd">        edit_db_item basic function that takes a dictionary of item details as an argument, and edits the specified item in the database.</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a><span class="sd">        Since the user is not allowed to change the UPC through the GUI, the UPC will stay the same, and therefore can be used to identify the item the user is trying to edit.</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a><span class="sd">        Args:</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a><span class="sd">            item (dict): dictionary of item details, each key is a column name from the &#39;inventory&#39; table in the database, value is the data value of that item from that column.</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>            <span class="c1"># connect to the database</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>            <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>                <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>                <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>                <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>                <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>                <span class="n">dicttrue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>            <span class="p">)</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>            <span class="c1"># construct the query</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>            <span class="n">update_statement</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE inventory SET brand=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;brand&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, description=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">,printers=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;printers&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, code=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, stock=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;stock&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, part_num=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;part_num&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, color=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, yield=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;yield&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, type=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, comments=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;comments&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, linked_codes=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;linked_codes&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, needed=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;needed&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2"> WHERE upc=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;upc&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">update_statement</span><span class="p">)</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>            <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>            <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;UPDATE&quot;</span><span class="p">,</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>                      <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Updated </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> in database&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Updated&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Updated </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> in database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>            <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;UPDATE FAIL&quot;</span><span class="p">,</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>                      <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> Failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Update Failed&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Failed to update </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> in database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">()</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>        <span class="c1"># TODO: refresh table</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>        <span class="c1"># TODO: write log - db update</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>    <span class="c1"># Delete</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>    <span class="k">def</span> <span class="nf">insert_item</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a><span class="sd">        insert_item allows user to insert items into the database after checking to make sure theyre not already in there.</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a><span class="sd">        The app will also try to grab as many details about the item as possible and insert them into the database using whatever code is typed in by the user.</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>        <span class="c1"># first ask user to type code into a ApiLookup - app will try to look it up and grab details\</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>        <span class="n">user_notes</span> <span class="o">=</span> <span class="n">ApiLookup</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>        <span class="k">if</span> <span class="n">user_notes</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>            <span class="c1"># get code and try look it up, this will actually check the database first, but then it will go out and check api</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>            <span class="n">notes</span> <span class="o">=</span> <span class="n">user_notes</span><span class="o">.</span><span class="n">textValue</span><span class="p">()</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">notes</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">notes</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">ItemLookup</span><span class="p">(</span><span class="n">input_code</span><span class="o">=</span><span class="n">notes</span><span class="p">)</span><span class="o">.</span><span class="n">look_up_code</span><span class="p">()</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>                <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>                    <span class="c1"># TODO: open an edit item dialog, with the item&#39;s existing details (one&#39;s that api pulled) inserted in the qlineedits</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>                    <span class="c1"># if the lookup was successful, then item has been inserted into the database, so open an edit item dialog with the item details</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>                    <span class="c1"># -- for now, just display popup saying item was added</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>                    <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>                    <span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>                    <span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Item </span><span class="si">{</span><span class="n">notes</span><span class="si">}</span><span class="s2"> added to database.&quot;</span><span class="p">)</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>                    <span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Item Added&quot;</span><span class="p">)</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>                    <span class="n">ok_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">)</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>                    <span class="n">ok_button</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">35</span><span class="p">)</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>                    <span class="n">msg</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="n">ok_button</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">AcceptRole</span><span class="p">)</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>                    <span class="n">msg</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>                    <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>                        <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;insert&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>                    <span class="c1"># item_dialog.dataEntered.connect(self.edit_db_item)</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>                    <span class="k">if</span> <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>                        <span class="c1"># get the item from the item dialog</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>                        <span class="n">item</span> <span class="o">=</span> <span class="n">item_dialog</span><span class="o">.</span><span class="n">get_item</span><span class="p">()</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>                        <span class="c1"># open the edit item dialog</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">insert_into_db</span><span class="p">(</span><span class="n">item_dict</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>                <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;INSERT&quot;</span><span class="p">,</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>                          <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">notes</span><span class="si">}</span><span class="s2"> into database&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Inserted&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">notes</span><span class="si">}</span><span class="s2"> into database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>                <span class="k">return</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>        <span class="c1"># if user closes the notes dialog or something else goes wrong:</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>            <span class="c1"># just open the item dialog with a blank item</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>            <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>                <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;insert&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>            <span class="c1"># item_dialog.dataEntered.connect(self.edit_db_item)</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>            <span class="k">if</span> <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>                <span class="c1"># get the item from the item dialog</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>                <span class="n">item</span> <span class="o">=</span> <span class="n">item_dialog</span><span class="o">.</span><span class="n">get_item</span><span class="p">()</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>                <span class="c1"># open the edit item dialog</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">insert_into_db</span><span class="p">(</span><span class="n">item_dict</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>                <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;INSERT&quot;</span><span class="p">,</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>                          <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> into the database&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Inserted&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2"> into database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>    <span class="k">def</span> <span class="nf">edit_app_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_arg</span><span class="p">):</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a><span class="sd">        edit_app_item called when the user double-clicks either a an item via a table row, or a widget on a dashboard. When the user double-clicks a table row, input_arg will be a QModelIndex. When the user clicks dashboard widget, input_arge will be a dictionary of the widget&#39;s details.</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a><span class="sd">        This function is meant to combine the multiple edit functions present in previous versions.</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a><span class="sd">        Args:</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a><span class="sd">            input_arg (_type_): _description_</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_arg</span><span class="p">,</span> <span class="n">QModelIndex</span><span class="p">):</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>            <span class="n">row</span> <span class="o">=</span> <span class="n">input_arg</span><span class="o">.</span><span class="n">row</span><span class="p">()</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>            <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">columnCount</span><span class="p">()):</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>                <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">headerData</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">)</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>                <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">DisplayRole</span><span class="p">)</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>                <span class="n">data</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">item</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>            <span class="c1"># open item dialog with the item dictionary</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>            <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>                <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_item</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">db_operation</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_item_dialog</span><span class="p">)</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>            <span class="c1"># item_dialog.dataEntered.connect(self.edit_db_item)</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>            <span class="c1"># return</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_arg</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>            <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>                <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_item</span><span class="o">=</span><span class="n">input_arg</span><span class="p">)</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>            <span class="c1"># item_dialog.dataEntered.connect(self.edit_db_item)</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">db_operation</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_item_dialog</span><span class="p">)</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>            <span class="c1"># return</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>        <span class="k">elif</span> <span class="n">input_arg</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>            <span class="n">popup</span> <span class="o">=</span> <span class="n">FindItemDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>            <span class="n">popup</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>            <span class="k">if</span> <span class="n">popup</span><span class="o">.</span><span class="n">result</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>                <span class="c1"># get the code and upc from the popup</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">popup</span><span class="o">.</span><span class="n">code</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>                <span class="n">upc</span> <span class="o">=</span> <span class="n">popup</span><span class="o">.</span><span class="n">upc</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>                <span class="c1"># construct query using the parameters entered (either code, upc, or both)</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>                <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">upc</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>                    <span class="k">return</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>                <span class="k">elif</span> <span class="n">code</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>                    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM inventory WHERE upc=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">upc</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>                <span class="k">elif</span> <span class="n">upc</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>                    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM inventory WHERE code=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>                    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM inventory WHERE code=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2"> AND upc=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">upc</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>                <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_database</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">fetch_num</span><span class="o">=</span><span class="s2">&quot;one&quot;</span><span class="p">)</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>                <span class="c1"># if there are no results, show a popup saying that no item was found</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>                    <span class="k">return</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>                    <span class="c1"># if there are results, populate the item dialog with the data</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>                    <span class="c1"># open item dialog with data pre-populated</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>                    <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>                        <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_item</span><span class="o">=</span><span class="n">results</span><span class="p">)</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>                    <span class="n">item_dialog</span><span class="o">.</span><span class="n">db_operation</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_item_dialog</span><span class="p">)</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>                    <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>        <span class="c1"># if there are results, populate the item dialog with the data</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>            <span class="c1"># open item dialog with data pre-populated</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>            <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>                <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_item</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">db_operation</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_item_dialog</span><span class="p">)</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>    <span class="k">def</span> <span class="nf">delete_from_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_arg</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a><span class="sd">        delete_from_db deletes item from the database, and from the table on display (if applicable).</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a><span class="sd">        Function is called when the user clicks on the trash can icon, after double-clicking a row on a table or widget on a dashboard.</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a><span class="sd">        Args:</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a><span class="sd">            input_arg (_type_, optional): _description_. Defaults to None.</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>        <span class="n">description</span> <span class="o">=</span> <span class="n">input_arg</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>        <span class="n">upc</span> <span class="o">=</span> <span class="n">input_arg</span><span class="p">[</span><span class="s2">&quot;upc&quot;</span><span class="p">]</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>        <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>            <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>            <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>            <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>            <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>            <span class="n">dicttrue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>        <span class="p">)</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>        <span class="n">delete_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;DELETE FROM </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> WHERE upc = </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">upc</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2"> AND description=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">delete_query</span><span class="p">)</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>        <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>                  <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Deleted </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2"> from database&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Deleted&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Deleted </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2"> from database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>        <span class="c1"># if a table is being displayed, then get currently selected row and delete it from the table</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">()</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>    <span class="k">def</span> <span class="nf">search_db_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">input_query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a><span class="sd">        search_db_mode the user can search any of the columns in the inventory table by typing in the search bar. This function will display the results in a table.</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a><span class="sd">        _extended_summary_</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a><span class="sd">        Args:</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a><span class="sd">            mode (str): where the search is initiated from. Can be either &#39;table&#39; or &#39;popup&#39;, this tells the app in which QLineEdit (textbox) to look for the search term that the user has typed.</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a><span class="sd">            input_query (str, optional): an SQL query passed in as an argument when the search is initiated from the popup. A user can view this popup by choosing search on one of the menubars. Defaults to None.</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>        <span class="c1"># search the database for the search term</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>        <span class="c1"># column stirng</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>        <span class="n">column_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>        <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>            <span class="n">column_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>        <span class="n">column_str</span> <span class="o">=</span> <span class="n">column_str</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>        <span class="c1"># set the table model to the results of the search</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>        <span class="c1"># if mode is table, get text from table qlineedit</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;table&quot;</span><span class="p">:</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>            <span class="n">search_term</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>            <span class="c1"># get column name from combobox</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>            <span class="n">column_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>            <span class="k">if</span> <span class="n">search_term</span> <span class="ow">and</span> <span class="n">column_name</span> <span class="o">!=</span> <span class="s2">&quot;Choose column:&quot;</span><span class="p">:</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>                <span class="c1"># construct query</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>                <span class="c1"># CANNOT just use * in query, because the table model will not be able to match the correct column&#39;s data to the correct column header</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>                <span class="c1"># TODO: Try to fix the above issue.</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>                <span class="n">search_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT </span><span class="si">{</span><span class="n">column_str</span><span class="si">}</span><span class="s2"> FROM inventory WHERE </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> LIKE &#39;%</span><span class="si">{</span><span class="n">search_term</span><span class="si">}</span><span class="s2">%&#39;&quot;</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>                <span class="n">new_title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Search Results: </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">search_term</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">search_query</span><span class="p">)</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_title_text</span><span class="p">(</span><span class="n">new_title</span><span class="p">)</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>        <span class="c1"># if search is done from the popup dialog</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;popup&quot;</span><span class="p">:</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>            <span class="c1"># don&#39;t need to get search text because query passed in input_query</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>            <span class="n">search_query</span> <span class="o">=</span> <span class="n">input_query</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>            <span class="n">new_title</span> <span class="o">=</span> <span class="s2">&quot;Search Results:&quot;</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">search_query</span><span class="p">)</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_title_text</span><span class="p">(</span><span class="n">new_title</span><span class="p">)</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_table_page</span><span class="p">()</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>    <span class="k">def</span> <span class="nf">backup_to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">notification</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a><span class="sd">        backup_to_csv first prompts the user with a yes/no popup asking if they&#39;d like to backup the inventory table to a csv file. If yes, then the table is backed up to a csv file in the &lt;b&gt;output folder.&lt;/b&gt;</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a><span class="sd">        If the user hasn&#39;t muted the app&#39;s notifications, then a notification is sent to the system tray with the filename. CSV filenames are auto-generated with the date and time appended to the end.</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a><span class="sd">        Args:</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a><span class="sd">            notification (bool, optional): _description_. Defaults to True.</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>        <span class="c1"># output filename is auto-created</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>        <span class="c1"># TODO: make config setting for this, or prompt user?</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>        <span class="c1"># first do yes no messagebox asking user if they want to backup to csv</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>        <span class="c1"># make QMessageBox w/ok button</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>        <span class="n">popup</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>        <span class="n">popup</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Backup to CSV?&quot;</span><span class="p">)</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>        <span class="n">popup</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>        <span class="n">popup</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>            <span class="s2">&quot;Would you like to backup the inventory table to a CSV file?&quot;</span><span class="p">)</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>        <span class="n">popup</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Question</span><span class="p">)</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>        <span class="n">popup</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">)</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>        <span class="k">for</span> <span class="n">button</span> <span class="ow">in</span> <span class="n">popup</span><span class="o">.</span><span class="n">buttons</span><span class="p">():</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>            <span class="n">button</span><span class="o">.</span><span class="n">setCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">PointingHandCursor</span><span class="p">)</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>        <span class="k">if</span> <span class="n">popup</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>            <span class="c1"># filepath is returned from databackup - put it on Okpopup for user</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>            <span class="n">backup</span> <span class="o">=</span> <span class="n">DataBackup</span><span class="p">()</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>            <span class="n">relative_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">,</span> <span class="n">backup</span><span class="o">.</span><span class="n">csvname</span><span class="p">)</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>            <span class="c1"># show popup QMessageBox with filepath</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>            <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Backup file saved to: </span><span class="si">{</span><span class="n">relative_path</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>            <span class="c1"># if user needs popup notification, do that</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">notification</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mute</span><span class="p">):</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>                <span class="c1"># make QMessageBox w/ok button</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>                <span class="n">popup</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Backup Complete&quot;</span><span class="p">)</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span><span class="o">.</span><span class="n">setCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">PointingHandCursor</span><span class="p">)</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>                <span class="c1"># log it</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>                <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;BACKUP TO CSV&quot;</span><span class="p">,</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>                          <span class="n">comment</span><span class="o">=</span><span class="n">message</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>    <span class="c1"># Build QCompleters for search QLineEdits (Search bars)</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>    <span class="k">def</span> <span class="nf">build_qcompleters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a><span class="sd">        build_qcompleters builds the two QCompleters used by the app. As of 5/6/23, this version of the app only uses the models completer. The codes completer is not used.</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a><span class="sd">        The codes completer could be used to add an extra way of searching to the home page. There could be a couple of buttons to the left of the textbox where the user can choose to search by model or by code. The code completer would be used if the user chooses to search by code.</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a><span class="sd">        Returns:</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a><span class="sd">            tuple: returns a tuple containing the two QCompleters</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>        <span class="c1"># built the printer model qcompleter to be used in the search bar on home window (possibly other locations)</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>        <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>            <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>            <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>            <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>            <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>            <span class="n">dicttrue</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>        <span class="p">)</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>        <span class="c1"># -- LIST OF ALL PRINTER MODELS FROM THE &#39;PRINTERS&#39; COLUMN IN THE DATABASE --</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>        <span class="n">models_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>        <span class="c1"># -- LIST OF ALL TONER/ITEM CODES FROM THE &#39;CODE&#39; COLUMN IN THE DATABASE --</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>        <span class="n">codes_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>        <span class="c1"># dictionary to hold lists of each manufacturer&#39;s printer models (to be used in the suggestion listbox part of the autocomplete Entry)</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>        <span class="n">printer_models</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>            <span class="s2">&quot;dell&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>            <span class="s2">&quot;hp&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>            <span class="s2">&quot;lexmark&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>            <span class="c1"># brother, canon, epson don&#39;t have enough printers to need a table to themselves so they&#39;re combined, might change the text on the actual button to say brother,canon,epson though</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>            <span class="s2">&quot;others&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>        <span class="p">}</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>        <span class="n">prevlist</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>        <span class="c1"># cycle thru each of the keys in the above dictionary</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>        <span class="k">for</span> <span class="n">brand</span> <span class="ow">in</span> <span class="n">printer_models</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>            <span class="k">if</span> <span class="n">brand</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;dell&quot;</span><span class="p">,</span> <span class="s2">&quot;hp&quot;</span><span class="p">,</span> <span class="s2">&quot;lexmark&quot;</span><span class="p">]:</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>                <span class="c1"># set query to select the &#39;printers&#39; column from each brand&#39;s table (there are three brand tables in the database - dell, hp, lexmark)</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>                <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT printers, code, brand FROM inventory WHERE brand=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">brand</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>                <span class="c1"># set query to select the &#39;printers&#39; column from each brand&#39;s table (there are three brand tables in the database - dell, hp, lexmark)</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>                <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT printers, code, brand FROM inventory WHERE brand NOT IN (&#39;dell&#39;, &#39;lexmark&#39;, &#39;hp&#39;)&quot;</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>            <span class="c1"># temp_list will be all resulting rows from the query</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>            <span class="n">temp_list</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>            <span class="c1"># keys will be the  upc, with lists containing code and stock as values</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>            <span class="c1"># start cycling through each of the rows in the result, each row is a row of the &#39;printers&#39; column from the database tables</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">temp_list</span><span class="p">:</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>                <span class="n">manufacturer</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>                <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>                    <span class="n">sublist</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>                    <span class="k">if</span> <span class="n">sublist</span> <span class="o">==</span> <span class="n">prevlist</span><span class="p">:</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>                        <span class="k">pass</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>                        <span class="c1"># for each printer model in this list that we just created (sublist)</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>                        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">:</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>                            <span class="c1"># strip any whitespace</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>                            <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>                            <span class="c1"># check if the model is already in the list and append it if it isn&#39;t</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>                            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">printer_models</span><span class="p">[</span><span class="n">brand</span><span class="p">]:</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>                                <span class="n">printer_models</span><span class="p">[</span><span class="n">brand</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>                                    <span class="n">model</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>                        <span class="c1"># for key in self.manufacturer_btns.keys():</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>                        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">printer_models</span><span class="p">[</span><span class="n">brand</span><span class="p">]:</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>                            <span class="c1"># key is the manufacturer name, model is the printer model</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>                            <span class="n">models_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">manufacturer</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>                <span class="c1"># code gets here if the query returns no results / rows</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>                    <span class="k">pass</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>                <span class="n">codes_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">temp_list</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>        <span class="n">codes_list</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">codes_list</span><span class="p">)</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>        <span class="c1"># if the above loops are fixed - wont have to use this way to get unique values in list</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>        <span class="n">models_list</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">models_list</span><span class="p">)</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>        <span class="n">models_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">models_list</span><span class="p">)</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>        <span class="c1"># close connection to database</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>        <span class="c1"># make a QCompleter for the auto-suggestion textbox so it will suggest printer model names as you type</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>        <span class="n">models_completer</span> <span class="o">=</span> <span class="n">QCompleter</span><span class="p">(</span><span class="n">models_list</span><span class="p">)</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>        <span class="n">codes_completer</span> <span class="o">=</span> <span class="n">QCompleter</span><span class="p">(</span><span class="n">codes_list</span><span class="p">)</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>        <span class="c1"># make it case insensitive</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>        <span class="n">models_completer</span><span class="o">.</span><span class="n">setCaseSensitivity</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">CaseInsensitive</span><span class="p">)</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>        <span class="n">codes_completer</span><span class="o">.</span><span class="n">setCaseSensitivity</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">CaseInsensitive</span><span class="p">)</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>        <span class="k">return</span> <span class="n">models_completer</span><span class="p">,</span> <span class="n">codes_completer</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>    <span class="k">def</span> <span class="nf">build_tray</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a><span class="sd">        build_tray build_tray_menu builds the tray menu and adds the context menu and actions to it. It uses the icon from config.yaml, like alot of the popups and other things in the app.</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a><span class="sd">        Clicking on the tray icon doesn&#39;t seem to work in Windows 11, and the tray icon exhibits other wierd behaviors. Note --&gt; try it out in Windows 10 to get confirmation that it works there.</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a><span class="sd">        Returns:</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a><span class="sd">            tuple: returns a tuple containg the QSystemTrayIcon and the QMenu that&#39;s attached to it.</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>        <span class="n">tray_icon</span> <span class="o">=</span> <span class="n">QSystemTrayIcon</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>        <span class="n">tray_icon</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>        <span class="n">tray_icon</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">app_name</span><span class="p">)</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>        <span class="c1"># create the tray menu</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>        <span class="n">tray_menu</span> <span class="o">=</span> <span class="n">QMenu</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>        <span class="n">tray_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s2">&quot;About&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_help_dialog</span><span class="p">)</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>        <span class="n">tray_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s2">&quot;Exit&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>        <span class="n">tray_icon</span><span class="o">.</span><span class="n">setContextMenu</span><span class="p">(</span><span class="n">tray_menu</span><span class="p">)</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>        <span class="k">return</span> <span class="n">tray_icon</span><span class="p">,</span> <span class="n">tray_menu</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>    <span class="k">def</span> <span class="nf">gen_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">notif_type</span><span class="p">:</span> <span class="n">QSystemTrayIcon</span> <span class="o">=</span> <span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">):</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a><span class="sd">        gen_notification generates a notification using the title and message provided. Notif_type is set to Information by default, but can be changed to Warning or Critical to change the icon that is displayed with the notification.</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a><span class="sd">        Args:</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a><span class="sd">            title (str): the title of the system tray notification.</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a><span class="sd">            message (str): the message body of the system tray notification.</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a><span class="sd">            notif_type (QSystemTrayIcon, optional): the type of icon to be displayed with the system tray icon. Defaults to QSystemTrayIcon.Information.</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>        <span class="c1"># if user has muted notifications, don&#39;t notify them</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mute</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>            <span class="k">return</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>        <span class="c1"># create a notification</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>        <span class="n">notification</span> <span class="o">=</span> <span class="n">QSystemTrayIcon</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>        <span class="n">notification</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>        <span class="n">notification</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>        <span class="n">notification</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">notif_type</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>    <span class="k">def</span> <span class="nf">change_table_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a><span class="sd">        change_table_columns user can add or remove columns from the table that is currently being shown, using a popup that appears.</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a><span class="sd">        If a table isn&#39;t currently being shown, nothing will happen.</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>        <span class="c1"># the model attribute is created when a spreadsheet is shown</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>        <span class="n">initialize_config</span><span class="p">(</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>            <span class="bp">self</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>        <span class="p">)</span>  <span class="c1"># reread the config to get the selected column names, they might be new since start of app</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>            <span class="c1"># get used columns from the config</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>            <span class="n">selected_columns</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>            <span class="c1"># self.selected_columns is set in initialize_config</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>            <span class="n">used_column_names</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>                <span class="n">column_name</span> <span class="k">for</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_columns</span><span class="p">]</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>            <span class="n">unused_columms</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>            <span class="c1"># get indices of columns</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>                <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">used_column_names</span><span class="p">:</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>                    <span class="c1"># selected_columns[selected_columns.index(value)] = index</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>                    <span class="n">selected_columns</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)])</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>                    <span class="c1"># selected_columns.replace(value[0], index)</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>                    <span class="n">unused_columms</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)])</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>            <span class="n">header_list</span> <span class="o">=</span> <span class="n">selected_columns</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>            <span class="n">unused_header_list</span> <span class="o">=</span> <span class="n">unused_columms</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>                <span class="n">dialog</span> <span class="o">=</span> <span class="n">ColumnEdit</span><span class="p">(</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>                    <span class="n">header_list</span><span class="p">,</span> <span class="n">unused_header_list</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>                <span class="k">if</span> <span class="n">dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">table_columns</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">get_values</span><span class="p">()</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">()</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>                    <span class="n">dialog</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Wasn&#39;t able to open the column choices dialog.&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Cannot open dialog:&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No table is currently visible.&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>    <span class="k">def</span> <span class="nf">change_icon_colors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a><span class="sd">        change_icon_colors cycles through the qtawesome icons used in the app (like the ones used in the main menubar) and changes their color to white or black, depending on the theme that is currently being used.</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a><span class="sd">        &lt;b&gt;Themes are divided into dark and light theme groups in the utils.toner_utils initialize_config module&lt;/b&gt;.</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>        <span class="c1"># check the main application window&#39;s background color and see if  its dark or light</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>        <span class="c1"># then  so set icon colors to near white</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>        <span class="c1"># cycle through the main menubar actions and reset their icons</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>        <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>            <span class="c1"># for each menu, iterate through its actions</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>            <span class="k">for</span> <span class="n">subaction</span> <span class="ow">in</span> <span class="n">action</span><span class="o">.</span><span class="n">menu</span><span class="p">()</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>                <span class="c1"># get the text from the action</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">subaction</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>                <span class="c1"># check if any of the icon string keys are in the text from the action (for example, the key &quot;import&quot; will be in the action text &quot;Import UPC File&quot;)</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">icon_strings</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>                        <span class="c1"># check if its a dark or light theme</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theme</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dark_themes</span><span class="p">:</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>                            <span class="c1"># create qtawesome icon</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>                            <span class="n">icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">icon_strings</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>                            <span class="n">icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">icon_strings</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>                        <span class="c1"># set the icon</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>                        <span class="n">subaction</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>    <span class="k">def</span> <span class="nf">reset_database</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a><span class="sd">        reset_database resets all stock values in the inventory table to 0 after double-checking with the user.</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a><span class="sd">        The app will also perform a silent backup to csv before resetting the database.</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>        <span class="c1"># check if the user is sure they want to reset the database</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>        <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Are you sure you want to reset the database?&quot;</span><span class="p">)</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Reset Database&quot;</span><span class="p">)</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setDefaultButton</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>        <span class="c1"># if the user clicks yes, reset the database</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a>        <span class="k">if</span> <span class="n">msg</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>            <span class="c1"># update all stock in database to 0 after running backup.</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">backup_to_csv</span><span class="p">(</span><span class="n">notification</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>            <span class="c1"># connect to database</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>            <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>                <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>                <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>                <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>                <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>                <span class="n">dicttrue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>            <span class="p">)</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>            <span class="c1"># had to disable SAFE UPDATES in MySQL database to be able to do this query</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>            <span class="n">update_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET stock = 0 WHERE 1=1&quot;</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">update_query</span><span class="p">)</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Database Reset&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Database has been reset.&quot;</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>            <span class="p">)</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>            <span class="c1"># log the reset</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>            <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;RESET DB&quot;</span><span class="p">,</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>                      <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;Database was reset, all stock values set to 0.&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>    <span class="k">def</span> <span class="nf">check_for_duplicates_popup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a><span class="sd">        check_for_duplicates generate popup window that shows a combo box with all table columns in it and an ok button</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a><span class="sd">        Oftentimes, items that have duplicate values will be ones that can be linked. For example, two separate toner items that amount to the same part number (same yield value, same color, etc.) but they have different UPCs. By default, the app will separate these items into two different ones, but through the use of this function and &#39;linking the items&#39;, the user can choose to have the two items show up as one.</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>        <span class="c1"># get the column names from the config</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>        <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>        <span class="c1"># create a dialog</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>        <span class="n">dialog</span> <span class="o">=</span> <span class="n">QDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>        <span class="n">dialog</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Check for Duplicates&quot;</span><span class="p">)</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>        <span class="n">dialog</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>        <span class="c1"># create a layout</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>        <span class="c1"># create a combo box</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>        <span class="n">combo_box</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>        <span class="n">combo_box</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>        <span class="c1"># create a button</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>        <span class="n">button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="n">dialog</span><span class="p">)</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>        <span class="c1"># add the combo box and button to the layout</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">combo_box</span><span class="p">)</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>        <span class="c1"># set the layout</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>        <span class="n">dialog</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>        <span class="c1"># connect the button to a function</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>        <span class="n">button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_for_duplicates_action</span><span class="p">(</span><span class="n">combo_box</span><span class="p">,</span> <span class="n">dialog</span><span class="p">))</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>        <span class="c1"># show the dialog</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>        <span class="n">dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>    <span class="k">def</span> <span class="nf">check_for_duplicates_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combo_box</span><span class="p">,</span> <span class="n">dialog</span><span class="p">):</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a><span class="sd">        check_for_duplicates_action the action of checking for duplicates.</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a><span class="sd">        &lt;b&gt;Read description of check_for_duplicates_popup for more information.&lt;/b&gt;</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a><span class="sd">        Args:</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a><span class="sd">            combo_box (QComboBox): necessary so that the function can get the text from the combo box (the column that will be searched for duplicates)</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a><span class="sd">            dialog (QDialog): so the app can close the QDialog.</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>        <span class="c1"># get text from combobox</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>        <span class="n">column_name</span> <span class="o">=</span> <span class="n">combo_box</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>        <span class="c1"># close the dialog</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>        <span class="n">dialog</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>        <span class="c1"># get query ready for table</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>        <span class="n">column_str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT </span><span class="si">{</span><span class="n">column_str</span><span class="si">}</span><span class="s2"> FROM </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> WHERE </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> IN (SELECT </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> FROM </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> GROUP BY </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> HAVING COUNT(*) &gt; 1)&quot;</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>        <span class="c1"># display table with the data</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_table_page</span><span class="p">(</span><span class="n">table_query</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a><span class="k">class</span> <span class="nc">MainWindowShell</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a><span class="sd">        __init__ This QMainWindow holds the QStackedWidget which makes up the core of the application. The QStackedWidget stacks widgets on top of each other, and can switch between them.</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>        <span class="n">initialize_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>        <span class="c1"># set basic window details</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">app_name</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span> <span class="o">=</span> <span class="n">StackedApp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_menu</span><span class="p">()</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="p">)</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>    <span class="k">def</span> <span class="nf">build_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a><span class="sd">        build_menu Creates the main MenuBar for the app, as well as the secondary toolbar which is directly underneath the main menubar. Adds icons and actions to the menubar and toolbar buttons.</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>        <span class="c1"># TODO: Look for more efficient way to build main menubar and secondary toolbar.</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>        <span class="c1"># ------------------------------------</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>        <span class="c1"># MAIN MENUBAR:</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>        <span class="n">menubar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>        <span class="c1"># TOP/MAIN MENU OPTIONS:</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>        <span class="n">menubar_option_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;Edit&quot;</span><span class="p">,</span> <span class="s2">&quot;View&quot;</span><span class="p">,</span> <span class="s2">&quot;Settings&quot;</span><span class="p">,</span> <span class="s2">&quot;Help&quot;</span><span class="p">]</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>        <span class="c1"># create the top/main menu options</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>        <span class="n">menubar_options</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">menubar_option_names</span><span class="p">:</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>            <span class="n">menubar_options</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>        <span class="c1"># -- File menu</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>        <span class="c1">#  Search function : File &gt; Search</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>        <span class="n">search_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s2">&quot;fa5s.search&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">))</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>        <span class="n">search_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">search_icon</span><span class="p">,</span> <span class="s2">&quot;Search&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>        <span class="n">search_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+F&quot;</span><span class="p">)</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>        <span class="n">search_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_search_dialog</span><span class="p">)</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">search_action</span><span class="p">)</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>        <span class="c1"># Import upcs option : File &gt; Import UPCs</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>        <span class="n">qtimporticon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>            <span class="s2">&quot;mdi.import&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>        <span class="p">)</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>        <span class="n">import_item_list_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>            <span class="n">qtimporticon</span><span class="p">,</span> <span class="s2">&quot;Import UPC File&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">import_item_list_action</span><span class="p">)</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>        <span class="n">import_item_list_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">import_item_list</span><span class="p">)</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>        <span class="c1"># File &gt; Reset Database</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>        <span class="n">reset_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>            <span class="s2">&quot;mdi6.database-refresh&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">))</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>        <span class="n">reset_database_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">reset_icon</span><span class="p">,</span> <span class="s2">&quot;Reset Database&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>        <span class="n">reset_database_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">reset_database</span><span class="p">)</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">reset_database_action</span><span class="p">)</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>        <span class="c1"># File &gt; Normalize database</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>        <span class="n">normalize_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>            <span class="s2">&quot;fa.bar-chart-o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">))</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>        <span class="n">normalize_database_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>            <span class="n">normalize_icon</span><span class="p">,</span> <span class="s2">&quot;Fill in columns&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a>        <span class="n">normalize_database_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">fill_columns</span><span class="p">)</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">normalize_database_action</span><span class="p">)</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a>        <span class="c1"># Return Home option : File &gt; Return Home</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a>        <span class="n">home_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>            <span class="s2">&quot;mdi.home&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span><span class="p">)</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>        <span class="n">return_home_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">home_icon</span><span class="p">,</span> <span class="s2">&quot;Return Home&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>        <span class="n">return_home_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">show_home_page</span><span class="p">)</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a>        <span class="n">return_home_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+H&quot;</span><span class="p">)</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">return_home_action</span><span class="p">)</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a>        <span class="c1"># Exit option : File &gt; Exit</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a>        <span class="n">exit_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Exit&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>        <span class="n">exit_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+Q&quot;</span><span class="p">)</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a>        <span class="n">exit_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">exit_action</span><span class="p">)</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>        <span class="c1"># -- Edit menu</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>        <span class="n">duplicates_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>            <span class="s2">&quot;mdi6.content-duplicate&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>        <span class="p">)</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>        <span class="c1"># Remove Duplicates option : Edit &gt; Check for duplicates</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>        <span class="n">check_for_duplicates_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>            <span class="n">duplicates_icon</span><span class="p">,</span> <span class="s2">&quot;Check for duplicates&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>        <span class="n">check_for_duplicates_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+D&quot;</span><span class="p">)</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Edit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">check_for_duplicates_action</span><span class="p">)</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a>        <span class="n">check_for_duplicates_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">check_for_duplicates_popup</span><span class="p">)</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Edit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>        <span class="c1"># Insert Item option : Edit &gt; Insert Item</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>        <span class="n">insert_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>            <span class="s2">&quot;mdi.plus-box-outline&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>        <span class="p">)</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>        <span class="n">insert_item_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">insert_icon</span><span class="p">,</span> <span class="s2">&quot;Insert Item&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>        <span class="n">insert_item_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+I&quot;</span><span class="p">)</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Edit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">insert_item_action</span><span class="p">)</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>        <span class="n">insert_item_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">insert_item</span><span class="p">)</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a>        <span class="c1"># Edit Item option : Edit &gt; Edit Item</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>        <span class="n">edit_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a>            <span class="s2">&quot;mdi6.database-edit-outline&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span><span class="p">)</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a>        <span class="n">edit_item_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">edit_icon</span><span class="p">,</span> <span class="s2">&quot;Edit Item&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>        <span class="c1"># edit_item_action.triggered.connect(</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a>        <span class="c1">#     partial(self.stackedwidget.edit_item, item=None))</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>        <span class="n">edit_item_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a>            <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">edit_app_item</span><span class="p">,</span> <span class="n">input_arg</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a>        <span class="n">edit_item_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+E&quot;</span><span class="p">)</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Edit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">edit_item_action</span><span class="p">)</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a>        <span class="c1"># -- View menu</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a>        <span class="c1"># Options to view each manufacturer spreadsheet</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a>        <span class="n">actions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a>        <span class="k">for</span> <span class="n">mfr</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;dell&quot;</span><span class="p">,</span> <span class="s2">&quot;hp&quot;</span><span class="p">,</span> <span class="s2">&quot;lexmark&quot;</span><span class="p">,</span> <span class="s2">&quot;others&quot;</span><span class="p">]:</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a>            <span class="n">actions</span><span class="p">[</span><span class="n">mfr</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mfr</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> spreadsheet&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a>            <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;View&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">mfr</span><span class="p">])</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a>            <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;View&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>            <span class="c1"># connect to show table</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>            <span class="n">actions</span><span class="p">[</span><span class="n">mfr</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>                <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">show_table_page</span><span class="p">,</span> <span class="n">manufacturer</span><span class="o">=</span><span class="n">mfr</span><span class="p">))</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a>        <span class="c1"># -- Settings menu</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>        <span class="c1"># Display theme toggle : Settings &gt; Dark/Light mode</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a>        <span class="n">theme_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a>            <span class="s2">&quot;mdi6.monitor-eye&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a>        <span class="p">)</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a>        <span class="n">change_display_mode</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">theme_icon</span><span class="p">,</span> <span class="s2">&quot;Change theme&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a>        <span class="n">change_display_mode</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a>            <span class="s2">&quot;Change the QSS stylesheet (theme) for the application.&quot;</span><span class="p">)</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a>        <span class="n">change_display_mode</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_theme_dialog</span><span class="p">)</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Settings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">change_display_mode</span><span class="p">)</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>        <span class="c1"># change table columns</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>        <span class="n">change_table_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>            <span class="s2">&quot;ri.insert-column-left&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>        <span class="p">)</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>        <span class="n">change_table_columns</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>            <span class="n">change_table_icon</span><span class="p">,</span> <span class="s2">&quot;Choose columns&quot;</span><span class="p">,</span> <span class="bp">self</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>        <span class="p">)</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>        <span class="n">change_table_columns</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>            <span class="s2">&quot;Add or substract from current columns being shown on a table.&quot;</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>        <span class="p">)</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>        <span class="n">change_table_columns</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_column_dialog</span><span class="p">)</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Settings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">change_table_columns</span><span class="p">)</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a>        <span class="c1"># View ALL SETTINGS option : Settings &gt; View all settings</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>        <span class="n">view_settings_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>            <span class="s1">&#39;mdi6.cog&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span><span class="p">)</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a>        <span class="n">view_settings_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a>            <span class="n">view_settings_icon</span><span class="p">,</span> <span class="s2">&quot;View all settings&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>        <span class="n">view_settings_action</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;View all settings in the app.&quot;</span><span class="p">)</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>        <span class="n">view_settings_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_settings_dialog</span><span class="p">)</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Settings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">view_settings_action</span><span class="p">)</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a>        <span class="c1"># -- Help menu</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a>        <span class="c1"># About option : Help &gt; About</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>        <span class="n">about_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>            <span class="s2">&quot;mdi.information-outline&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>        <span class="p">)</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>        <span class="n">about_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">about_icon</span><span class="p">,</span> <span class="s2">&quot;About&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Help&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">about_action</span><span class="p">)</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a>        <span class="n">about_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_help_dialog</span><span class="p">)</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>        <span class="c1"># ------------------------------------</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a>        <span class="c1"># TOOLBAR UNDERNEATH MAIN MENU (self.secondary_toolbar)</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a>        <span class="n">secondary_toolbar</span> <span class="o">=</span> <span class="n">TonerToolbar</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addToolBar</span><span class="p">(</span><span class="n">secondary_toolbar</span><span class="p">)</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>        <span class="n">toolbaricons</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>        <span class="n">toolbaractions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>        <span class="c1"># return home button</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;home&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>            <span class="s2">&quot;mdi6.home&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a>        <span class="p">)</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;home&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Return to home page.&quot;</span><span class="p">)</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">show_home_page</span><span class="p">)</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a>        <span class="c1"># settings button</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a>            <span class="s1">&#39;ei.cogs&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Open settings dialog.&quot;</span><span class="p">)</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_settings_dialog</span><span class="p">)</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a>        <span class="c1"># database backup</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;backup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s1">&#39;mdi.database-arrow-down&#39;</span><span class="p">,</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a>                                                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;backup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;backup&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a>            <span class="s2">&quot;Backup the database to a file on your computer.&quot;</span><span class="p">)</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;backup&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">backup_to_csv</span><span class="p">)</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>        <span class="c1"># search button</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;search&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a>            <span class="s2">&quot;mdi6.printer-search&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>        <span class="p">)</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;search&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;search&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>            <span class="s2">&quot;Search the database by any of it&#39;s existing columns.&quot;</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a>        <span class="p">)</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;search&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_search_dialog</span><span class="p">)</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a>        <span class="c1"># open scan input window</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;barcode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a>            <span class="s2">&quot;mdi6.barcode-scan&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>        <span class="p">)</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;barcode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>        <span class="n">secondary_toolbar</span><span class="o">.</span><span class="n">setIconSize</span><span class="p">(</span><span class="n">QSize</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a>        <span class="c1"># toolbaractions[&quot;barcode&quot;].setIcon(toolbaricons[&quot;barcode&quot;])</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;barcode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>            <span class="s2">&quot;Place cursor inside the textbox that opens and begin scanning items, turn up volume please.&quot;</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a>        <span class="p">)</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;barcode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+B&quot;</span><span class="p">)</span>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;barcode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_scan_dialog</span><span class="p">)</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a>        <span class="c1"># -- Import UPC FILE option : on the secondary toolbar</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;import&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a>            <span class="s2">&quot;fa5s.file-import&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.60</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a>        <span class="p">)</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;import&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>        <span class="c1"># toolbaractions[&quot;import&quot;].setIcon(toolbaricons[&quot;import&quot;])</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;import&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>            <span class="s2">&quot;Import .txt File containing 1 UPC code per line&quot;</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>        <span class="p">)</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;import&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+I&quot;</span><span class="p">)</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;import&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">import_item_list</span><span class="p">)</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a>        <span class="c1"># -- Export to Excel button</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;export&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>            <span class="s2">&quot;mdi6.microsoft-excel&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>        <span class="p">)</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;export&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;export&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a>            <span class="s2">&quot;Export the current inventory to .xlsx spreadsheet&quot;</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a>        <span class="p">)</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>        <span class="n">secondary_toolbar</span><span class="o">.</span><span class="n">setIconSize</span><span class="p">(</span><span class="n">QSize</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;export&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+E&quot;</span><span class="p">)</span>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;export&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">export_to_excel</span><span class="p">)</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">qaction</span> <span class="ow">in</span> <span class="n">toolbaractions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>            <span class="n">qaction</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">toolbaricons</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a>            <span class="n">secondary_toolbar</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">qaction</span><span class="p">)</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a>            <span class="c1"># self.stackedwidget.secondary_toolbar.addSeparator()</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a>    <span class="k">def</span> <span class="nf">closeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;closeEvent Overrides the default closeEvent to prompt user to confirm they want to close the application.&quot;&quot;&quot;</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">safety_net</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a>            <span class="n">close_warning</span> <span class="o">=</span> <span class="n">WarningPopup</span><span class="p">(</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a>                <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Exit&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Are you sure you want to exit?&quot;</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a>            <span class="p">)</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a>            <span class="c1"># close_warning.setStyleSheet(self.current_style)</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a>            <span class="k">if</span> <span class="n">close_warning</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span> <span class="o">==</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>                <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a>                <span class="n">event</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a>            <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a>    <span class="c1"># Create the application instance</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a>    <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a>    <span class="c1"># Create the main window shell (which creates stacked widget and sets it as central widget with home page on display)</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>    <span class="n">window</span> <span class="o">=</span> <span class="n">MainWindowShell</span><span class="p">()</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a>    <span class="n">window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a>    <span class="c1"># Run the event loop</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>
</span></pre></div>


            </section>
                <section id="StackedApp">
                            <input id="StackedApp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">StackedApp</span><wbr>(<span class="base">PyQt5.QtWidgets.QWidget</span>):

                <label class="view-source-button" for="StackedApp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp-38"><a href="#StackedApp-38"><span class="linenos">  38</span></a><span class="k">class</span> <span class="nc">StackedApp</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
</span><span id="StackedApp-39"><a href="#StackedApp-39"><span class="linenos">  39</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span><span class="n">QMainWindow</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="StackedApp-40"><a href="#StackedApp-40"><span class="linenos">  40</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-41"><a href="#StackedApp-41"><span class="linenos">  41</span></a><span class="sd">        __init__ This is the main QWidget used by the app GUI. The QMainWindow is just a shell that holds this widget, because QMainWindows come with the main menubars built-in and made building the GUI easier.</span>
</span><span id="StackedApp-42"><a href="#StackedApp-42"><span class="linenos">  42</span></a>
</span><span id="StackedApp-43"><a href="#StackedApp-43"><span class="linenos">  43</span></a><span class="sd">        The main widget inside of this class, is saved in the &#39;stack&#39; property, which is a QStackedWidget. This widget is used to switch between the three main pages of the app: home, table, and dashboard using the statement: self.stack.setCurrentIndex(index).</span>
</span><span id="StackedApp-44"><a href="#StackedApp-44"><span class="linenos">  44</span></a>
</span><span id="StackedApp-45"><a href="#StackedApp-45"><span class="linenos">  45</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp-46"><a href="#StackedApp-46"><span class="linenos">  46</span></a><span class="sd">            parent (QMainWindow, optional): _description_. Defaults to None.</span>
</span><span id="StackedApp-47"><a href="#StackedApp-47"><span class="linenos">  47</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-48"><a href="#StackedApp-48"><span class="linenos">  48</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">StackedApp</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</span><span id="StackedApp-49"><a href="#StackedApp-49"><span class="linenos">  49</span></a>        <span class="n">initialize_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-50"><a href="#StackedApp-50"><span class="linenos">  50</span></a>        <span class="c1"># this dictionary is to change the menubar icon colors, based on whether the user has a light or dark theme set:</span>
</span><span id="StackedApp-51"><a href="#StackedApp-51"><span class="linenos">  51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">icon_strings</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StackedApp-52"><a href="#StackedApp-52"><span class="linenos">  52</span></a>            <span class="s2">&quot;search&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;fa5s.search&quot;</span><span class="p">],</span>
</span><span id="StackedApp-53"><a href="#StackedApp-53"><span class="linenos">  53</span></a>            <span class="s2">&quot;reset&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi6.database-refresh&quot;</span><span class="p">],</span>
</span><span id="StackedApp-54"><a href="#StackedApp-54"><span class="linenos">  54</span></a>            <span class="s2">&quot;import&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi.import&quot;</span><span class="p">],</span>
</span><span id="StackedApp-55"><a href="#StackedApp-55"><span class="linenos">  55</span></a>            <span class="s2">&quot;home&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi.home&quot;</span><span class="p">],</span>
</span><span id="StackedApp-56"><a href="#StackedApp-56"><span class="linenos">  56</span></a>            <span class="s2">&quot;insert&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi.plus-box-outline&quot;</span><span class="p">],</span>
</span><span id="StackedApp-57"><a href="#StackedApp-57"><span class="linenos">  57</span></a>            <span class="s2">&quot;edit&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi6.database-edit-outline&quot;</span><span class="p">],</span>
</span><span id="StackedApp-58"><a href="#StackedApp-58"><span class="linenos">  58</span></a>            <span class="s2">&quot;theme&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi6.monitor-eye&quot;</span><span class="p">],</span>
</span><span id="StackedApp-59"><a href="#StackedApp-59"><span class="linenos">  59</span></a>            <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ri.insert-column-left&quot;</span><span class="p">],</span>
</span><span id="StackedApp-60"><a href="#StackedApp-60"><span class="linenos">  60</span></a>            <span class="s2">&quot;settings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi6.cog&quot;</span><span class="p">],</span>
</span><span id="StackedApp-61"><a href="#StackedApp-61"><span class="linenos">  61</span></a>            <span class="s2">&quot;about&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi.information-outline&quot;</span><span class="p">]</span>
</span><span id="StackedApp-62"><a href="#StackedApp-62"><span class="linenos">  62</span></a>        <span class="p">}</span>
</span><span id="StackedApp-63"><a href="#StackedApp-63"><span class="linenos">  63</span></a>        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-64"><a href="#StackedApp-64"><span class="linenos">  64</span></a>        <span class="c1"># create the three QWidgets</span>
</span><span id="StackedApp-65"><a href="#StackedApp-65"><span class="linenos">  65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_page</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-66"><a href="#StackedApp-66"><span class="linenos">  66</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_page</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-67"><a href="#StackedApp-67"><span class="linenos">  67</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_page</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-68"><a href="#StackedApp-68"><span class="linenos">  68</span></a>
</span><span id="StackedApp-69"><a href="#StackedApp-69"><span class="linenos">  69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tray_icon</span><span class="p">,</span> <span class="n">tray_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_tray</span><span class="p">()</span>
</span><span id="StackedApp-70"><a href="#StackedApp-70"><span class="linenos">  70</span></a>
</span><span id="StackedApp-71"><a href="#StackedApp-71"><span class="linenos">  71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span> <span class="o">=</span> <span class="n">QStackedWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-72"><a href="#StackedApp-72"><span class="linenos">  72</span></a>
</span><span id="StackedApp-73"><a href="#StackedApp-73"><span class="linenos">  73</span></a>        <span class="c1"># set each qwidgets layout to be the corresponding page</span>
</span><span id="StackedApp-74"><a href="#StackedApp-74"><span class="linenos">  74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span> <span class="o">=</span> <span class="n">HomeLayout</span><span class="p">()</span>
</span><span id="StackedApp-75"><a href="#StackedApp-75"><span class="linenos">  75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_page</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="p">)</span>
</span><span id="StackedApp-76"><a href="#StackedApp-76"><span class="linenos">  76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span> <span class="o">=</span> <span class="n">TableLayout</span><span class="p">()</span>
</span><span id="StackedApp-77"><a href="#StackedApp-77"><span class="linenos">  77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">rowclicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_app_item</span><span class="p">)</span>
</span><span id="StackedApp-78"><a href="#StackedApp-78"><span class="linenos">  78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_page</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="p">)</span>
</span><span id="StackedApp-79"><a href="#StackedApp-79"><span class="linenos">  79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span> <span class="o">=</span> <span class="n">DashboardLayout</span><span class="p">()</span>
</span><span id="StackedApp-80"><a href="#StackedApp-80"><span class="linenos">  80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_page</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="p">)</span>
</span><span id="StackedApp-81"><a href="#StackedApp-81"><span class="linenos">  81</span></a>
</span><span id="StackedApp-82"><a href="#StackedApp-82"><span class="linenos">  82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">home_page</span><span class="p">)</span>
</span><span id="StackedApp-83"><a href="#StackedApp-83"><span class="linenos">  83</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_page</span><span class="p">)</span>
</span><span id="StackedApp-84"><a href="#StackedApp-84"><span class="linenos">  84</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dashboard_page</span><span class="p">)</span>
</span><span id="StackedApp-85"><a href="#StackedApp-85"><span class="linenos">  85</span></a>
</span><span id="StackedApp-86"><a href="#StackedApp-86"><span class="linenos">  86</span></a>        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span>
</span><span id="StackedApp-87"><a href="#StackedApp-87"><span class="linenos">  87</span></a>
</span><span id="StackedApp-88"><a href="#StackedApp-88"><span class="linenos">  88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="StackedApp-89"><a href="#StackedApp-89"><span class="linenos">  89</span></a>
</span><span id="StackedApp-90"><a href="#StackedApp-90"><span class="linenos">  90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
</span><span id="StackedApp-91"><a href="#StackedApp-91"><span class="linenos">  91</span></a>
</span><span id="StackedApp-92"><a href="#StackedApp-92"><span class="linenos">  92</span></a>        <span class="c1"># set up qcompleters for the textbox on home window</span>
</span><span id="StackedApp-93"><a href="#StackedApp-93"><span class="linenos">  93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">printer_models_qcompleter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">codes_qcompleter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_qcompleters</span><span class="p">()</span>
</span><span id="StackedApp-94"><a href="#StackedApp-94"><span class="linenos">  94</span></a>        <span class="c1"># TODO: attach either the printer models or item codes q completer based on user selection (will have to add buttons next to the QlineEdit on the home page or something similar)</span>
</span><span id="StackedApp-95"><a href="#StackedApp-95"><span class="linenos">  95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">setCompleter</span><span class="p">(</span>
</span><span id="StackedApp-96"><a href="#StackedApp-96"><span class="linenos">  96</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">printer_models_qcompleter</span><span class="p">)</span>
</span><span id="StackedApp-97"><a href="#StackedApp-97"><span class="linenos">  97</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">setCompleter</span><span class="p">(</span>
</span><span id="StackedApp-98"><a href="#StackedApp-98"><span class="linenos">  98</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">printer_models_qcompleter</span><span class="p">)</span>
</span><span id="StackedApp-99"><a href="#StackedApp-99"><span class="linenos">  99</span></a>        <span class="c1"># connections</span>
</span><span id="StackedApp-100"><a href="#StackedApp-100"><span class="linenos"> 100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">completer</span><span class="p">()</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp-101"><a href="#StackedApp-101"><span class="linenos"> 101</span></a>            <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_dashboard_page</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;home&quot;</span><span class="p">))</span>
</span><span id="StackedApp-102"><a href="#StackedApp-102"><span class="linenos"> 102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">search_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp-103"><a href="#StackedApp-103"><span class="linenos"> 103</span></a>            <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_dashboard_page</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;home&quot;</span><span class="p">))</span>
</span><span id="StackedApp-104"><a href="#StackedApp-104"><span class="linenos"> 104</span></a>
</span><span id="StackedApp-105"><a href="#StackedApp-105"><span class="linenos"> 105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">search_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp-106"><a href="#StackedApp-106"><span class="linenos"> 106</span></a>            <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_dashboard_page</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;dashboard&quot;</span><span class="p">))</span>
</span><span id="StackedApp-107"><a href="#StackedApp-107"><span class="linenos"> 107</span></a>
</span><span id="StackedApp-108"><a href="#StackedApp-108"><span class="linenos"> 108</span></a>        <span class="c1"># connect the search bar button to search function</span>
</span><span id="StackedApp-109"><a href="#StackedApp-109"><span class="linenos"> 109</span></a>        <span class="c1"># if enter is pressed</span>
</span><span id="StackedApp-110"><a href="#StackedApp-110"><span class="linenos"> 110</span></a>        <span class="c1"># self.table_layout.search_bar.completer().activated.connect(</span>
</span><span id="StackedApp-111"><a href="#StackedApp-111"><span class="linenos"> 111</span></a>        <span class="c1">#     lambda: self.show_dashboard_page(window=&quot;home&quot;))</span>
</span><span id="StackedApp-112"><a href="#StackedApp-112"><span class="linenos"> 112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">search_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp-113"><a href="#StackedApp-113"><span class="linenos"> 113</span></a>            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_db_mode</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;table&quot;</span><span class="p">))</span>
</span><span id="StackedApp-114"><a href="#StackedApp-114"><span class="linenos"> 114</span></a>
</span><span id="StackedApp-115"><a href="#StackedApp-115"><span class="linenos"> 115</span></a>        <span class="c1"># connect main buttons on home layout</span>
</span><span id="StackedApp-116"><a href="#StackedApp-116"><span class="linenos"> 116</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">button</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StackedApp-117"><a href="#StackedApp-117"><span class="linenos"> 117</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="StackedApp-118"><a href="#StackedApp-118"><span class="linenos"> 118</span></a>                <span class="n">button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp-119"><a href="#StackedApp-119"><span class="linenos"> 119</span></a>                    <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_table_page</span><span class="p">,</span> <span class="n">manufacturer</span><span class="o">=</span><span class="n">k</span><span class="p">))</span>
</span><span id="StackedApp-120"><a href="#StackedApp-120"><span class="linenos"> 120</span></a>        <span class="c1"># -- SET the THEME --</span>
</span><span id="StackedApp-121"><a href="#StackedApp-121"><span class="linenos"> 121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">theme</span><span class="p">)</span>
</span><span id="StackedApp-122"><a href="#StackedApp-122"><span class="linenos"> 122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_layout_assigned</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="StackedApp-123"><a href="#StackedApp-123"><span class="linenos"> 123</span></a>        <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;APP START&quot;</span><span class="p">,</span>
</span><span id="StackedApp-124"><a href="#StackedApp-124"><span class="linenos"> 124</span></a>                  <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;Application started&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp-125"><a href="#StackedApp-125"><span class="linenos"> 125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Application started&quot;</span><span class="p">,</span>
</span><span id="StackedApp-126"><a href="#StackedApp-126"><span class="linenos"> 126</span></a>                              <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Printer Supply App started&quot;</span><span class="p">)</span>
</span><span id="StackedApp-127"><a href="#StackedApp-127"><span class="linenos"> 127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="StackedApp-128"><a href="#StackedApp-128"><span class="linenos"> 128</span></a>
</span><span id="StackedApp-129"><a href="#StackedApp-129"><span class="linenos"> 129</span></a>    <span class="k">def</span> <span class="nf">fill_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp-130"><a href="#StackedApp-130"><span class="linenos"> 130</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-131"><a href="#StackedApp-131"><span class="linenos"> 131</span></a><span class="sd">        fill_columns run the fillout_columns.py utility in the utils folder. This file (the DBHousekeeping class) will try to fill in any empty or invalid values held by items for columns including brand, type, color, and possibly more.</span>
</span><span id="StackedApp-132"><a href="#StackedApp-132"><span class="linenos"> 132</span></a>
</span><span id="StackedApp-133"><a href="#StackedApp-133"><span class="linenos"> 133</span></a><span class="sd">        fillout_columns.py can also be used independent of the application.</span>
</span><span id="StackedApp-134"><a href="#StackedApp-134"><span class="linenos"> 134</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-135"><a href="#StackedApp-135"><span class="linenos"> 135</span></a>        <span class="n">DBHousekeeping</span><span class="p">()</span>
</span><span id="StackedApp-136"><a href="#StackedApp-136"><span class="linenos"> 136</span></a>        <span class="c1"># messagebox popup saying columns have been filled in as much as possible</span>
</span><span id="StackedApp-137"><a href="#StackedApp-137"><span class="linenos"> 137</span></a>        <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
</span><span id="StackedApp-138"><a href="#StackedApp-138"><span class="linenos"> 138</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp-139"><a href="#StackedApp-139"><span class="linenos"> 139</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columns have been filled in as much as possible.&quot;</span><span class="p">)</span>
</span><span id="StackedApp-140"><a href="#StackedApp-140"><span class="linenos"> 140</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Columns Filled&quot;</span><span class="p">)</span>
</span><span id="StackedApp-141"><a href="#StackedApp-141"><span class="linenos"> 141</span></a>        <span class="n">ok_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">)</span>
</span><span id="StackedApp-142"><a href="#StackedApp-142"><span class="linenos"> 142</span></a>        <span class="n">ok_button</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">35</span><span class="p">)</span>
</span><span id="StackedApp-143"><a href="#StackedApp-143"><span class="linenos"> 143</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="n">ok_button</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">AcceptRole</span><span class="p">)</span>
</span><span id="StackedApp-144"><a href="#StackedApp-144"><span class="linenos"> 144</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp-145"><a href="#StackedApp-145"><span class="linenos"> 145</span></a>
</span><span id="StackedApp-146"><a href="#StackedApp-146"><span class="linenos"> 146</span></a>    <span class="k">def</span> <span class="nf">show_home_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp-147"><a href="#StackedApp-147"><span class="linenos"> 147</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-148"><a href="#StackedApp-148"><span class="linenos"> 148</span></a><span class="sd">        show_home_page shows the main window of the application.</span>
</span><span id="StackedApp-149"><a href="#StackedApp-149"><span class="linenos"> 149</span></a>
</span><span id="StackedApp-150"><a href="#StackedApp-150"><span class="linenos"> 150</span></a><span class="sd">        Displays the campus (set in config) above a QLineEdit (textbox) where the user can search by printer model. Four buttons are stacked beneath the textbox which lead to the app&#39;s spreadsheet view.</span>
</span><span id="StackedApp-151"><a href="#StackedApp-151"><span class="linenos"> 151</span></a>
</span><span id="StackedApp-152"><a href="#StackedApp-152"><span class="linenos"> 152</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-153"><a href="#StackedApp-153"><span class="linenos"> 153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="StackedApp-154"><a href="#StackedApp-154"><span class="linenos"> 154</span></a>
</span><span id="StackedApp-155"><a href="#StackedApp-155"><span class="linenos"> 155</span></a>    <span class="k">def</span> <span class="nf">show_table_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">manufacturer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">table_query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="StackedApp-156"><a href="#StackedApp-156"><span class="linenos"> 156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-157"><a href="#StackedApp-157"><span class="linenos"> 157</span></a><span class="sd">        show_table_page displays the spreadsheet view of the stacked widget, index 1. The home page/view is index 0, and the dashboard view is index 2.</span>
</span><span id="StackedApp-158"><a href="#StackedApp-158"><span class="linenos"> 158</span></a>
</span><span id="StackedApp-159"><a href="#StackedApp-159"><span class="linenos"> 159</span></a><span class="sd">        Using a QStackedWidget allows to easily change between the app&#39;s 3 different windows, and change the actual data that the windows use to display information as well.</span>
</span><span id="StackedApp-160"><a href="#StackedApp-160"><span class="linenos"> 160</span></a>
</span><span id="StackedApp-161"><a href="#StackedApp-161"><span class="linenos"> 161</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp-162"><a href="#StackedApp-162"><span class="linenos"> 162</span></a><span class="sd">            manufacturer (str, optional): manufacturer of items being shown. &lt;b&gt;If this argument is supplied, it means one of the home page&#39;s buttons is being clicked, or one of the View options in menubar&lt;/b&gt;. Defaults to None.</span>
</span><span id="StackedApp-163"><a href="#StackedApp-163"><span class="linenos"> 163</span></a><span class="sd">            table_query (str, optional): query that the app will use to populate the table with items. Defaults to None.</span>
</span><span id="StackedApp-164"><a href="#StackedApp-164"><span class="linenos"> 164</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-165"><a href="#StackedApp-165"><span class="linenos"> 165</span></a>        <span class="n">column_str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
</span><span id="StackedApp-166"><a href="#StackedApp-166"><span class="linenos"> 166</span></a>
</span><span id="StackedApp-167"><a href="#StackedApp-167"><span class="linenos"> 167</span></a>        <span class="c1"># if the manufacturer argument is supplied, it means either the main page buttons or the View &gt; Spreadsheet buttons are being clicked</span>
</span><span id="StackedApp-168"><a href="#StackedApp-168"><span class="linenos"> 168</span></a>        <span class="c1"># --------------------------------------------------------------------------------------------------------------------------------------</span>
</span><span id="StackedApp-169"><a href="#StackedApp-169"><span class="linenos"> 169</span></a>        <span class="k">if</span> <span class="n">manufacturer</span> <span class="ow">and</span> <span class="p">(</span><span class="n">manufacturer</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;others&quot;</span><span class="p">):</span>
</span><span id="StackedApp-170"><a href="#StackedApp-170"><span class="linenos"> 170</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">(</span>
</span><span id="StackedApp-171"><a href="#StackedApp-171"><span class="linenos"> 171</span></a>                <span class="n">query</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;SELECT </span><span class="si">{</span><span class="n">column_str</span><span class="si">}</span><span class="s2"> FROM inventory WHERE brand=&#39;</span><span class="si">{</span><span class="n">manufacturer</span><span class="si">}</span><span class="s2">&#39;;&quot;</span><span class="p">)</span>
</span><span id="StackedApp-172"><a href="#StackedApp-172"><span class="linenos"> 172</span></a>            <span class="k">if</span> <span class="n">manufacturer</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;hp&quot;</span><span class="p">:</span>
</span><span id="StackedApp-173"><a href="#StackedApp-173"><span class="linenos"> 173</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
</span><span id="StackedApp-174"><a href="#StackedApp-174"><span class="linenos"> 174</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">manufacturer</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> Inventory&quot;</span><span class="p">)</span>
</span><span id="StackedApp-175"><a href="#StackedApp-175"><span class="linenos"> 175</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-176"><a href="#StackedApp-176"><span class="linenos"> 176</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
</span><span id="StackedApp-177"><a href="#StackedApp-177"><span class="linenos"> 177</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">manufacturer</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> Inventory&quot;</span><span class="p">)</span>
</span><span id="StackedApp-178"><a href="#StackedApp-178"><span class="linenos"> 178</span></a>        <span class="k">elif</span> <span class="n">manufacturer</span> <span class="ow">and</span> <span class="p">(</span><span class="n">manufacturer</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;others&quot;</span><span class="p">):</span>
</span><span id="StackedApp-179"><a href="#StackedApp-179"><span class="linenos"> 179</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">(</span>
</span><span id="StackedApp-180"><a href="#StackedApp-180"><span class="linenos"> 180</span></a>                <span class="n">query</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;SELECT </span><span class="si">{</span><span class="n">column_str</span><span class="si">}</span><span class="s2"> FROM inventory WHERE LOWER(brand) NOT IN (&#39;hp&#39;, &#39;lexmark&#39;, &#39;dell&#39;)&quot;</span><span class="p">)</span>
</span><span id="StackedApp-181"><a href="#StackedApp-181"><span class="linenos"> 181</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
</span><span id="StackedApp-182"><a href="#StackedApp-182"><span class="linenos"> 182</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">manufacturer</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> Inventory&quot;</span><span class="p">)</span>
</span><span id="StackedApp-183"><a href="#StackedApp-183"><span class="linenos"> 183</span></a>
</span><span id="StackedApp-184"><a href="#StackedApp-184"><span class="linenos"> 184</span></a>        <span class="c1"># if the manufacturer argument is not supplied, but query is, use that to grab the table data</span>
</span><span id="StackedApp-185"><a href="#StackedApp-185"><span class="linenos"> 185</span></a>        <span class="k">elif</span> <span class="n">table_query</span><span class="p">:</span>
</span><span id="StackedApp-186"><a href="#StackedApp-186"><span class="linenos"> 186</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">table_query</span><span class="p">)</span>
</span><span id="StackedApp-187"><a href="#StackedApp-187"><span class="linenos"> 187</span></a>            <span class="c1"># TODO: come up with better looking title than whats below</span>
</span><span id="StackedApp-188"><a href="#StackedApp-188"><span class="linenos"> 188</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Results: </span><span class="si">{</span><span class="n">table_query</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="StackedApp-189"><a href="#StackedApp-189"><span class="linenos"> 189</span></a>        <span class="c1"># --------------------------------------------------------------------------------------------------------------------------------------</span>
</span><span id="StackedApp-190"><a href="#StackedApp-190"><span class="linenos"> 190</span></a>
</span><span id="StackedApp-191"><a href="#StackedApp-191"><span class="linenos"> 191</span></a>        <span class="c1"># set stacked widget to show the table view</span>
</span><span id="StackedApp-192"><a href="#StackedApp-192"><span class="linenos"> 192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="StackedApp-193"><a href="#StackedApp-193"><span class="linenos"> 193</span></a>
</span><span id="StackedApp-194"><a href="#StackedApp-194"><span class="linenos"> 194</span></a>        <span class="c1"># THE IF STATEMENT BELOW IS NECESSARY BECAUSE - without it, the table will make the doubleclicked connection to edit_app_item multiple times (every time the table page is reloaded)</span>
</span><span id="StackedApp-195"><a href="#StackedApp-195"><span class="linenos"> 195</span></a>        <span class="c1"># edit item dialog will popup more and more times</span>
</span><span id="StackedApp-196"><a href="#StackedApp-196"><span class="linenos"> 196</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_layout_assigned</span><span class="p">:</span>
</span><span id="StackedApp-197"><a href="#StackedApp-197"><span class="linenos"> 197</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">doubleClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_app_item</span><span class="p">)</span>
</span><span id="StackedApp-198"><a href="#StackedApp-198"><span class="linenos"> 198</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout_assigned</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="StackedApp-199"><a href="#StackedApp-199"><span class="linenos"> 199</span></a>
</span><span id="StackedApp-200"><a href="#StackedApp-200"><span class="linenos"> 200</span></a>    <span class="k">def</span> <span class="nf">show_dashboard_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;home&quot;</span><span class="p">):</span>
</span><span id="StackedApp-201"><a href="#StackedApp-201"><span class="linenos"> 201</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-202"><a href="#StackedApp-202"><span class="linenos"> 202</span></a><span class="sd">        show_dashboard_page displays the second index of the QStackedWidget that the application uses - the dashboard view.</span>
</span><span id="StackedApp-203"><a href="#StackedApp-203"><span class="linenos"> 203</span></a>
</span><span id="StackedApp-204"><a href="#StackedApp-204"><span class="linenos"> 204</span></a><span class="sd">        A printer model&#39;s &quot;dashboard&quot; will show all of the items held in inventory that are compatible with that printer model. It&#39;s a quick way to see if you have enough resources for a particular model, providing the compatible printers column of the inventory table has been filled out correctly.</span>
</span><span id="StackedApp-205"><a href="#StackedApp-205"><span class="linenos"> 205</span></a>
</span><span id="StackedApp-206"><a href="#StackedApp-206"><span class="linenos"> 206</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp-207"><a href="#StackedApp-207"><span class="linenos"> 207</span></a><span class="sd">            window (str, optional): the window that the app is leaving to come into the dashboard view. Defaults to &quot;home&quot;.</span>
</span><span id="StackedApp-208"><a href="#StackedApp-208"><span class="linenos"> 208</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-209"><a href="#StackedApp-209"><span class="linenos"> 209</span></a>        <span class="c1"># get the current text from the home layout search bar</span>
</span><span id="StackedApp-210"><a href="#StackedApp-210"><span class="linenos"> 210</span></a>        <span class="k">if</span> <span class="n">window</span> <span class="o">==</span> <span class="s2">&quot;home&quot;</span><span class="p">:</span>
</span><span id="StackedApp-211"><a href="#StackedApp-211"><span class="linenos"> 211</span></a>            <span class="n">home_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span><span id="StackedApp-212"><a href="#StackedApp-212"><span class="linenos"> 212</span></a>            <span class="n">printer_model</span> <span class="o">=</span> <span class="n">home_model</span>
</span><span id="StackedApp-213"><a href="#StackedApp-213"><span class="linenos"> 213</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-214"><a href="#StackedApp-214"><span class="linenos"> 214</span></a>            <span class="n">dash_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span><span id="StackedApp-215"><a href="#StackedApp-215"><span class="linenos"> 215</span></a>            <span class="n">printer_model</span> <span class="o">=</span> <span class="n">dash_model</span>
</span><span id="StackedApp-216"><a href="#StackedApp-216"><span class="linenos"> 216</span></a>        <span class="c1"># check if printer model is in the qcompleter list - if it&#39;s not, it won&#39;t be a valid printer model from printers column in database</span>
</span><span id="StackedApp-217"><a href="#StackedApp-217"><span class="linenos"> 217</span></a>        <span class="k">if</span> <span class="n">printer_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer_models_qcompleter</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">stringList</span><span class="p">():</span>
</span><span id="StackedApp-218"><a href="#StackedApp-218"><span class="linenos"> 218</span></a>            <span class="k">if</span> <span class="n">printer_model</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;hp&quot;</span><span class="p">):</span>
</span><span id="StackedApp-219"><a href="#StackedApp-219"><span class="linenos"> 219</span></a>                <span class="n">model_name</span> <span class="o">=</span> <span class="n">printer_model</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
</span><span id="StackedApp-220"><a href="#StackedApp-220"><span class="linenos"> 220</span></a>            <span class="k">elif</span> <span class="n">printer_model</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;dell&quot;</span><span class="p">):</span>
</span><span id="StackedApp-221"><a href="#StackedApp-221"><span class="linenos"> 221</span></a>                <span class="n">model_name</span> <span class="o">=</span> <span class="n">printer_model</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>
</span><span id="StackedApp-222"><a href="#StackedApp-222"><span class="linenos"> 222</span></a>            <span class="k">elif</span> <span class="n">printer_model</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;lexmark&quot;</span><span class="p">):</span>
</span><span id="StackedApp-223"><a href="#StackedApp-223"><span class="linenos"> 223</span></a>                <span class="n">model_name</span> <span class="o">=</span> <span class="n">printer_model</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
</span><span id="StackedApp-224"><a href="#StackedApp-224"><span class="linenos"> 224</span></a>            <span class="k">elif</span> <span class="n">printer_model</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;brother&quot;</span><span class="p">):</span>
</span><span id="StackedApp-225"><a href="#StackedApp-225"><span class="linenos"> 225</span></a>                <span class="n">model_name</span> <span class="o">=</span> <span class="n">printer_model</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
</span><span id="StackedApp-226"><a href="#StackedApp-226"><span class="linenos"> 226</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-227"><a href="#StackedApp-227"><span class="linenos"> 227</span></a>                <span class="n">model_name</span> <span class="o">=</span> <span class="n">printer_model</span>
</span><span id="StackedApp-228"><a href="#StackedApp-228"><span class="linenos"> 228</span></a>            <span class="c1"># set title of dashboard padge</span>
</span><span id="StackedApp-229"><a href="#StackedApp-229"><span class="linenos"> 229</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">set_model_title</span><span class="p">(</span><span class="n">printer_model</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
</span><span id="StackedApp-230"><a href="#StackedApp-230"><span class="linenos"> 230</span></a>
</span><span id="StackedApp-231"><a href="#StackedApp-231"><span class="linenos"> 231</span></a>            <span class="c1"># construct the query</span>
</span><span id="StackedApp-232"><a href="#StackedApp-232"><span class="linenos"> 232</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM inventory WHERE FIND_IN_SET(</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, LOWER(printers))&quot;</span>
</span><span id="StackedApp-233"><a href="#StackedApp-233"><span class="linenos"> 233</span></a>            <span class="c1"># query the database</span>
</span><span id="StackedApp-234"><a href="#StackedApp-234"><span class="linenos"> 234</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_database</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="StackedApp-235"><a href="#StackedApp-235"><span class="linenos"> 235</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="StackedApp-236"><a href="#StackedApp-236"><span class="linenos"> 236</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">populate_dashboard</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span><span id="StackedApp-237"><a href="#StackedApp-237"><span class="linenos"> 237</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="StackedApp-238"><a href="#StackedApp-238"><span class="linenos"> 238</span></a>
</span><span id="StackedApp-239"><a href="#StackedApp-239"><span class="linenos"> 239</span></a>    <span class="k">def</span> <span class="nf">populate_dashboard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
</span><span id="StackedApp-240"><a href="#StackedApp-240"><span class="linenos"> 240</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-241"><a href="#StackedApp-241"><span class="linenos"> 241</span></a><span class="sd">        populate_dashboard function to populate the app&#39;s dashboard view with widgets. Toner and ink items have the colored radials as their widgets.</span>
</span><span id="StackedApp-242"><a href="#StackedApp-242"><span class="linenos"> 242</span></a>
</span><span id="StackedApp-243"><a href="#StackedApp-243"><span class="linenos"> 243</span></a><span class="sd">        As of 5/6/23, other items like fusers, drums, waste containers, all use the same stock dashboard widget. &lt;b&gt;It&#39;d be great to get some help coming up with ideas for widgets for these item types!&lt;/b&gt;</span>
</span><span id="StackedApp-244"><a href="#StackedApp-244"><span class="linenos"> 244</span></a>
</span><span id="StackedApp-245"><a href="#StackedApp-245"><span class="linenos"> 245</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp-246"><a href="#StackedApp-246"><span class="linenos"> 246</span></a><span class="sd">            results (list): a list of item dictionaries that the app will use to populate the dashboard with item widgets.</span>
</span><span id="StackedApp-247"><a href="#StackedApp-247"><span class="linenos"> 247</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-248"><a href="#StackedApp-248"><span class="linenos"> 248</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">count</span><span class="p">())):</span>
</span><span id="StackedApp-249"><a href="#StackedApp-249"><span class="linenos"> 249</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span><span id="StackedApp-250"><a href="#StackedApp-250"><span class="linenos"> 250</span></a>        <span class="n">toner_radials</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StackedApp-251"><a href="#StackedApp-251"><span class="linenos"> 251</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;radial_widgets&quot;</span><span class="p">):</span>
</span><span id="StackedApp-252"><a href="#StackedApp-252"><span class="linenos"> 252</span></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">radial_widgets</span><span class="p">:</span>
</span><span id="StackedApp-253"><a href="#StackedApp-253"><span class="linenos"> 253</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">radial_widgets</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span><span id="StackedApp-254"><a href="#StackedApp-254"><span class="linenos"> 254</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">radial_widgets</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StackedApp-255"><a href="#StackedApp-255"><span class="linenos"> 255</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="StackedApp-256"><a href="#StackedApp-256"><span class="linenos"> 256</span></a>        <span class="n">x2</span><span class="o">=</span><span class="mi">0</span>
</span><span id="StackedApp-257"><a href="#StackedApp-257"><span class="linenos"> 257</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="StackedApp-258"><a href="#StackedApp-258"><span class="linenos"> 258</span></a>        <span class="n">y2</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="StackedApp-259"><a href="#StackedApp-259"><span class="linenos"> 259</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="StackedApp-260"><a href="#StackedApp-260"><span class="linenos"> 260</span></a>            <span class="c1"># if its toner or ink, create a circular progress bar (radial)</span>
</span><span id="StackedApp-261"><a href="#StackedApp-261"><span class="linenos"> 261</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;toner&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ink&quot;</span><span class="p">):</span>
</span><span id="StackedApp-262"><a href="#StackedApp-262"><span class="linenos"> 262</span></a>                <span class="c1"># this creates the frame that holds the radial / labels for a toner object</span>
</span><span id="StackedApp-263"><a href="#StackedApp-263"><span class="linenos"> 263</span></a>                <span class="n">toner_radials</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">RadialFrame</span><span class="p">(</span>
</span><span id="StackedApp-264"><a href="#StackedApp-264"><span class="linenos"> 264</span></a>                    <span class="n">item</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">())</span>
</span><span id="StackedApp-265"><a href="#StackedApp-265"><span class="linenos"> 265</span></a>                <span class="c1"># connect the radials signal to edit function</span>
</span><span id="StackedApp-266"><a href="#StackedApp-266"><span class="linenos"> 266</span></a>                <span class="n">toner_radials</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">userClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp-267"><a href="#StackedApp-267"><span class="linenos"> 267</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">edit_app_item</span><span class="p">)</span>
</span><span id="StackedApp-268"><a href="#StackedApp-268"><span class="linenos"> 268</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span>
</span><span id="StackedApp-269"><a href="#StackedApp-269"><span class="linenos"> 269</span></a>                    <span class="n">toner_radials</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]],</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="StackedApp-270"><a href="#StackedApp-270"><span class="linenos"> 270</span></a>                <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="StackedApp-271"><a href="#StackedApp-271"><span class="linenos"> 271</span></a>                <span class="c1"># this (along with lines in elif statement) will try to separate the toner/ink radials from the other item widgets on the dashboard</span>
</span><span id="StackedApp-272"><a href="#StackedApp-272"><span class="linenos"> 272</span></a>                <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="StackedApp-273"><a href="#StackedApp-273"><span class="linenos"> 273</span></a>                    <span class="n">y</span> <span class="o">+=</span> <span class="mi">2</span>
</span><span id="StackedApp-274"><a href="#StackedApp-274"><span class="linenos"> 274</span></a>                    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="StackedApp-275"><a href="#StackedApp-275"><span class="linenos"> 275</span></a>            <span class="k">elif</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="StackedApp-276"><a href="#StackedApp-276"><span class="linenos"> 276</span></a>                <span class="s2">&quot;drum&quot;</span><span class="p">,</span>
</span><span id="StackedApp-277"><a href="#StackedApp-277"><span class="linenos"> 277</span></a>                <span class="s2">&quot;fuser&quot;</span><span class="p">,</span>
</span><span id="StackedApp-278"><a href="#StackedApp-278"><span class="linenos"> 278</span></a>                <span class="s2">&quot;transfer&quot;</span><span class="p">,</span>
</span><span id="StackedApp-279"><a href="#StackedApp-279"><span class="linenos"> 279</span></a>                <span class="s2">&quot;waste&quot;</span><span class="p">,</span>
</span><span id="StackedApp-280"><a href="#StackedApp-280"><span class="linenos"> 280</span></a>                <span class="s2">&quot;developer&quot;</span><span class="p">,</span>
</span><span id="StackedApp-281"><a href="#StackedApp-281"><span class="linenos"> 281</span></a>                <span class="s2">&quot;cleaner&quot;</span><span class="p">,</span>
</span><span id="StackedApp-282"><a href="#StackedApp-282"><span class="linenos"> 282</span></a>                <span class="s2">&quot;roller&quot;</span><span class="p">,</span>
</span><span id="StackedApp-283"><a href="#StackedApp-283"><span class="linenos"> 283</span></a>                <span class="s2">&quot;toner&quot;</span><span class="p">,</span>
</span><span id="StackedApp-284"><a href="#StackedApp-284"><span class="linenos"> 284</span></a>                <span class="s2">&quot;paper&quot;</span><span class="p">,</span>
</span><span id="StackedApp-285"><a href="#StackedApp-285"><span class="linenos"> 285</span></a>            <span class="p">]:</span>
</span><span id="StackedApp-286"><a href="#StackedApp-286"><span class="linenos"> 286</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;aframe&quot;</span><span class="p">)</span>
</span><span id="StackedApp-287"><a href="#StackedApp-287"><span class="linenos"> 287</span></a>                <span class="n">aframe</span> <span class="o">=</span> <span class="n">ItemFrame</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">())</span>
</span><span id="StackedApp-288"><a href="#StackedApp-288"><span class="linenos"> 288</span></a>                <span class="c1"># aframe.userClicked.connect(self.edit_item)</span>
</span><span id="StackedApp-289"><a href="#StackedApp-289"><span class="linenos"> 289</span></a>                <span class="n">aframe</span><span class="o">.</span><span class="n">userClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_app_item</span><span class="p">)</span>
</span><span id="StackedApp-290"><a href="#StackedApp-290"><span class="linenos"> 290</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">aframe</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
</span><span id="StackedApp-291"><a href="#StackedApp-291"><span class="linenos"> 291</span></a>                <span class="n">x2</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="StackedApp-292"><a href="#StackedApp-292"><span class="linenos"> 292</span></a>                <span class="k">if</span> <span class="n">x2</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="StackedApp-293"><a href="#StackedApp-293"><span class="linenos"> 293</span></a>                    <span class="n">y2</span> <span class="o">+=</span> <span class="mi">2</span>
</span><span id="StackedApp-294"><a href="#StackedApp-294"><span class="linenos"> 294</span></a>                    <span class="n">x2</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="StackedApp-295"><a href="#StackedApp-295"><span class="linenos"> 295</span></a>
</span><span id="StackedApp-296"><a href="#StackedApp-296"><span class="linenos"> 296</span></a>
</span><span id="StackedApp-297"><a href="#StackedApp-297"><span class="linenos"> 297</span></a>
</span><span id="StackedApp-298"><a href="#StackedApp-298"><span class="linenos"> 298</span></a>    <span class="c1"># Opening dialogs/popups: help dialog, search, add item, edit item, etc.</span>
</span><span id="StackedApp-299"><a href="#StackedApp-299"><span class="linenos"> 299</span></a>    <span class="c1"># ----------------------------------------------------------------------------------------------------------</span>
</span><span id="StackedApp-300"><a href="#StackedApp-300"><span class="linenos"> 300</span></a>
</span><span id="StackedApp-301"><a href="#StackedApp-301"><span class="linenos"> 301</span></a>    <span class="k">def</span> <span class="nf">open_help_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp-302"><a href="#StackedApp-302"><span class="linenos"> 302</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;open_help_dialog Function opens the help dialog window&quot;&quot;&quot;</span>
</span><span id="StackedApp-303"><a href="#StackedApp-303"><span class="linenos"> 303</span></a>        <span class="n">help_dialog</span> <span class="o">=</span> <span class="n">HelpPopup</span><span class="p">()</span>
</span><span id="StackedApp-304"><a href="#StackedApp-304"><span class="linenos"> 304</span></a>        <span class="n">help_dialog</span><span class="o">.</span><span class="n">docs_clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp-305"><a href="#StackedApp-305"><span class="linenos"> 305</span></a>            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_in_browser</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">docs_file</span><span class="p">))</span>
</span><span id="StackedApp-306"><a href="#StackedApp-306"><span class="linenos"> 306</span></a>        <span class="n">help_dialog</span><span class="o">.</span><span class="n">app_guide_clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp-307"><a href="#StackedApp-307"><span class="linenos"> 307</span></a>            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_in_browser</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">guide_file</span><span class="p">))</span>
</span><span id="StackedApp-308"><a href="#StackedApp-308"><span class="linenos"> 308</span></a>        <span class="n">help_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp-309"><a href="#StackedApp-309"><span class="linenos"> 309</span></a>
</span><span id="StackedApp-310"><a href="#StackedApp-310"><span class="linenos"> 310</span></a>    <span class="k">def</span> <span class="nf">open_search_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp-311"><a href="#StackedApp-311"><span class="linenos"> 311</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-312"><a href="#StackedApp-312"><span class="linenos"> 312</span></a><span class="sd">        open_search_dialog opens the popup dialog that has a QComboBox, QLineEdit, and QPushButton, so the user can choose a column and enter a search term to display items that fit those criteria.</span>
</span><span id="StackedApp-313"><a href="#StackedApp-313"><span class="linenos"> 313</span></a>
</span><span id="StackedApp-314"><a href="#StackedApp-314"><span class="linenos"> 314</span></a><span class="sd">        The search dialog is displayed by clicking the search option on either the main menubar or the app&#39;s secondary toolbar.</span>
</span><span id="StackedApp-315"><a href="#StackedApp-315"><span class="linenos"> 315</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-316"><a href="#StackedApp-316"><span class="linenos"> 316</span></a>        <span class="c1"># show the search dialog</span>
</span><span id="StackedApp-317"><a href="#StackedApp-317"><span class="linenos"> 317</span></a>        <span class="n">search_dialog</span> <span class="o">=</span> <span class="n">SearchColumnsPopup</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-318"><a href="#StackedApp-318"><span class="linenos"> 318</span></a>        <span class="n">search_dialog</span><span class="o">.</span><span class="n">dataEntered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_db_mode</span><span class="p">)</span>
</span><span id="StackedApp-319"><a href="#StackedApp-319"><span class="linenos"> 319</span></a>
</span><span id="StackedApp-320"><a href="#StackedApp-320"><span class="linenos"> 320</span></a>        <span class="n">search_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp-321"><a href="#StackedApp-321"><span class="linenos"> 321</span></a>
</span><span id="StackedApp-322"><a href="#StackedApp-322"><span class="linenos"> 322</span></a>    <span class="k">def</span> <span class="nf">open_settings_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp-323"><a href="#StackedApp-323"><span class="linenos"> 323</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;open_settings_dialog Function opens the settings dialog window&quot;&quot;&quot;</span>
</span><span id="StackedApp-324"><a href="#StackedApp-324"><span class="linenos"> 324</span></a>        <span class="n">settings_dialog</span> <span class="o">=</span> <span class="n">SettingsPopup</span><span class="p">()</span>
</span><span id="StackedApp-325"><a href="#StackedApp-325"><span class="linenos"> 325</span></a>        <span class="c1"># if the settings dialog returns accepted() signal</span>
</span><span id="StackedApp-326"><a href="#StackedApp-326"><span class="linenos"> 326</span></a>        <span class="k">if</span> <span class="n">settings_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">():</span>
</span><span id="StackedApp-327"><a href="#StackedApp-327"><span class="linenos"> 327</span></a>            <span class="c1"># the setting that you really notice right away when it doesn&#39;t take effect, is the theme</span>
</span><span id="StackedApp-328"><a href="#StackedApp-328"><span class="linenos"> 328</span></a>            <span class="c1"># so we just run set_theme after initializing the config</span>
</span><span id="StackedApp-329"><a href="#StackedApp-329"><span class="linenos"> 329</span></a>            <span class="n">initialize_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-330"><a href="#StackedApp-330"><span class="linenos"> 330</span></a>            <span class="n">initialize_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">())</span>
</span><span id="StackedApp-331"><a href="#StackedApp-331"><span class="linenos"> 331</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theme</span><span class="p">)</span>
</span><span id="StackedApp-332"><a href="#StackedApp-332"><span class="linenos"> 332</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_home_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">campus</span><span class="p">)</span>
</span><span id="StackedApp-333"><a href="#StackedApp-333"><span class="linenos"> 333</span></a>
</span><span id="StackedApp-334"><a href="#StackedApp-334"><span class="linenos"> 334</span></a>    <span class="k">def</span> <span class="nf">set_home_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">campus</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="StackedApp-335"><a href="#StackedApp-335"><span class="linenos"> 335</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;set_home_title Function sets the title of the home page&quot;&quot;&quot;</span>
</span><span id="StackedApp-336"><a href="#StackedApp-336"><span class="linenos"> 336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
</span><span id="StackedApp-337"><a href="#StackedApp-337"><span class="linenos"> 337</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">campus</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> Printer Inventory&quot;</span><span class="p">)</span>
</span><span id="StackedApp-338"><a href="#StackedApp-338"><span class="linenos"> 338</span></a>
</span><span id="StackedApp-339"><a href="#StackedApp-339"><span class="linenos"> 339</span></a>    <span class="k">def</span> <span class="nf">open_in_browser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>
</span><span id="StackedApp-340"><a href="#StackedApp-340"><span class="linenos"> 340</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;open_in_browser Function opens the filepath in the default browser&quot;&quot;&quot;</span>
</span><span id="StackedApp-341"><a href="#StackedApp-341"><span class="linenos"> 341</span></a>        <span class="c1"># Convert the file path to a QUrl object</span>
</span><span id="StackedApp-342"><a href="#StackedApp-342"><span class="linenos"> 342</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
</span><span id="StackedApp-343"><a href="#StackedApp-343"><span class="linenos"> 343</span></a>        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open_new_tab</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span><span id="StackedApp-344"><a href="#StackedApp-344"><span class="linenos"> 344</span></a>
</span><span id="StackedApp-345"><a href="#StackedApp-345"><span class="linenos"> 345</span></a>    <span class="c1"># App theme functions</span>
</span><span id="StackedApp-346"><a href="#StackedApp-346"><span class="linenos"> 346</span></a>    <span class="c1"># --------------------------------------------------------------------------------------</span>
</span><span id="StackedApp-347"><a href="#StackedApp-347"><span class="linenos"> 347</span></a>
</span><span id="StackedApp-348"><a href="#StackedApp-348"><span class="linenos"> 348</span></a>    <span class="k">def</span> <span class="nf">open_theme_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp-349"><a href="#StackedApp-349"><span class="linenos"> 349</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;open_theme_dialog Function opens the theme dialog window&quot;&quot;&quot;</span>
</span><span id="StackedApp-350"><a href="#StackedApp-350"><span class="linenos"> 350</span></a>        <span class="n">theme_dialog</span> <span class="o">=</span> <span class="n">ThemePopup</span><span class="p">()</span>
</span><span id="StackedApp-351"><a href="#StackedApp-351"><span class="linenos"> 351</span></a>        <span class="n">theme_dialog</span><span class="o">.</span><span class="n">themeSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_theme</span><span class="p">)</span>
</span><span id="StackedApp-352"><a href="#StackedApp-352"><span class="linenos"> 352</span></a>        <span class="n">theme_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp-353"><a href="#StackedApp-353"><span class="linenos"> 353</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;set_theme Function sets the theme of the application based on the config file&quot;&quot;&quot;</span>
</span><span id="StackedApp-354"><a href="#StackedApp-354"><span class="linenos"> 354</span></a>
</span><span id="StackedApp-355"><a href="#StackedApp-355"><span class="linenos"> 355</span></a>    <span class="k">def</span> <span class="nf">set_theme</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theme</span><span class="p">):</span>
</span><span id="StackedApp-356"><a href="#StackedApp-356"><span class="linenos"> 356</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-357"><a href="#StackedApp-357"><span class="linenos"> 357</span></a><span class="sd">        set_theme sets the QSS stylesheet and theme of the app based on the configuration file, or the user&#39;s choices in one of the settings popups.</span>
</span><span id="StackedApp-358"><a href="#StackedApp-358"><span class="linenos"> 358</span></a>
</span><span id="StackedApp-359"><a href="#StackedApp-359"><span class="linenos"> 359</span></a><span class="sd">        _extended_summary_</span>
</span><span id="StackedApp-360"><a href="#StackedApp-360"><span class="linenos"> 360</span></a>
</span><span id="StackedApp-361"><a href="#StackedApp-361"><span class="linenos"> 361</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp-362"><a href="#StackedApp-362"><span class="linenos"> 362</span></a><span class="sd">            theme (str): a filename of a QSS stylesheet, without the .qss file extension.</span>
</span><span id="StackedApp-363"><a href="#StackedApp-363"><span class="linenos"> 363</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-364"><a href="#StackedApp-364"><span class="linenos"> 364</span></a>        <span class="c1"># make sure the user chose a theme:</span>
</span><span id="StackedApp-365"><a href="#StackedApp-365"><span class="linenos"> 365</span></a>        <span class="k">if</span> <span class="n">theme</span> <span class="o">==</span> <span class="s2">&quot;Select a theme&quot;</span><span class="p">:</span>
</span><span id="StackedApp-366"><a href="#StackedApp-366"><span class="linenos"> 366</span></a>            <span class="k">return</span>
</span><span id="StackedApp-367"><a href="#StackedApp-367"><span class="linenos"> 367</span></a>        <span class="c1"># set current app config theme to be the new theme</span>
</span><span id="StackedApp-368"><a href="#StackedApp-368"><span class="linenos"> 368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">theme</span> <span class="o">=</span> <span class="n">theme</span>
</span><span id="StackedApp-369"><a href="#StackedApp-369"><span class="linenos"> 369</span></a>        <span class="c1"># load the new theme stylesheet and apply to app</span>
</span><span id="StackedApp-370"><a href="#StackedApp-370"><span class="linenos"> 370</span></a>        <span class="c1"># try this - unless file isn&#39;t found, then load elegantdark</span>
</span><span id="StackedApp-371"><a href="#StackedApp-371"><span class="linenos"> 371</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="StackedApp-372"><a href="#StackedApp-372"><span class="linenos"> 372</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;themes/</span><span class="si">{</span><span class="n">theme</span><span class="si">}</span><span class="s2">.qss&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="StackedApp-373"><a href="#StackedApp-373"><span class="linenos"> 373</span></a>                <span class="n">app</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="StackedApp-374"><a href="#StackedApp-374"><span class="linenos"> 374</span></a>
</span><span id="StackedApp-375"><a href="#StackedApp-375"><span class="linenos"> 375</span></a>        <span class="c1"># if somethings wrong and the specified theme file isn&#39;t found, load elegantdark (hopefully no one deletes this one?)</span>
</span><span id="StackedApp-376"><a href="#StackedApp-376"><span class="linenos"> 376</span></a>        <span class="c1"># TODO: fallback to blank style / no file?</span>
</span><span id="StackedApp-377"><a href="#StackedApp-377"><span class="linenos"> 377</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="StackedApp-378"><a href="#StackedApp-378"><span class="linenos"> 378</span></a>            <span class="n">theme</span> <span class="o">=</span> <span class="s2">&quot;ElegantDark&quot;</span>
</span><span id="StackedApp-379"><a href="#StackedApp-379"><span class="linenos"> 379</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">theme</span> <span class="o">=</span> <span class="n">theme</span>
</span><span id="StackedApp-380"><a href="#StackedApp-380"><span class="linenos"> 380</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;themes/</span><span class="si">{</span><span class="n">theme</span><span class="si">}</span><span class="s2">.qss&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="StackedApp-381"><a href="#StackedApp-381"><span class="linenos"> 381</span></a>                <span class="n">app</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="StackedApp-382"><a href="#StackedApp-382"><span class="linenos"> 382</span></a>
</span><span id="StackedApp-383"><a href="#StackedApp-383"><span class="linenos"> 383</span></a>        <span class="c1"># either way,</span>
</span><span id="StackedApp-384"><a href="#StackedApp-384"><span class="linenos"> 384</span></a>        <span class="c1"># rewrite the ./config/config.yaml to show the new [app][theme]</span>
</span><span id="StackedApp-385"><a href="#StackedApp-385"><span class="linenos"> 385</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./config/config.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="StackedApp-386"><a href="#StackedApp-386"><span class="linenos"> 386</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="StackedApp-387"><a href="#StackedApp-387"><span class="linenos"> 387</span></a>            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">][</span><span class="s2">&quot;theme&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">theme</span>
</span><span id="StackedApp-388"><a href="#StackedApp-388"><span class="linenos"> 388</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./config/config.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="StackedApp-389"><a href="#StackedApp-389"><span class="linenos"> 389</span></a>            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="StackedApp-390"><a href="#StackedApp-390"><span class="linenos"> 390</span></a>        <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;THEME CHANGE&quot;</span><span class="p">,</span>
</span><span id="StackedApp-391"><a href="#StackedApp-391"><span class="linenos"> 391</span></a>                  <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Theme set to </span><span class="si">{</span><span class="n">theme</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp-392"><a href="#StackedApp-392"><span class="linenos"> 392</span></a>
</span><span id="StackedApp-393"><a href="#StackedApp-393"><span class="linenos"> 393</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">change_icon_colors</span><span class="p">()</span>
</span><span id="StackedApp-394"><a href="#StackedApp-394"><span class="linenos"> 394</span></a>
</span><span id="StackedApp-395"><a href="#StackedApp-395"><span class="linenos"> 395</span></a>    <span class="k">def</span> <span class="nf">open_scan_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp-396"><a href="#StackedApp-396"><span class="linenos"> 396</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-397"><a href="#StackedApp-397"><span class="linenos"> 397</span></a><span class="sd">        open_scan_dialog open the popup that the user can use to scan printer-related item codes into the database.</span>
</span><span id="StackedApp-398"><a href="#StackedApp-398"><span class="linenos"> 398</span></a>
</span><span id="StackedApp-399"><a href="#StackedApp-399"><span class="linenos"> 399</span></a><span class="sd">        it has a red and greed &#39;LED&#39; widget that will light up green when its ok to keep scanning, and red when you need to stop. The app will also play a sound when the red LED lights up, and play a relatively pleasant chime sound on a successful scan event.</span>
</span><span id="StackedApp-400"><a href="#StackedApp-400"><span class="linenos"> 400</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-401"><a href="#StackedApp-401"><span class="linenos"> 401</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_window</span> <span class="o">=</span> <span class="n">ScanInputWindow</span><span class="p">(</span>
</span><span id="StackedApp-402"><a href="#StackedApp-402"><span class="linenos"> 402</span></a>            <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">systemtray</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tray_icon</span><span class="p">)</span>
</span><span id="StackedApp-403"><a href="#StackedApp-403"><span class="linenos"> 403</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># display the input window</span>
</span><span id="StackedApp-404"><a href="#StackedApp-404"><span class="linenos"> 404</span></a>        <span class="c1"># set focus on the textEdit widget, hopefully place users cursor inside textbox</span>
</span><span id="StackedApp-405"><a href="#StackedApp-405"><span class="linenos"> 405</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_window</span><span class="o">.</span><span class="n">textEdit</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span>
</span><span id="StackedApp-406"><a href="#StackedApp-406"><span class="linenos"> 406</span></a>
</span><span id="StackedApp-407"><a href="#StackedApp-407"><span class="linenos"> 407</span></a>    <span class="c1"># ----------------------------------------------------------------------------------------</span>
</span><span id="StackedApp-408"><a href="#StackedApp-408"><span class="linenos"> 408</span></a>
</span><span id="StackedApp-409"><a href="#StackedApp-409"><span class="linenos"> 409</span></a>    <span class="c1"># Application Column-Selection related Functions:</span>
</span><span id="StackedApp-410"><a href="#StackedApp-410"><span class="linenos"> 410</span></a>    <span class="c1"># ----------------------------------------------------------------------------------------</span>
</span><span id="StackedApp-411"><a href="#StackedApp-411"><span class="linenos"> 411</span></a>    <span class="k">def</span> <span class="nf">open_column_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp-412"><a href="#StackedApp-412"><span class="linenos"> 412</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;open_column_dialog Function opens the column dialog window&quot;&quot;&quot;</span>
</span><span id="StackedApp-413"><a href="#StackedApp-413"><span class="linenos"> 413</span></a>        <span class="c1"># check to make sure a table is currently being displayed</span>
</span><span id="StackedApp-414"><a href="#StackedApp-414"><span class="linenos"> 414</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="StackedApp-415"><a href="#StackedApp-415"><span class="linenos"> 415</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp-416"><a href="#StackedApp-416"><span class="linenos"> 416</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Table not showing&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Table must be visible to change columns in view.&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp-417"><a href="#StackedApp-417"><span class="linenos"> 417</span></a>            <span class="k">return</span>
</span><span id="StackedApp-418"><a href="#StackedApp-418"><span class="linenos"> 418</span></a>        <span class="n">column_dialog</span> <span class="o">=</span> <span class="n">ColumnSelection</span><span class="p">()</span>
</span><span id="StackedApp-419"><a href="#StackedApp-419"><span class="linenos"> 419</span></a>        <span class="n">column_dialog</span><span class="o">.</span><span class="n">data_ready</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_columns</span><span class="p">)</span>
</span><span id="StackedApp-420"><a href="#StackedApp-420"><span class="linenos"> 420</span></a>        <span class="n">column_dialog</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">styleSheet</span><span class="p">())</span>
</span><span id="StackedApp-421"><a href="#StackedApp-421"><span class="linenos"> 421</span></a>
</span><span id="StackedApp-422"><a href="#StackedApp-422"><span class="linenos"> 422</span></a>    <span class="k">def</span> <span class="nf">set_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">unselected</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="StackedApp-423"><a href="#StackedApp-423"><span class="linenos"> 423</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-424"><a href="#StackedApp-424"><span class="linenos"> 424</span></a><span class="sd">        set_columns sets the columns of the table based on the config file</span>
</span><span id="StackedApp-425"><a href="#StackedApp-425"><span class="linenos"> 425</span></a>
</span><span id="StackedApp-426"><a href="#StackedApp-426"><span class="linenos"> 426</span></a><span class="sd">        _extended_summary_</span>
</span><span id="StackedApp-427"><a href="#StackedApp-427"><span class="linenos"> 427</span></a>
</span><span id="StackedApp-428"><a href="#StackedApp-428"><span class="linenos"> 428</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp-429"><a href="#StackedApp-429"><span class="linenos"> 429</span></a><span class="sd">            selected (list): list of selected columns (in text / header form, not index)</span>
</span><span id="StackedApp-430"><a href="#StackedApp-430"><span class="linenos"> 430</span></a><span class="sd">            unselected (list): list of unselected columns in text</span>
</span><span id="StackedApp-431"><a href="#StackedApp-431"><span class="linenos"> 431</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-432"><a href="#StackedApp-432"><span class="linenos"> 432</span></a>        <span class="c1"># loop through self.columns.items() and get the selected indices and unused indices</span>
</span><span id="StackedApp-433"><a href="#StackedApp-433"><span class="linenos"> 433</span></a>        <span class="n">selected_indices</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StackedApp-434"><a href="#StackedApp-434"><span class="linenos"> 434</span></a>        <span class="n">unused_indices</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StackedApp-435"><a href="#StackedApp-435"><span class="linenos"> 435</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">col_name_list</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
</span><span id="StackedApp-436"><a href="#StackedApp-436"><span class="linenos"> 436</span></a>
</span><span id="StackedApp-437"><a href="#StackedApp-437"><span class="linenos"> 437</span></a>            <span class="k">if</span> <span class="n">col_name_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">:</span>
</span><span id="StackedApp-438"><a href="#StackedApp-438"><span class="linenos"> 438</span></a>                <span class="n">selected_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="StackedApp-439"><a href="#StackedApp-439"><span class="linenos"> 439</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-440"><a href="#StackedApp-440"><span class="linenos"> 440</span></a>                <span class="n">unused_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="StackedApp-441"><a href="#StackedApp-441"><span class="linenos"> 441</span></a>
</span><span id="StackedApp-442"><a href="#StackedApp-442"><span class="linenos"> 442</span></a>        <span class="c1"># open config/config.yaml and set all 4 config variables after converting the lists to comma separated strings</span>
</span><span id="StackedApp-443"><a href="#StackedApp-443"><span class="linenos"> 443</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./config/config.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="StackedApp-444"><a href="#StackedApp-444"><span class="linenos"> 444</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="StackedApp-445"><a href="#StackedApp-445"><span class="linenos"> 445</span></a>            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;preferences&quot;</span><span class="p">][</span><span class="s2">&quot;selectedcolumns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span>
</span><span id="StackedApp-446"><a href="#StackedApp-446"><span class="linenos"> 446</span></a>            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;preferences&quot;</span><span class="p">][</span><span class="s2">&quot;selectedindices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StackedApp-447"><a href="#StackedApp-447"><span class="linenos"> 447</span></a>                <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">selected_indices</span><span class="p">])</span>
</span><span id="StackedApp-448"><a href="#StackedApp-448"><span class="linenos"> 448</span></a>            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;preferences&quot;</span><span class="p">][</span><span class="s2">&quot;unusedcolumns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unselected</span><span class="p">)</span>
</span><span id="StackedApp-449"><a href="#StackedApp-449"><span class="linenos"> 449</span></a>            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;preferences&quot;</span><span class="p">][</span><span class="s2">&quot;unusedindices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StackedApp-450"><a href="#StackedApp-450"><span class="linenos"> 450</span></a>                <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">unused_indices</span><span class="p">])</span>
</span><span id="StackedApp-451"><a href="#StackedApp-451"><span class="linenos"> 451</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./config/config.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="StackedApp-452"><a href="#StackedApp-452"><span class="linenos"> 452</span></a>            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="StackedApp-453"><a href="#StackedApp-453"><span class="linenos"> 453</span></a>        <span class="c1"># hide/show the correct columns with selected/unused indices</span>
</span><span id="StackedApp-454"><a href="#StackedApp-454"><span class="linenos"> 454</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">selected_indices</span><span class="p">:</span>
</span><span id="StackedApp-455"><a href="#StackedApp-455"><span class="linenos"> 455</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setColumnHidden</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="StackedApp-456"><a href="#StackedApp-456"><span class="linenos"> 456</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">unused_indices</span><span class="p">:</span>
</span><span id="StackedApp-457"><a href="#StackedApp-457"><span class="linenos"> 457</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setColumnHidden</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp-458"><a href="#StackedApp-458"><span class="linenos"> 458</span></a>        <span class="c1"># reset the table model</span>
</span><span id="StackedApp-459"><a href="#StackedApp-459"><span class="linenos"> 459</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">()</span>
</span><span id="StackedApp-460"><a href="#StackedApp-460"><span class="linenos"> 460</span></a>
</span><span id="StackedApp-461"><a href="#StackedApp-461"><span class="linenos"> 461</span></a>    <span class="k">def</span> <span class="nf">handle_item_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">operation</span><span class="p">):</span>
</span><span id="StackedApp-462"><a href="#StackedApp-462"><span class="linenos"> 462</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-463"><a href="#StackedApp-463"><span class="linenos"> 463</span></a><span class="sd">        handle_item_dialog handles the signals emitted from the item dialog</span>
</span><span id="StackedApp-464"><a href="#StackedApp-464"><span class="linenos"> 464</span></a>
</span><span id="StackedApp-465"><a href="#StackedApp-465"><span class="linenos"> 465</span></a><span class="sd">        _extended_summary_</span>
</span><span id="StackedApp-466"><a href="#StackedApp-466"><span class="linenos"> 466</span></a>
</span><span id="StackedApp-467"><a href="#StackedApp-467"><span class="linenos"> 467</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp-468"><a href="#StackedApp-468"><span class="linenos"> 468</span></a><span class="sd">            item (dict): dictionary containing details about an item.</span>
</span><span id="StackedApp-469"><a href="#StackedApp-469"><span class="linenos"> 469</span></a><span class="sd">            operation (str): string containing the operation to perform on the item. (edit, delete, insert)</span>
</span><span id="StackedApp-470"><a href="#StackedApp-470"><span class="linenos"> 470</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-471"><a href="#StackedApp-471"><span class="linenos"> 471</span></a>        <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;edit&quot;</span><span class="p">:</span>
</span><span id="StackedApp-472"><a href="#StackedApp-472"><span class="linenos"> 472</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edit_db_item</span><span class="p">(</span><span class="n">item</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="StackedApp-473"><a href="#StackedApp-473"><span class="linenos"> 473</span></a>        <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;delete&quot;</span><span class="p">:</span>
</span><span id="StackedApp-474"><a href="#StackedApp-474"><span class="linenos"> 474</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">delete_from_db</span><span class="p">(</span><span class="n">input_arg</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="StackedApp-475"><a href="#StackedApp-475"><span class="linenos"> 475</span></a>        <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;insert&quot;</span><span class="p">:</span>
</span><span id="StackedApp-476"><a href="#StackedApp-476"><span class="linenos"> 476</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">insert_into_db</span><span class="p">(</span><span class="n">item_dict</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="StackedApp-477"><a href="#StackedApp-477"><span class="linenos"> 477</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-478"><a href="#StackedApp-478"><span class="linenos"> 478</span></a>            <span class="k">return</span>
</span><span id="StackedApp-479"><a href="#StackedApp-479"><span class="linenos"> 479</span></a>    <span class="c1"># ----------------------------------------------------------------------------------------</span>
</span><span id="StackedApp-480"><a href="#StackedApp-480"><span class="linenos"> 480</span></a>
</span><span id="StackedApp-481"><a href="#StackedApp-481"><span class="linenos"> 481</span></a>    <span class="c1"># Import UPC text file &amp; Export Excel report:</span>
</span><span id="StackedApp-482"><a href="#StackedApp-482"><span class="linenos"> 482</span></a>    <span class="c1"># ----------------------------------------------------------------------------------------</span>
</span><span id="StackedApp-483"><a href="#StackedApp-483"><span class="linenos"> 483</span></a>    <span class="k">def</span> <span class="nf">export_to_excel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp-484"><a href="#StackedApp-484"><span class="linenos"> 484</span></a>
</span><span id="StackedApp-485"><a href="#StackedApp-485"><span class="linenos"> 485</span></a>        <span class="c1"># TODO: Get report type and some other details into the log</span>
</span><span id="StackedApp-486"><a href="#StackedApp-486"><span class="linenos"> 486</span></a>        <span class="n">ReportDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp-487"><a href="#StackedApp-487"><span class="linenos"> 487</span></a>        <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;REPORT CREATED&quot;</span><span class="p">,</span>
</span><span id="StackedApp-488"><a href="#StackedApp-488"><span class="linenos"> 488</span></a>                  <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Report created&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp-489"><a href="#StackedApp-489"><span class="linenos"> 489</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp-490"><a href="#StackedApp-490"><span class="linenos"> 490</span></a>            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Report Created&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Report created successfully&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp-491"><a href="#StackedApp-491"><span class="linenos"> 491</span></a>
</span><span id="StackedApp-492"><a href="#StackedApp-492"><span class="linenos"> 492</span></a>    <span class="k">def</span> <span class="nf">import_item_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp-493"><a href="#StackedApp-493"><span class="linenos"> 493</span></a>
</span><span id="StackedApp-494"><a href="#StackedApp-494"><span class="linenos"> 494</span></a>        <span class="n">upcfile</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span>
</span><span id="StackedApp-495"><a href="#StackedApp-495"><span class="linenos"> 495</span></a>            <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Choose file to import&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;Text Files (*.txt)&quot;</span>
</span><span id="StackedApp-496"><a href="#StackedApp-496"><span class="linenos"> 496</span></a>        <span class="p">)</span>
</span><span id="StackedApp-497"><a href="#StackedApp-497"><span class="linenos"> 497</span></a>        <span class="n">lookup_fails</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StackedApp-498"><a href="#StackedApp-498"><span class="linenos"> 498</span></a>        <span class="k">if</span> <span class="n">upcfile</span><span class="p">:</span>
</span><span id="StackedApp-499"><a href="#StackedApp-499"><span class="linenos"> 499</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">upcfile</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="StackedApp-500"><a href="#StackedApp-500"><span class="linenos"> 500</span></a>                <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="StackedApp-501"><a href="#StackedApp-501"><span class="linenos"> 501</span></a>                <span class="c1"># for each code</span>
</span><span id="StackedApp-502"><a href="#StackedApp-502"><span class="linenos"> 502</span></a>                <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="StackedApp-503"><a href="#StackedApp-503"><span class="linenos"> 503</span></a>                    <span class="n">lookup_result</span> <span class="o">=</span> <span class="n">ItemLookup</span><span class="p">(</span>
</span><span id="StackedApp-504"><a href="#StackedApp-504"><span class="linenos"> 504</span></a>                        <span class="n">input_code</span><span class="o">=</span><span class="n">code</span><span class="p">,</span> <span class="n">systemtray</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tray_icon</span>
</span><span id="StackedApp-505"><a href="#StackedApp-505"><span class="linenos"> 505</span></a>                    <span class="p">)</span>
</span><span id="StackedApp-506"><a href="#StackedApp-506"><span class="linenos"> 506</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">lookup_result</span><span class="o">.</span><span class="n">look_up_code</span><span class="p">():</span>
</span><span id="StackedApp-507"><a href="#StackedApp-507"><span class="linenos"> 507</span></a>                        <span class="n">lookup_fails</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span><span id="StackedApp-508"><a href="#StackedApp-508"><span class="linenos"> 508</span></a>
</span><span id="StackedApp-509"><a href="#StackedApp-509"><span class="linenos"> 509</span></a>            <span class="c1"># write failed lookups to file</span>
</span><span id="StackedApp-510"><a href="#StackedApp-510"><span class="linenos"> 510</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;failed-lookups.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="StackedApp-511"><a href="#StackedApp-511"><span class="linenos"> 511</span></a>                <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">lookup_fails</span><span class="p">)</span>
</span><span id="StackedApp-512"><a href="#StackedApp-512"><span class="linenos"> 512</span></a>            <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;FILE IMPORT&quot;</span><span class="p">,</span>
</span><span id="StackedApp-513"><a href="#StackedApp-513"><span class="linenos"> 513</span></a>                      <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Imported </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span><span class="si">}</span><span class="s2"> items from </span><span class="si">{</span><span class="n">upcfile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp-514"><a href="#StackedApp-514"><span class="linenos"> 514</span></a>            <span class="c1"># TODO: write system tray notification function that can do informational, alert, warning, etc. with a title and a message argument</span>
</span><span id="StackedApp-515"><a href="#StackedApp-515"><span class="linenos"> 515</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp-516"><a href="#StackedApp-516"><span class="linenos"> 516</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Import Complete&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Imported </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span><span class="si">}</span><span class="s2"> items from </span><span class="si">{</span><span class="n">upcfile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp-517"><a href="#StackedApp-517"><span class="linenos"> 517</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-518"><a href="#StackedApp-518"><span class="linenos"> 518</span></a>            <span class="k">pass</span>
</span><span id="StackedApp-519"><a href="#StackedApp-519"><span class="linenos"> 519</span></a>    <span class="c1"># ----------------------------------------------------------------------------------------</span>
</span><span id="StackedApp-520"><a href="#StackedApp-520"><span class="linenos"> 520</span></a>
</span><span id="StackedApp-521"><a href="#StackedApp-521"><span class="linenos"> 521</span></a>    <span class="c1"># DATABASE Procedure functions:</span>
</span><span id="StackedApp-522"><a href="#StackedApp-522"><span class="linenos"> 522</span></a>    <span class="c1"># Query for results</span>
</span><span id="StackedApp-523"><a href="#StackedApp-523"><span class="linenos"> 523</span></a>    <span class="k">def</span> <span class="nf">query_database</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fetch_num</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">):</span>
</span><span id="StackedApp-524"><a href="#StackedApp-524"><span class="linenos"> 524</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-525"><a href="#StackedApp-525"><span class="linenos"> 525</span></a><span class="sd">        query_database takes arguments of: 1. an SQL query as a string, and 2. the number of results to fetch (all or one) and returns the results of the query</span>
</span><span id="StackedApp-526"><a href="#StackedApp-526"><span class="linenos"> 526</span></a>
</span><span id="StackedApp-527"><a href="#StackedApp-527"><span class="linenos"> 527</span></a><span class="sd">        The results of the query are returned as a list of dictionaries. Each dictionary represents a row in the database table and the keys are the column names.</span>
</span><span id="StackedApp-528"><a href="#StackedApp-528"><span class="linenos"> 528</span></a>
</span><span id="StackedApp-529"><a href="#StackedApp-529"><span class="linenos"> 529</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp-530"><a href="#StackedApp-530"><span class="linenos"> 530</span></a><span class="sd">            query (str): SQL query to execute</span>
</span><span id="StackedApp-531"><a href="#StackedApp-531"><span class="linenos"> 531</span></a><span class="sd">            fetch_num (str, optional): how many rows or items to get (fetchall, fetchone...). Defaults to &quot;all&quot;.</span>
</span><span id="StackedApp-532"><a href="#StackedApp-532"><span class="linenos"> 532</span></a>
</span><span id="StackedApp-533"><a href="#StackedApp-533"><span class="linenos"> 533</span></a><span class="sd">        Returns:</span>
</span><span id="StackedApp-534"><a href="#StackedApp-534"><span class="linenos"> 534</span></a><span class="sd">            _type_: _description_</span>
</span><span id="StackedApp-535"><a href="#StackedApp-535"><span class="linenos"> 535</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-536"><a href="#StackedApp-536"><span class="linenos"> 536</span></a>        <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="StackedApp-537"><a href="#StackedApp-537"><span class="linenos"> 537</span></a>            <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="StackedApp-538"><a href="#StackedApp-538"><span class="linenos"> 538</span></a>            <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="StackedApp-539"><a href="#StackedApp-539"><span class="linenos"> 539</span></a>            <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="StackedApp-540"><a href="#StackedApp-540"><span class="linenos"> 540</span></a>            <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="StackedApp-541"><a href="#StackedApp-541"><span class="linenos"> 541</span></a>            <span class="n">dicttrue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="StackedApp-542"><a href="#StackedApp-542"><span class="linenos"> 542</span></a>        <span class="p">)</span>
</span><span id="StackedApp-543"><a href="#StackedApp-543"><span class="linenos"> 543</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="StackedApp-544"><a href="#StackedApp-544"><span class="linenos"> 544</span></a>        <span class="k">if</span> <span class="n">fetch_num</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="StackedApp-545"><a href="#StackedApp-545"><span class="linenos"> 545</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span><span id="StackedApp-546"><a href="#StackedApp-546"><span class="linenos"> 546</span></a>        <span class="k">elif</span> <span class="n">fetch_num</span> <span class="o">==</span> <span class="s2">&quot;one&quot;</span><span class="p">:</span>
</span><span id="StackedApp-547"><a href="#StackedApp-547"><span class="linenos"> 547</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
</span><span id="StackedApp-548"><a href="#StackedApp-548"><span class="linenos"> 548</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp-549"><a href="#StackedApp-549"><span class="linenos"> 549</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp-550"><a href="#StackedApp-550"><span class="linenos"> 550</span></a>        <span class="k">return</span> <span class="n">results</span>
</span><span id="StackedApp-551"><a href="#StackedApp-551"><span class="linenos"> 551</span></a>    <span class="c1"># insert item into database</span>
</span><span id="StackedApp-552"><a href="#StackedApp-552"><span class="linenos"> 552</span></a>
</span><span id="StackedApp-553"><a href="#StackedApp-553"><span class="linenos"> 553</span></a>    <span class="k">def</span> <span class="nf">insert_into_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StackedApp-554"><a href="#StackedApp-554"><span class="linenos"> 554</span></a>        <span class="c1"># connect to the database</span>
</span><span id="StackedApp-555"><a href="#StackedApp-555"><span class="linenos"> 555</span></a>        <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="StackedApp-556"><a href="#StackedApp-556"><span class="linenos"> 556</span></a>            <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="StackedApp-557"><a href="#StackedApp-557"><span class="linenos"> 557</span></a>            <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="StackedApp-558"><a href="#StackedApp-558"><span class="linenos"> 558</span></a>            <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="StackedApp-559"><a href="#StackedApp-559"><span class="linenos"> 559</span></a>            <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="StackedApp-560"><a href="#StackedApp-560"><span class="linenos"> 560</span></a>            <span class="n">dicttrue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="StackedApp-561"><a href="#StackedApp-561"><span class="linenos"> 561</span></a>        <span class="p">)</span>
</span><span id="StackedApp-562"><a href="#StackedApp-562"><span class="linenos"> 562</span></a>        <span class="c1"># construct the query</span>
</span><span id="StackedApp-563"><a href="#StackedApp-563"><span class="linenos"> 563</span></a>        <span class="n">insert_statement</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;INSERT INTO inventory (brand,description,code,upc,stock,part_num,color,yield,type,comments,linked_codes,needed) VALUES (</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;brand&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;upc&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;stock&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;part_num&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;yield&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;comments&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;linked_codes&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;needed&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="StackedApp-564"><a href="#StackedApp-564"><span class="linenos"> 564</span></a>        <span class="c1"># TODO: check to make sure user has entered the 3 -5 required fields</span>
</span><span id="StackedApp-565"><a href="#StackedApp-565"><span class="linenos"> 565</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_statement</span><span class="p">)</span>
</span><span id="StackedApp-566"><a href="#StackedApp-566"><span class="linenos"> 566</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="StackedApp-567"><a href="#StackedApp-567"><span class="linenos"> 567</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp-568"><a href="#StackedApp-568"><span class="linenos"> 568</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp-569"><a href="#StackedApp-569"><span class="linenos"> 569</span></a>        <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;INSERT&quot;</span><span class="p">,</span>
</span><span id="StackedApp-570"><a href="#StackedApp-570"><span class="linenos"> 570</span></a>                  <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> into database&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp-571"><a href="#StackedApp-571"><span class="linenos"> 571</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp-572"><a href="#StackedApp-572"><span class="linenos"> 572</span></a>            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Inserted&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> into database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp-573"><a href="#StackedApp-573"><span class="linenos"> 573</span></a>        <span class="c1"># TODO: add write_log statement for inserting item</span>
</span><span id="StackedApp-574"><a href="#StackedApp-574"><span class="linenos"> 574</span></a>        <span class="c1"># TODO: make a sheet of all the log statements - insert, update, etc. - for the app guide</span>
</span><span id="StackedApp-575"><a href="#StackedApp-575"><span class="linenos"> 575</span></a>    <span class="c1"># Edit</span>
</span><span id="StackedApp-576"><a href="#StackedApp-576"><span class="linenos"> 576</span></a>
</span><span id="StackedApp-577"><a href="#StackedApp-577"><span class="linenos"> 577</span></a>    <span class="k">def</span> <span class="nf">edit_db_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StackedApp-578"><a href="#StackedApp-578"><span class="linenos"> 578</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-579"><a href="#StackedApp-579"><span class="linenos"> 579</span></a><span class="sd">        edit_db_item basic function that takes a dictionary of item details as an argument, and edits the specified item in the database.</span>
</span><span id="StackedApp-580"><a href="#StackedApp-580"><span class="linenos"> 580</span></a>
</span><span id="StackedApp-581"><a href="#StackedApp-581"><span class="linenos"> 581</span></a><span class="sd">        Since the user is not allowed to change the UPC through the GUI, the UPC will stay the same, and therefore can be used to identify the item the user is trying to edit.</span>
</span><span id="StackedApp-582"><a href="#StackedApp-582"><span class="linenos"> 582</span></a>
</span><span id="StackedApp-583"><a href="#StackedApp-583"><span class="linenos"> 583</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp-584"><a href="#StackedApp-584"><span class="linenos"> 584</span></a><span class="sd">            item (dict): dictionary of item details, each key is a column name from the &#39;inventory&#39; table in the database, value is the data value of that item from that column.</span>
</span><span id="StackedApp-585"><a href="#StackedApp-585"><span class="linenos"> 585</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-586"><a href="#StackedApp-586"><span class="linenos"> 586</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="StackedApp-587"><a href="#StackedApp-587"><span class="linenos"> 587</span></a>            <span class="c1"># connect to the database</span>
</span><span id="StackedApp-588"><a href="#StackedApp-588"><span class="linenos"> 588</span></a>            <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="StackedApp-589"><a href="#StackedApp-589"><span class="linenos"> 589</span></a>                <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="StackedApp-590"><a href="#StackedApp-590"><span class="linenos"> 590</span></a>                <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="StackedApp-591"><a href="#StackedApp-591"><span class="linenos"> 591</span></a>                <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="StackedApp-592"><a href="#StackedApp-592"><span class="linenos"> 592</span></a>                <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="StackedApp-593"><a href="#StackedApp-593"><span class="linenos"> 593</span></a>                <span class="n">dicttrue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="StackedApp-594"><a href="#StackedApp-594"><span class="linenos"> 594</span></a>            <span class="p">)</span>
</span><span id="StackedApp-595"><a href="#StackedApp-595"><span class="linenos"> 595</span></a>            <span class="c1"># construct the query</span>
</span><span id="StackedApp-596"><a href="#StackedApp-596"><span class="linenos"> 596</span></a>            <span class="n">update_statement</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE inventory SET brand=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;brand&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, description=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">,printers=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;printers&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, code=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, stock=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;stock&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, part_num=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;part_num&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, color=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, yield=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;yield&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, type=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, comments=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;comments&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, linked_codes=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;linked_codes&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, needed=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;needed&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2"> WHERE upc=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;upc&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="StackedApp-597"><a href="#StackedApp-597"><span class="linenos"> 597</span></a>            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">update_statement</span><span class="p">)</span>
</span><span id="StackedApp-598"><a href="#StackedApp-598"><span class="linenos"> 598</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="StackedApp-599"><a href="#StackedApp-599"><span class="linenos"> 599</span></a>            <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp-600"><a href="#StackedApp-600"><span class="linenos"> 600</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp-601"><a href="#StackedApp-601"><span class="linenos"> 601</span></a>            <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;UPDATE&quot;</span><span class="p">,</span>
</span><span id="StackedApp-602"><a href="#StackedApp-602"><span class="linenos"> 602</span></a>                      <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Updated </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> in database&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp-603"><a href="#StackedApp-603"><span class="linenos"> 603</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp-604"><a href="#StackedApp-604"><span class="linenos"> 604</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Updated&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Updated </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> in database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp-605"><a href="#StackedApp-605"><span class="linenos"> 605</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StackedApp-606"><a href="#StackedApp-606"><span class="linenos"> 606</span></a>            <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;UPDATE FAIL&quot;</span><span class="p">,</span>
</span><span id="StackedApp-607"><a href="#StackedApp-607"><span class="linenos"> 607</span></a>                      <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> Failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp-608"><a href="#StackedApp-608"><span class="linenos"> 608</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp-609"><a href="#StackedApp-609"><span class="linenos"> 609</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Update Failed&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Failed to update </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> in database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
</span><span id="StackedApp-610"><a href="#StackedApp-610"><span class="linenos"> 610</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="StackedApp-611"><a href="#StackedApp-611"><span class="linenos"> 611</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">()</span>
</span><span id="StackedApp-612"><a href="#StackedApp-612"><span class="linenos"> 612</span></a>        <span class="c1"># TODO: refresh table</span>
</span><span id="StackedApp-613"><a href="#StackedApp-613"><span class="linenos"> 613</span></a>        <span class="c1"># TODO: write log - db update</span>
</span><span id="StackedApp-614"><a href="#StackedApp-614"><span class="linenos"> 614</span></a>    <span class="c1"># Delete</span>
</span><span id="StackedApp-615"><a href="#StackedApp-615"><span class="linenos"> 615</span></a>
</span><span id="StackedApp-616"><a href="#StackedApp-616"><span class="linenos"> 616</span></a>    <span class="k">def</span> <span class="nf">insert_item</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp-617"><a href="#StackedApp-617"><span class="linenos"> 617</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-618"><a href="#StackedApp-618"><span class="linenos"> 618</span></a><span class="sd">        insert_item allows user to insert items into the database after checking to make sure theyre not already in there.</span>
</span><span id="StackedApp-619"><a href="#StackedApp-619"><span class="linenos"> 619</span></a>
</span><span id="StackedApp-620"><a href="#StackedApp-620"><span class="linenos"> 620</span></a><span class="sd">        The app will also try to grab as many details about the item as possible and insert them into the database using whatever code is typed in by the user.</span>
</span><span id="StackedApp-621"><a href="#StackedApp-621"><span class="linenos"> 621</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-622"><a href="#StackedApp-622"><span class="linenos"> 622</span></a>        <span class="c1"># first ask user to type code into a ApiLookup - app will try to look it up and grab details\</span>
</span><span id="StackedApp-623"><a href="#StackedApp-623"><span class="linenos"> 623</span></a>        <span class="n">user_notes</span> <span class="o">=</span> <span class="n">ApiLookup</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-624"><a href="#StackedApp-624"><span class="linenos"> 624</span></a>        <span class="k">if</span> <span class="n">user_notes</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
</span><span id="StackedApp-625"><a href="#StackedApp-625"><span class="linenos"> 625</span></a>            <span class="c1"># get code and try look it up, this will actually check the database first, but then it will go out and check api</span>
</span><span id="StackedApp-626"><a href="#StackedApp-626"><span class="linenos"> 626</span></a>            <span class="n">notes</span> <span class="o">=</span> <span class="n">user_notes</span><span class="o">.</span><span class="n">textValue</span><span class="p">()</span>
</span><span id="StackedApp-627"><a href="#StackedApp-627"><span class="linenos"> 627</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">notes</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">notes</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
</span><span id="StackedApp-628"><a href="#StackedApp-628"><span class="linenos"> 628</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">ItemLookup</span><span class="p">(</span><span class="n">input_code</span><span class="o">=</span><span class="n">notes</span><span class="p">)</span><span class="o">.</span><span class="n">look_up_code</span><span class="p">()</span>
</span><span id="StackedApp-629"><a href="#StackedApp-629"><span class="linenos"> 629</span></a>                <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
</span><span id="StackedApp-630"><a href="#StackedApp-630"><span class="linenos"> 630</span></a>                    <span class="c1"># TODO: open an edit item dialog, with the item&#39;s existing details (one&#39;s that api pulled) inserted in the qlineedits</span>
</span><span id="StackedApp-631"><a href="#StackedApp-631"><span class="linenos"> 631</span></a>                    <span class="c1"># if the lookup was successful, then item has been inserted into the database, so open an edit item dialog with the item details</span>
</span><span id="StackedApp-632"><a href="#StackedApp-632"><span class="linenos"> 632</span></a>                    <span class="c1"># -- for now, just display popup saying item was added</span>
</span><span id="StackedApp-633"><a href="#StackedApp-633"><span class="linenos"> 633</span></a>                    <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
</span><span id="StackedApp-634"><a href="#StackedApp-634"><span class="linenos"> 634</span></a>                    <span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp-635"><a href="#StackedApp-635"><span class="linenos"> 635</span></a>                    <span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Item </span><span class="si">{</span><span class="n">notes</span><span class="si">}</span><span class="s2"> added to database.&quot;</span><span class="p">)</span>
</span><span id="StackedApp-636"><a href="#StackedApp-636"><span class="linenos"> 636</span></a>                    <span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Item Added&quot;</span><span class="p">)</span>
</span><span id="StackedApp-637"><a href="#StackedApp-637"><span class="linenos"> 637</span></a>                    <span class="n">ok_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">)</span>
</span><span id="StackedApp-638"><a href="#StackedApp-638"><span class="linenos"> 638</span></a>                    <span class="n">ok_button</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">35</span><span class="p">)</span>
</span><span id="StackedApp-639"><a href="#StackedApp-639"><span class="linenos"> 639</span></a>                    <span class="n">msg</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="n">ok_button</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">AcceptRole</span><span class="p">)</span>
</span><span id="StackedApp-640"><a href="#StackedApp-640"><span class="linenos"> 640</span></a>                    <span class="n">msg</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp-641"><a href="#StackedApp-641"><span class="linenos"> 641</span></a>
</span><span id="StackedApp-642"><a href="#StackedApp-642"><span class="linenos"> 642</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-643"><a href="#StackedApp-643"><span class="linenos"> 643</span></a>                    <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="StackedApp-644"><a href="#StackedApp-644"><span class="linenos"> 644</span></a>                        <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;insert&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-645"><a href="#StackedApp-645"><span class="linenos"> 645</span></a>                    <span class="c1"># item_dialog.dataEntered.connect(self.edit_db_item)</span>
</span><span id="StackedApp-646"><a href="#StackedApp-646"><span class="linenos"> 646</span></a>                    <span class="k">if</span> <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
</span><span id="StackedApp-647"><a href="#StackedApp-647"><span class="linenos"> 647</span></a>                        <span class="c1"># get the item from the item dialog</span>
</span><span id="StackedApp-648"><a href="#StackedApp-648"><span class="linenos"> 648</span></a>                        <span class="n">item</span> <span class="o">=</span> <span class="n">item_dialog</span><span class="o">.</span><span class="n">get_item</span><span class="p">()</span>
</span><span id="StackedApp-649"><a href="#StackedApp-649"><span class="linenos"> 649</span></a>                        <span class="c1"># open the edit item dialog</span>
</span><span id="StackedApp-650"><a href="#StackedApp-650"><span class="linenos"> 650</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">insert_into_db</span><span class="p">(</span><span class="n">item_dict</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="StackedApp-651"><a href="#StackedApp-651"><span class="linenos"> 651</span></a>
</span><span id="StackedApp-652"><a href="#StackedApp-652"><span class="linenos"> 652</span></a>                <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;INSERT&quot;</span><span class="p">,</span>
</span><span id="StackedApp-653"><a href="#StackedApp-653"><span class="linenos"> 653</span></a>                          <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">notes</span><span class="si">}</span><span class="s2"> into database&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp-654"><a href="#StackedApp-654"><span class="linenos"> 654</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp-655"><a href="#StackedApp-655"><span class="linenos"> 655</span></a>                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Inserted&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">notes</span><span class="si">}</span><span class="s2"> into database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp-656"><a href="#StackedApp-656"><span class="linenos"> 656</span></a>                <span class="k">return</span>
</span><span id="StackedApp-657"><a href="#StackedApp-657"><span class="linenos"> 657</span></a>        <span class="c1"># if user closes the notes dialog or something else goes wrong:</span>
</span><span id="StackedApp-658"><a href="#StackedApp-658"><span class="linenos"> 658</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-659"><a href="#StackedApp-659"><span class="linenos"> 659</span></a>            <span class="c1"># just open the item dialog with a blank item</span>
</span><span id="StackedApp-660"><a href="#StackedApp-660"><span class="linenos"> 660</span></a>            <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="StackedApp-661"><a href="#StackedApp-661"><span class="linenos"> 661</span></a>                <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;insert&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-662"><a href="#StackedApp-662"><span class="linenos"> 662</span></a>            <span class="c1"># item_dialog.dataEntered.connect(self.edit_db_item)</span>
</span><span id="StackedApp-663"><a href="#StackedApp-663"><span class="linenos"> 663</span></a>            <span class="k">if</span> <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
</span><span id="StackedApp-664"><a href="#StackedApp-664"><span class="linenos"> 664</span></a>                <span class="c1"># get the item from the item dialog</span>
</span><span id="StackedApp-665"><a href="#StackedApp-665"><span class="linenos"> 665</span></a>                <span class="n">item</span> <span class="o">=</span> <span class="n">item_dialog</span><span class="o">.</span><span class="n">get_item</span><span class="p">()</span>
</span><span id="StackedApp-666"><a href="#StackedApp-666"><span class="linenos"> 666</span></a>                <span class="c1"># open the edit item dialog</span>
</span><span id="StackedApp-667"><a href="#StackedApp-667"><span class="linenos"> 667</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">insert_into_db</span><span class="p">(</span><span class="n">item_dict</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="StackedApp-668"><a href="#StackedApp-668"><span class="linenos"> 668</span></a>                <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;INSERT&quot;</span><span class="p">,</span>
</span><span id="StackedApp-669"><a href="#StackedApp-669"><span class="linenos"> 669</span></a>                          <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> into the database&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp-670"><a href="#StackedApp-670"><span class="linenos"> 670</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp-671"><a href="#StackedApp-671"><span class="linenos"> 671</span></a>                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Inserted&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2"> into database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp-672"><a href="#StackedApp-672"><span class="linenos"> 672</span></a>
</span><span id="StackedApp-673"><a href="#StackedApp-673"><span class="linenos"> 673</span></a>    <span class="k">def</span> <span class="nf">edit_app_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_arg</span><span class="p">):</span>
</span><span id="StackedApp-674"><a href="#StackedApp-674"><span class="linenos"> 674</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-675"><a href="#StackedApp-675"><span class="linenos"> 675</span></a><span class="sd">        edit_app_item called when the user double-clicks either a an item via a table row, or a widget on a dashboard. When the user double-clicks a table row, input_arg will be a QModelIndex. When the user clicks dashboard widget, input_arge will be a dictionary of the widget&#39;s details.</span>
</span><span id="StackedApp-676"><a href="#StackedApp-676"><span class="linenos"> 676</span></a>
</span><span id="StackedApp-677"><a href="#StackedApp-677"><span class="linenos"> 677</span></a><span class="sd">        This function is meant to combine the multiple edit functions present in previous versions.</span>
</span><span id="StackedApp-678"><a href="#StackedApp-678"><span class="linenos"> 678</span></a>
</span><span id="StackedApp-679"><a href="#StackedApp-679"><span class="linenos"> 679</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp-680"><a href="#StackedApp-680"><span class="linenos"> 680</span></a><span class="sd">            input_arg (_type_): _description_</span>
</span><span id="StackedApp-681"><a href="#StackedApp-681"><span class="linenos"> 681</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-682"><a href="#StackedApp-682"><span class="linenos"> 682</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_arg</span><span class="p">,</span> <span class="n">QModelIndex</span><span class="p">):</span>
</span><span id="StackedApp-683"><a href="#StackedApp-683"><span class="linenos"> 683</span></a>            <span class="n">row</span> <span class="o">=</span> <span class="n">input_arg</span><span class="o">.</span><span class="n">row</span><span class="p">()</span>
</span><span id="StackedApp-684"><a href="#StackedApp-684"><span class="linenos"> 684</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StackedApp-685"><a href="#StackedApp-685"><span class="linenos"> 685</span></a>            <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">columnCount</span><span class="p">()):</span>
</span><span id="StackedApp-686"><a href="#StackedApp-686"><span class="linenos"> 686</span></a>                <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">headerData</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">)</span>
</span><span id="StackedApp-687"><a href="#StackedApp-687"><span class="linenos"> 687</span></a>                <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">DisplayRole</span><span class="p">)</span>
</span><span id="StackedApp-688"><a href="#StackedApp-688"><span class="linenos"> 688</span></a>                <span class="n">data</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">item</span>
</span><span id="StackedApp-689"><a href="#StackedApp-689"><span class="linenos"> 689</span></a>            <span class="c1"># open item dialog with the item dictionary</span>
</span><span id="StackedApp-690"><a href="#StackedApp-690"><span class="linenos"> 690</span></a>            <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="StackedApp-691"><a href="#StackedApp-691"><span class="linenos"> 691</span></a>                <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_item</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="StackedApp-692"><a href="#StackedApp-692"><span class="linenos"> 692</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">db_operation</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_item_dialog</span><span class="p">)</span>
</span><span id="StackedApp-693"><a href="#StackedApp-693"><span class="linenos"> 693</span></a>
</span><span id="StackedApp-694"><a href="#StackedApp-694"><span class="linenos"> 694</span></a>            <span class="c1"># item_dialog.dataEntered.connect(self.edit_db_item)</span>
</span><span id="StackedApp-695"><a href="#StackedApp-695"><span class="linenos"> 695</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp-696"><a href="#StackedApp-696"><span class="linenos"> 696</span></a>            <span class="c1"># return</span>
</span><span id="StackedApp-697"><a href="#StackedApp-697"><span class="linenos"> 697</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_arg</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StackedApp-698"><a href="#StackedApp-698"><span class="linenos"> 698</span></a>            <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="StackedApp-699"><a href="#StackedApp-699"><span class="linenos"> 699</span></a>                <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_item</span><span class="o">=</span><span class="n">input_arg</span><span class="p">)</span>
</span><span id="StackedApp-700"><a href="#StackedApp-700"><span class="linenos"> 700</span></a>            <span class="c1"># item_dialog.dataEntered.connect(self.edit_db_item)</span>
</span><span id="StackedApp-701"><a href="#StackedApp-701"><span class="linenos"> 701</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">db_operation</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_item_dialog</span><span class="p">)</span>
</span><span id="StackedApp-702"><a href="#StackedApp-702"><span class="linenos"> 702</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp-703"><a href="#StackedApp-703"><span class="linenos"> 703</span></a>
</span><span id="StackedApp-704"><a href="#StackedApp-704"><span class="linenos"> 704</span></a>            <span class="c1"># return</span>
</span><span id="StackedApp-705"><a href="#StackedApp-705"><span class="linenos"> 705</span></a>        <span class="k">elif</span> <span class="n">input_arg</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StackedApp-706"><a href="#StackedApp-706"><span class="linenos"> 706</span></a>            <span class="n">popup</span> <span class="o">=</span> <span class="n">FindItemDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-707"><a href="#StackedApp-707"><span class="linenos"> 707</span></a>            <span class="n">popup</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp-708"><a href="#StackedApp-708"><span class="linenos"> 708</span></a>            <span class="k">if</span> <span class="n">popup</span><span class="o">.</span><span class="n">result</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="StackedApp-709"><a href="#StackedApp-709"><span class="linenos"> 709</span></a>                <span class="c1"># get the code and upc from the popup</span>
</span><span id="StackedApp-710"><a href="#StackedApp-710"><span class="linenos"> 710</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">popup</span><span class="o">.</span><span class="n">code</span>
</span><span id="StackedApp-711"><a href="#StackedApp-711"><span class="linenos"> 711</span></a>                <span class="n">upc</span> <span class="o">=</span> <span class="n">popup</span><span class="o">.</span><span class="n">upc</span>
</span><span id="StackedApp-712"><a href="#StackedApp-712"><span class="linenos"> 712</span></a>
</span><span id="StackedApp-713"><a href="#StackedApp-713"><span class="linenos"> 713</span></a>                <span class="c1"># construct query using the parameters entered (either code, upc, or both)</span>
</span><span id="StackedApp-714"><a href="#StackedApp-714"><span class="linenos"> 714</span></a>                <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">upc</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="StackedApp-715"><a href="#StackedApp-715"><span class="linenos"> 715</span></a>                    <span class="k">return</span>
</span><span id="StackedApp-716"><a href="#StackedApp-716"><span class="linenos"> 716</span></a>                <span class="k">elif</span> <span class="n">code</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="StackedApp-717"><a href="#StackedApp-717"><span class="linenos"> 717</span></a>                    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM inventory WHERE upc=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">upc</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="StackedApp-718"><a href="#StackedApp-718"><span class="linenos"> 718</span></a>                <span class="k">elif</span> <span class="n">upc</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="StackedApp-719"><a href="#StackedApp-719"><span class="linenos"> 719</span></a>                    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM inventory WHERE code=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="StackedApp-720"><a href="#StackedApp-720"><span class="linenos"> 720</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-721"><a href="#StackedApp-721"><span class="linenos"> 721</span></a>                    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM inventory WHERE code=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2"> AND upc=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">upc</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="StackedApp-722"><a href="#StackedApp-722"><span class="linenos"> 722</span></a>                <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_database</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">fetch_num</span><span class="o">=</span><span class="s2">&quot;one&quot;</span><span class="p">)</span>
</span><span id="StackedApp-723"><a href="#StackedApp-723"><span class="linenos"> 723</span></a>                <span class="c1"># if there are no results, show a popup saying that no item was found</span>
</span><span id="StackedApp-724"><a href="#StackedApp-724"><span class="linenos"> 724</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="StackedApp-725"><a href="#StackedApp-725"><span class="linenos"> 725</span></a>                    <span class="k">return</span>
</span><span id="StackedApp-726"><a href="#StackedApp-726"><span class="linenos"> 726</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-727"><a href="#StackedApp-727"><span class="linenos"> 727</span></a>                    <span class="c1"># if there are results, populate the item dialog with the data</span>
</span><span id="StackedApp-728"><a href="#StackedApp-728"><span class="linenos"> 728</span></a>                    <span class="c1"># open item dialog with data pre-populated</span>
</span><span id="StackedApp-729"><a href="#StackedApp-729"><span class="linenos"> 729</span></a>                    <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="StackedApp-730"><a href="#StackedApp-730"><span class="linenos"> 730</span></a>                        <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_item</span><span class="o">=</span><span class="n">results</span><span class="p">)</span>
</span><span id="StackedApp-731"><a href="#StackedApp-731"><span class="linenos"> 731</span></a>                    <span class="n">item_dialog</span><span class="o">.</span><span class="n">db_operation</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_item_dialog</span><span class="p">)</span>
</span><span id="StackedApp-732"><a href="#StackedApp-732"><span class="linenos"> 732</span></a>                    <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp-733"><a href="#StackedApp-733"><span class="linenos"> 733</span></a>
</span><span id="StackedApp-734"><a href="#StackedApp-734"><span class="linenos"> 734</span></a>        <span class="c1"># if there are results, populate the item dialog with the data</span>
</span><span id="StackedApp-735"><a href="#StackedApp-735"><span class="linenos"> 735</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-736"><a href="#StackedApp-736"><span class="linenos"> 736</span></a>            <span class="c1"># open item dialog with data pre-populated</span>
</span><span id="StackedApp-737"><a href="#StackedApp-737"><span class="linenos"> 737</span></a>            <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="StackedApp-738"><a href="#StackedApp-738"><span class="linenos"> 738</span></a>                <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_item</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="StackedApp-739"><a href="#StackedApp-739"><span class="linenos"> 739</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">db_operation</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_item_dialog</span><span class="p">)</span>
</span><span id="StackedApp-740"><a href="#StackedApp-740"><span class="linenos"> 740</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp-741"><a href="#StackedApp-741"><span class="linenos"> 741</span></a>
</span><span id="StackedApp-742"><a href="#StackedApp-742"><span class="linenos"> 742</span></a>    <span class="k">def</span> <span class="nf">delete_from_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_arg</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="StackedApp-743"><a href="#StackedApp-743"><span class="linenos"> 743</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-744"><a href="#StackedApp-744"><span class="linenos"> 744</span></a><span class="sd">        delete_from_db deletes item from the database, and from the table on display (if applicable).</span>
</span><span id="StackedApp-745"><a href="#StackedApp-745"><span class="linenos"> 745</span></a>
</span><span id="StackedApp-746"><a href="#StackedApp-746"><span class="linenos"> 746</span></a><span class="sd">        Function is called when the user clicks on the trash can icon, after double-clicking a row on a table or widget on a dashboard.</span>
</span><span id="StackedApp-747"><a href="#StackedApp-747"><span class="linenos"> 747</span></a>
</span><span id="StackedApp-748"><a href="#StackedApp-748"><span class="linenos"> 748</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp-749"><a href="#StackedApp-749"><span class="linenos"> 749</span></a><span class="sd">            input_arg (_type_, optional): _description_. Defaults to None.</span>
</span><span id="StackedApp-750"><a href="#StackedApp-750"><span class="linenos"> 750</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-751"><a href="#StackedApp-751"><span class="linenos"> 751</span></a>        <span class="n">description</span> <span class="o">=</span> <span class="n">input_arg</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span>
</span><span id="StackedApp-752"><a href="#StackedApp-752"><span class="linenos"> 752</span></a>        <span class="n">upc</span> <span class="o">=</span> <span class="n">input_arg</span><span class="p">[</span><span class="s2">&quot;upc&quot;</span><span class="p">]</span>
</span><span id="StackedApp-753"><a href="#StackedApp-753"><span class="linenos"> 753</span></a>
</span><span id="StackedApp-754"><a href="#StackedApp-754"><span class="linenos"> 754</span></a>        <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="StackedApp-755"><a href="#StackedApp-755"><span class="linenos"> 755</span></a>            <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="StackedApp-756"><a href="#StackedApp-756"><span class="linenos"> 756</span></a>            <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="StackedApp-757"><a href="#StackedApp-757"><span class="linenos"> 757</span></a>            <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="StackedApp-758"><a href="#StackedApp-758"><span class="linenos"> 758</span></a>            <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="StackedApp-759"><a href="#StackedApp-759"><span class="linenos"> 759</span></a>            <span class="n">dicttrue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="StackedApp-760"><a href="#StackedApp-760"><span class="linenos"> 760</span></a>        <span class="p">)</span>
</span><span id="StackedApp-761"><a href="#StackedApp-761"><span class="linenos"> 761</span></a>        <span class="n">delete_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;DELETE FROM </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> WHERE upc = </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">upc</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2"> AND description=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="StackedApp-762"><a href="#StackedApp-762"><span class="linenos"> 762</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">delete_query</span><span class="p">)</span>
</span><span id="StackedApp-763"><a href="#StackedApp-763"><span class="linenos"> 763</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="StackedApp-764"><a href="#StackedApp-764"><span class="linenos"> 764</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp-765"><a href="#StackedApp-765"><span class="linenos"> 765</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp-766"><a href="#StackedApp-766"><span class="linenos"> 766</span></a>        <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
</span><span id="StackedApp-767"><a href="#StackedApp-767"><span class="linenos"> 767</span></a>                  <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Deleted </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2"> from database&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp-768"><a href="#StackedApp-768"><span class="linenos"> 768</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp-769"><a href="#StackedApp-769"><span class="linenos"> 769</span></a>            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Deleted&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Deleted </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2"> from database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp-770"><a href="#StackedApp-770"><span class="linenos"> 770</span></a>        <span class="c1"># if a table is being displayed, then get currently selected row and delete it from the table</span>
</span><span id="StackedApp-771"><a href="#StackedApp-771"><span class="linenos"> 771</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="StackedApp-772"><a href="#StackedApp-772"><span class="linenos"> 772</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">()</span>
</span><span id="StackedApp-773"><a href="#StackedApp-773"><span class="linenos"> 773</span></a>
</span><span id="StackedApp-774"><a href="#StackedApp-774"><span class="linenos"> 774</span></a>    <span class="k">def</span> <span class="nf">search_db_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">input_query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="StackedApp-775"><a href="#StackedApp-775"><span class="linenos"> 775</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-776"><a href="#StackedApp-776"><span class="linenos"> 776</span></a><span class="sd">        search_db_mode the user can search any of the columns in the inventory table by typing in the search bar. This function will display the results in a table.</span>
</span><span id="StackedApp-777"><a href="#StackedApp-777"><span class="linenos"> 777</span></a>
</span><span id="StackedApp-778"><a href="#StackedApp-778"><span class="linenos"> 778</span></a><span class="sd">        _extended_summary_</span>
</span><span id="StackedApp-779"><a href="#StackedApp-779"><span class="linenos"> 779</span></a>
</span><span id="StackedApp-780"><a href="#StackedApp-780"><span class="linenos"> 780</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp-781"><a href="#StackedApp-781"><span class="linenos"> 781</span></a><span class="sd">            mode (str): where the search is initiated from. Can be either &#39;table&#39; or &#39;popup&#39;, this tells the app in which QLineEdit (textbox) to look for the search term that the user has typed.</span>
</span><span id="StackedApp-782"><a href="#StackedApp-782"><span class="linenos"> 782</span></a><span class="sd">            input_query (str, optional): an SQL query passed in as an argument when the search is initiated from the popup. A user can view this popup by choosing search on one of the menubars. Defaults to None.</span>
</span><span id="StackedApp-783"><a href="#StackedApp-783"><span class="linenos"> 783</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-784"><a href="#StackedApp-784"><span class="linenos"> 784</span></a>        <span class="c1"># search the database for the search term</span>
</span><span id="StackedApp-785"><a href="#StackedApp-785"><span class="linenos"> 785</span></a>        <span class="c1"># column stirng</span>
</span><span id="StackedApp-786"><a href="#StackedApp-786"><span class="linenos"> 786</span></a>        <span class="n">column_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="StackedApp-787"><a href="#StackedApp-787"><span class="linenos"> 787</span></a>        <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="StackedApp-788"><a href="#StackedApp-788"><span class="linenos"> 788</span></a>            <span class="n">column_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="StackedApp-789"><a href="#StackedApp-789"><span class="linenos"> 789</span></a>        <span class="n">column_str</span> <span class="o">=</span> <span class="n">column_str</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="StackedApp-790"><a href="#StackedApp-790"><span class="linenos"> 790</span></a>        <span class="c1"># set the table model to the results of the search</span>
</span><span id="StackedApp-791"><a href="#StackedApp-791"><span class="linenos"> 791</span></a>        <span class="c1"># if mode is table, get text from table qlineedit</span>
</span><span id="StackedApp-792"><a href="#StackedApp-792"><span class="linenos"> 792</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;table&quot;</span><span class="p">:</span>
</span><span id="StackedApp-793"><a href="#StackedApp-793"><span class="linenos"> 793</span></a>            <span class="n">search_term</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span><span id="StackedApp-794"><a href="#StackedApp-794"><span class="linenos"> 794</span></a>            <span class="c1"># get column name from combobox</span>
</span><span id="StackedApp-795"><a href="#StackedApp-795"><span class="linenos"> 795</span></a>            <span class="n">column_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
</span><span id="StackedApp-796"><a href="#StackedApp-796"><span class="linenos"> 796</span></a>            <span class="k">if</span> <span class="n">search_term</span> <span class="ow">and</span> <span class="n">column_name</span> <span class="o">!=</span> <span class="s2">&quot;Choose column:&quot;</span><span class="p">:</span>
</span><span id="StackedApp-797"><a href="#StackedApp-797"><span class="linenos"> 797</span></a>                <span class="c1"># construct query</span>
</span><span id="StackedApp-798"><a href="#StackedApp-798"><span class="linenos"> 798</span></a>                <span class="c1"># CANNOT just use * in query, because the table model will not be able to match the correct column&#39;s data to the correct column header</span>
</span><span id="StackedApp-799"><a href="#StackedApp-799"><span class="linenos"> 799</span></a>                <span class="c1"># TODO: Try to fix the above issue.</span>
</span><span id="StackedApp-800"><a href="#StackedApp-800"><span class="linenos"> 800</span></a>                <span class="n">search_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT </span><span class="si">{</span><span class="n">column_str</span><span class="si">}</span><span class="s2"> FROM inventory WHERE </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> LIKE &#39;%</span><span class="si">{</span><span class="n">search_term</span><span class="si">}</span><span class="s2">%&#39;&quot;</span>
</span><span id="StackedApp-801"><a href="#StackedApp-801"><span class="linenos"> 801</span></a>                <span class="n">new_title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Search Results: </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">search_term</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StackedApp-802"><a href="#StackedApp-802"><span class="linenos"> 802</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">search_query</span><span class="p">)</span>
</span><span id="StackedApp-803"><a href="#StackedApp-803"><span class="linenos"> 803</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_title_text</span><span class="p">(</span><span class="n">new_title</span><span class="p">)</span>
</span><span id="StackedApp-804"><a href="#StackedApp-804"><span class="linenos"> 804</span></a>        <span class="c1"># if search is done from the popup dialog</span>
</span><span id="StackedApp-805"><a href="#StackedApp-805"><span class="linenos"> 805</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;popup&quot;</span><span class="p">:</span>
</span><span id="StackedApp-806"><a href="#StackedApp-806"><span class="linenos"> 806</span></a>            <span class="c1"># don&#39;t need to get search text because query passed in input_query</span>
</span><span id="StackedApp-807"><a href="#StackedApp-807"><span class="linenos"> 807</span></a>            <span class="n">search_query</span> <span class="o">=</span> <span class="n">input_query</span>
</span><span id="StackedApp-808"><a href="#StackedApp-808"><span class="linenos"> 808</span></a>            <span class="n">new_title</span> <span class="o">=</span> <span class="s2">&quot;Search Results:&quot;</span>
</span><span id="StackedApp-809"><a href="#StackedApp-809"><span class="linenos"> 809</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">search_query</span><span class="p">)</span>
</span><span id="StackedApp-810"><a href="#StackedApp-810"><span class="linenos"> 810</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_title_text</span><span class="p">(</span><span class="n">new_title</span><span class="p">)</span>
</span><span id="StackedApp-811"><a href="#StackedApp-811"><span class="linenos"> 811</span></a>
</span><span id="StackedApp-812"><a href="#StackedApp-812"><span class="linenos"> 812</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_table_page</span><span class="p">()</span>
</span><span id="StackedApp-813"><a href="#StackedApp-813"><span class="linenos"> 813</span></a>
</span><span id="StackedApp-814"><a href="#StackedApp-814"><span class="linenos"> 814</span></a>    <span class="k">def</span> <span class="nf">backup_to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">notification</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="StackedApp-815"><a href="#StackedApp-815"><span class="linenos"> 815</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-816"><a href="#StackedApp-816"><span class="linenos"> 816</span></a><span class="sd">        backup_to_csv first prompts the user with a yes/no popup asking if they&#39;d like to backup the inventory table to a csv file. If yes, then the table is backed up to a csv file in the &lt;b&gt;output folder.&lt;/b&gt;</span>
</span><span id="StackedApp-817"><a href="#StackedApp-817"><span class="linenos"> 817</span></a>
</span><span id="StackedApp-818"><a href="#StackedApp-818"><span class="linenos"> 818</span></a><span class="sd">        If the user hasn&#39;t muted the app&#39;s notifications, then a notification is sent to the system tray with the filename. CSV filenames are auto-generated with the date and time appended to the end.</span>
</span><span id="StackedApp-819"><a href="#StackedApp-819"><span class="linenos"> 819</span></a>
</span><span id="StackedApp-820"><a href="#StackedApp-820"><span class="linenos"> 820</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp-821"><a href="#StackedApp-821"><span class="linenos"> 821</span></a><span class="sd">            notification (bool, optional): _description_. Defaults to True.</span>
</span><span id="StackedApp-822"><a href="#StackedApp-822"><span class="linenos"> 822</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-823"><a href="#StackedApp-823"><span class="linenos"> 823</span></a>        <span class="c1"># output filename is auto-created</span>
</span><span id="StackedApp-824"><a href="#StackedApp-824"><span class="linenos"> 824</span></a>        <span class="c1"># TODO: make config setting for this, or prompt user?</span>
</span><span id="StackedApp-825"><a href="#StackedApp-825"><span class="linenos"> 825</span></a>        <span class="c1"># first do yes no messagebox asking user if they want to backup to csv</span>
</span><span id="StackedApp-826"><a href="#StackedApp-826"><span class="linenos"> 826</span></a>        <span class="c1"># make QMessageBox w/ok button</span>
</span><span id="StackedApp-827"><a href="#StackedApp-827"><span class="linenos"> 827</span></a>        <span class="n">popup</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
</span><span id="StackedApp-828"><a href="#StackedApp-828"><span class="linenos"> 828</span></a>        <span class="n">popup</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Backup to CSV?&quot;</span><span class="p">)</span>
</span><span id="StackedApp-829"><a href="#StackedApp-829"><span class="linenos"> 829</span></a>        <span class="n">popup</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="StackedApp-830"><a href="#StackedApp-830"><span class="linenos"> 830</span></a>        <span class="n">popup</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
</span><span id="StackedApp-831"><a href="#StackedApp-831"><span class="linenos"> 831</span></a>            <span class="s2">&quot;Would you like to backup the inventory table to a CSV file?&quot;</span><span class="p">)</span>
</span><span id="StackedApp-832"><a href="#StackedApp-832"><span class="linenos"> 832</span></a>        <span class="n">popup</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Question</span><span class="p">)</span>
</span><span id="StackedApp-833"><a href="#StackedApp-833"><span class="linenos"> 833</span></a>        <span class="n">popup</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">)</span>
</span><span id="StackedApp-834"><a href="#StackedApp-834"><span class="linenos"> 834</span></a>        <span class="k">for</span> <span class="n">button</span> <span class="ow">in</span> <span class="n">popup</span><span class="o">.</span><span class="n">buttons</span><span class="p">():</span>
</span><span id="StackedApp-835"><a href="#StackedApp-835"><span class="linenos"> 835</span></a>            <span class="n">button</span><span class="o">.</span><span class="n">setCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">PointingHandCursor</span><span class="p">)</span>
</span><span id="StackedApp-836"><a href="#StackedApp-836"><span class="linenos"> 836</span></a>        <span class="k">if</span> <span class="n">popup</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
</span><span id="StackedApp-837"><a href="#StackedApp-837"><span class="linenos"> 837</span></a>            <span class="c1"># filepath is returned from databackup - put it on Okpopup for user</span>
</span><span id="StackedApp-838"><a href="#StackedApp-838"><span class="linenos"> 838</span></a>            <span class="n">backup</span> <span class="o">=</span> <span class="n">DataBackup</span><span class="p">()</span>
</span><span id="StackedApp-839"><a href="#StackedApp-839"><span class="linenos"> 839</span></a>            <span class="n">relative_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">,</span> <span class="n">backup</span><span class="o">.</span><span class="n">csvname</span><span class="p">)</span>
</span><span id="StackedApp-840"><a href="#StackedApp-840"><span class="linenos"> 840</span></a>            <span class="c1"># show popup QMessageBox with filepath</span>
</span><span id="StackedApp-841"><a href="#StackedApp-841"><span class="linenos"> 841</span></a>            <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Backup file saved to: </span><span class="si">{</span><span class="n">relative_path</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StackedApp-842"><a href="#StackedApp-842"><span class="linenos"> 842</span></a>            <span class="c1"># if user needs popup notification, do that</span>
</span><span id="StackedApp-843"><a href="#StackedApp-843"><span class="linenos"> 843</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">notification</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mute</span><span class="p">):</span>
</span><span id="StackedApp-844"><a href="#StackedApp-844"><span class="linenos"> 844</span></a>
</span><span id="StackedApp-845"><a href="#StackedApp-845"><span class="linenos"> 845</span></a>                <span class="c1"># make QMessageBox w/ok button</span>
</span><span id="StackedApp-846"><a href="#StackedApp-846"><span class="linenos"> 846</span></a>                <span class="n">popup</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
</span><span id="StackedApp-847"><a href="#StackedApp-847"><span class="linenos"> 847</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Backup Complete&quot;</span><span class="p">)</span>
</span><span id="StackedApp-848"><a href="#StackedApp-848"><span class="linenos"> 848</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="StackedApp-849"><a href="#StackedApp-849"><span class="linenos"> 849</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</span><span id="StackedApp-850"><a href="#StackedApp-850"><span class="linenos"> 850</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp-851"><a href="#StackedApp-851"><span class="linenos"> 851</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
</span><span id="StackedApp-852"><a href="#StackedApp-852"><span class="linenos"> 852</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span><span class="o">.</span><span class="n">setCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">PointingHandCursor</span><span class="p">)</span>
</span><span id="StackedApp-853"><a href="#StackedApp-853"><span class="linenos"> 853</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp-854"><a href="#StackedApp-854"><span class="linenos"> 854</span></a>                <span class="c1"># log it</span>
</span><span id="StackedApp-855"><a href="#StackedApp-855"><span class="linenos"> 855</span></a>                <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;BACKUP TO CSV&quot;</span><span class="p">,</span>
</span><span id="StackedApp-856"><a href="#StackedApp-856"><span class="linenos"> 856</span></a>                          <span class="n">comment</span><span class="o">=</span><span class="n">message</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp-857"><a href="#StackedApp-857"><span class="linenos"> 857</span></a>
</span><span id="StackedApp-858"><a href="#StackedApp-858"><span class="linenos"> 858</span></a>    <span class="c1"># Build QCompleters for search QLineEdits (Search bars)</span>
</span><span id="StackedApp-859"><a href="#StackedApp-859"><span class="linenos"> 859</span></a>
</span><span id="StackedApp-860"><a href="#StackedApp-860"><span class="linenos"> 860</span></a>    <span class="k">def</span> <span class="nf">build_qcompleters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="StackedApp-861"><a href="#StackedApp-861"><span class="linenos"> 861</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-862"><a href="#StackedApp-862"><span class="linenos"> 862</span></a><span class="sd">        build_qcompleters builds the two QCompleters used by the app. As of 5/6/23, this version of the app only uses the models completer. The codes completer is not used.</span>
</span><span id="StackedApp-863"><a href="#StackedApp-863"><span class="linenos"> 863</span></a>
</span><span id="StackedApp-864"><a href="#StackedApp-864"><span class="linenos"> 864</span></a><span class="sd">        The codes completer could be used to add an extra way of searching to the home page. There could be a couple of buttons to the left of the textbox where the user can choose to search by model or by code. The code completer would be used if the user chooses to search by code.</span>
</span><span id="StackedApp-865"><a href="#StackedApp-865"><span class="linenos"> 865</span></a>
</span><span id="StackedApp-866"><a href="#StackedApp-866"><span class="linenos"> 866</span></a><span class="sd">        Returns:</span>
</span><span id="StackedApp-867"><a href="#StackedApp-867"><span class="linenos"> 867</span></a><span class="sd">            tuple: returns a tuple containing the two QCompleters</span>
</span><span id="StackedApp-868"><a href="#StackedApp-868"><span class="linenos"> 868</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-869"><a href="#StackedApp-869"><span class="linenos"> 869</span></a>        <span class="c1"># built the printer model qcompleter to be used in the search bar on home window (possibly other locations)</span>
</span><span id="StackedApp-870"><a href="#StackedApp-870"><span class="linenos"> 870</span></a>        <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="StackedApp-871"><a href="#StackedApp-871"><span class="linenos"> 871</span></a>            <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="StackedApp-872"><a href="#StackedApp-872"><span class="linenos"> 872</span></a>            <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="StackedApp-873"><a href="#StackedApp-873"><span class="linenos"> 873</span></a>            <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="StackedApp-874"><a href="#StackedApp-874"><span class="linenos"> 874</span></a>            <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="StackedApp-875"><a href="#StackedApp-875"><span class="linenos"> 875</span></a>            <span class="n">dicttrue</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="StackedApp-876"><a href="#StackedApp-876"><span class="linenos"> 876</span></a>        <span class="p">)</span>
</span><span id="StackedApp-877"><a href="#StackedApp-877"><span class="linenos"> 877</span></a>        <span class="c1"># -- LIST OF ALL PRINTER MODELS FROM THE &#39;PRINTERS&#39; COLUMN IN THE DATABASE --</span>
</span><span id="StackedApp-878"><a href="#StackedApp-878"><span class="linenos"> 878</span></a>        <span class="n">models_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StackedApp-879"><a href="#StackedApp-879"><span class="linenos"> 879</span></a>        <span class="c1"># -- LIST OF ALL TONER/ITEM CODES FROM THE &#39;CODE&#39; COLUMN IN THE DATABASE --</span>
</span><span id="StackedApp-880"><a href="#StackedApp-880"><span class="linenos"> 880</span></a>        <span class="n">codes_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StackedApp-881"><a href="#StackedApp-881"><span class="linenos"> 881</span></a>
</span><span id="StackedApp-882"><a href="#StackedApp-882"><span class="linenos"> 882</span></a>        <span class="c1"># dictionary to hold lists of each manufacturer&#39;s printer models (to be used in the suggestion listbox part of the autocomplete Entry)</span>
</span><span id="StackedApp-883"><a href="#StackedApp-883"><span class="linenos"> 883</span></a>        <span class="n">printer_models</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StackedApp-884"><a href="#StackedApp-884"><span class="linenos"> 884</span></a>            <span class="s2">&quot;dell&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="StackedApp-885"><a href="#StackedApp-885"><span class="linenos"> 885</span></a>            <span class="s2">&quot;hp&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="StackedApp-886"><a href="#StackedApp-886"><span class="linenos"> 886</span></a>            <span class="s2">&quot;lexmark&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="StackedApp-887"><a href="#StackedApp-887"><span class="linenos"> 887</span></a>            <span class="c1"># brother, canon, epson don&#39;t have enough printers to need a table to themselves so they&#39;re combined, might change the text on the actual button to say brother,canon,epson though</span>
</span><span id="StackedApp-888"><a href="#StackedApp-888"><span class="linenos"> 888</span></a>            <span class="s2">&quot;others&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="StackedApp-889"><a href="#StackedApp-889"><span class="linenos"> 889</span></a>        <span class="p">}</span>
</span><span id="StackedApp-890"><a href="#StackedApp-890"><span class="linenos"> 890</span></a>        <span class="n">prevlist</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="StackedApp-891"><a href="#StackedApp-891"><span class="linenos"> 891</span></a>        <span class="c1"># cycle thru each of the keys in the above dictionary</span>
</span><span id="StackedApp-892"><a href="#StackedApp-892"><span class="linenos"> 892</span></a>        <span class="k">for</span> <span class="n">brand</span> <span class="ow">in</span> <span class="n">printer_models</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="StackedApp-893"><a href="#StackedApp-893"><span class="linenos"> 893</span></a>            <span class="k">if</span> <span class="n">brand</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;dell&quot;</span><span class="p">,</span> <span class="s2">&quot;hp&quot;</span><span class="p">,</span> <span class="s2">&quot;lexmark&quot;</span><span class="p">]:</span>
</span><span id="StackedApp-894"><a href="#StackedApp-894"><span class="linenos"> 894</span></a>                <span class="c1"># set query to select the &#39;printers&#39; column from each brand&#39;s table (there are three brand tables in the database - dell, hp, lexmark)</span>
</span><span id="StackedApp-895"><a href="#StackedApp-895"><span class="linenos"> 895</span></a>                <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT printers, code, brand FROM inventory WHERE brand=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">brand</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="StackedApp-896"><a href="#StackedApp-896"><span class="linenos"> 896</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-897"><a href="#StackedApp-897"><span class="linenos"> 897</span></a>                <span class="c1"># set query to select the &#39;printers&#39; column from each brand&#39;s table (there are three brand tables in the database - dell, hp, lexmark)</span>
</span><span id="StackedApp-898"><a href="#StackedApp-898"><span class="linenos"> 898</span></a>                <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT printers, code, brand FROM inventory WHERE brand NOT IN (&#39;dell&#39;, &#39;lexmark&#39;, &#39;hp&#39;)&quot;</span>
</span><span id="StackedApp-899"><a href="#StackedApp-899"><span class="linenos"> 899</span></a>
</span><span id="StackedApp-900"><a href="#StackedApp-900"><span class="linenos"> 900</span></a>            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="StackedApp-901"><a href="#StackedApp-901"><span class="linenos"> 901</span></a>            <span class="c1"># temp_list will be all resulting rows from the query</span>
</span><span id="StackedApp-902"><a href="#StackedApp-902"><span class="linenos"> 902</span></a>            <span class="n">temp_list</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span><span id="StackedApp-903"><a href="#StackedApp-903"><span class="linenos"> 903</span></a>
</span><span id="StackedApp-904"><a href="#StackedApp-904"><span class="linenos"> 904</span></a>            <span class="c1"># keys will be the  upc, with lists containing code and stock as values</span>
</span><span id="StackedApp-905"><a href="#StackedApp-905"><span class="linenos"> 905</span></a>
</span><span id="StackedApp-906"><a href="#StackedApp-906"><span class="linenos"> 906</span></a>            <span class="c1"># start cycling through each of the rows in the result, each row is a row of the &#39;printers&#39; column from the database tables</span>
</span><span id="StackedApp-907"><a href="#StackedApp-907"><span class="linenos"> 907</span></a>            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">temp_list</span><span class="p">:</span>
</span><span id="StackedApp-908"><a href="#StackedApp-908"><span class="linenos"> 908</span></a>                <span class="n">manufacturer</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="StackedApp-909"><a href="#StackedApp-909"><span class="linenos"> 909</span></a>                <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StackedApp-910"><a href="#StackedApp-910"><span class="linenos"> 910</span></a>                    <span class="n">sublist</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="StackedApp-911"><a href="#StackedApp-911"><span class="linenos"> 911</span></a>                    <span class="k">if</span> <span class="n">sublist</span> <span class="o">==</span> <span class="n">prevlist</span><span class="p">:</span>
</span><span id="StackedApp-912"><a href="#StackedApp-912"><span class="linenos"> 912</span></a>                        <span class="k">pass</span>
</span><span id="StackedApp-913"><a href="#StackedApp-913"><span class="linenos"> 913</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-914"><a href="#StackedApp-914"><span class="linenos"> 914</span></a>                        <span class="c1"># for each printer model in this list that we just created (sublist)</span>
</span><span id="StackedApp-915"><a href="#StackedApp-915"><span class="linenos"> 915</span></a>                        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">:</span>
</span><span id="StackedApp-916"><a href="#StackedApp-916"><span class="linenos"> 916</span></a>                            <span class="c1"># strip any whitespace</span>
</span><span id="StackedApp-917"><a href="#StackedApp-917"><span class="linenos"> 917</span></a>                            <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="StackedApp-918"><a href="#StackedApp-918"><span class="linenos"> 918</span></a>                            <span class="c1"># check if the model is already in the list and append it if it isn&#39;t</span>
</span><span id="StackedApp-919"><a href="#StackedApp-919"><span class="linenos"> 919</span></a>                            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">printer_models</span><span class="p">[</span><span class="n">brand</span><span class="p">]:</span>
</span><span id="StackedApp-920"><a href="#StackedApp-920"><span class="linenos"> 920</span></a>                                <span class="n">printer_models</span><span class="p">[</span><span class="n">brand</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="StackedApp-921"><a href="#StackedApp-921"><span class="linenos"> 921</span></a>                                    <span class="n">model</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="StackedApp-922"><a href="#StackedApp-922"><span class="linenos"> 922</span></a>
</span><span id="StackedApp-923"><a href="#StackedApp-923"><span class="linenos"> 923</span></a>                        <span class="c1"># for key in self.manufacturer_btns.keys():</span>
</span><span id="StackedApp-924"><a href="#StackedApp-924"><span class="linenos"> 924</span></a>                        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">printer_models</span><span class="p">[</span><span class="n">brand</span><span class="p">]:</span>
</span><span id="StackedApp-925"><a href="#StackedApp-925"><span class="linenos"> 925</span></a>                            <span class="c1"># key is the manufacturer name, model is the printer model</span>
</span><span id="StackedApp-926"><a href="#StackedApp-926"><span class="linenos"> 926</span></a>                            <span class="n">models_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">manufacturer</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="StackedApp-927"><a href="#StackedApp-927"><span class="linenos"> 927</span></a>                <span class="c1"># code gets here if the query returns no results / rows</span>
</span><span id="StackedApp-928"><a href="#StackedApp-928"><span class="linenos"> 928</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-929"><a href="#StackedApp-929"><span class="linenos"> 929</span></a>                    <span class="k">pass</span>
</span><span id="StackedApp-930"><a href="#StackedApp-930"><span class="linenos"> 930</span></a>                <span class="n">codes_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">temp_list</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="StackedApp-931"><a href="#StackedApp-931"><span class="linenos"> 931</span></a>        <span class="n">codes_list</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">codes_list</span><span class="p">)</span>
</span><span id="StackedApp-932"><a href="#StackedApp-932"><span class="linenos"> 932</span></a>        <span class="c1"># if the above loops are fixed - wont have to use this way to get unique values in list</span>
</span><span id="StackedApp-933"><a href="#StackedApp-933"><span class="linenos"> 933</span></a>        <span class="n">models_list</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">models_list</span><span class="p">)</span>
</span><span id="StackedApp-934"><a href="#StackedApp-934"><span class="linenos"> 934</span></a>        <span class="n">models_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">models_list</span><span class="p">)</span>
</span><span id="StackedApp-935"><a href="#StackedApp-935"><span class="linenos"> 935</span></a>        <span class="c1"># close connection to database</span>
</span><span id="StackedApp-936"><a href="#StackedApp-936"><span class="linenos"> 936</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp-937"><a href="#StackedApp-937"><span class="linenos"> 937</span></a>        <span class="c1"># make a QCompleter for the auto-suggestion textbox so it will suggest printer model names as you type</span>
</span><span id="StackedApp-938"><a href="#StackedApp-938"><span class="linenos"> 938</span></a>        <span class="n">models_completer</span> <span class="o">=</span> <span class="n">QCompleter</span><span class="p">(</span><span class="n">models_list</span><span class="p">)</span>
</span><span id="StackedApp-939"><a href="#StackedApp-939"><span class="linenos"> 939</span></a>        <span class="n">codes_completer</span> <span class="o">=</span> <span class="n">QCompleter</span><span class="p">(</span><span class="n">codes_list</span><span class="p">)</span>
</span><span id="StackedApp-940"><a href="#StackedApp-940"><span class="linenos"> 940</span></a>        <span class="c1"># make it case insensitive</span>
</span><span id="StackedApp-941"><a href="#StackedApp-941"><span class="linenos"> 941</span></a>        <span class="n">models_completer</span><span class="o">.</span><span class="n">setCaseSensitivity</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">CaseInsensitive</span><span class="p">)</span>
</span><span id="StackedApp-942"><a href="#StackedApp-942"><span class="linenos"> 942</span></a>        <span class="n">codes_completer</span><span class="o">.</span><span class="n">setCaseSensitivity</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">CaseInsensitive</span><span class="p">)</span>
</span><span id="StackedApp-943"><a href="#StackedApp-943"><span class="linenos"> 943</span></a>
</span><span id="StackedApp-944"><a href="#StackedApp-944"><span class="linenos"> 944</span></a>        <span class="k">return</span> <span class="n">models_completer</span><span class="p">,</span> <span class="n">codes_completer</span>
</span><span id="StackedApp-945"><a href="#StackedApp-945"><span class="linenos"> 945</span></a>
</span><span id="StackedApp-946"><a href="#StackedApp-946"><span class="linenos"> 946</span></a>    <span class="k">def</span> <span class="nf">build_tray</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="StackedApp-947"><a href="#StackedApp-947"><span class="linenos"> 947</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-948"><a href="#StackedApp-948"><span class="linenos"> 948</span></a><span class="sd">        build_tray build_tray_menu builds the tray menu and adds the context menu and actions to it. It uses the icon from config.yaml, like alot of the popups and other things in the app.</span>
</span><span id="StackedApp-949"><a href="#StackedApp-949"><span class="linenos"> 949</span></a>
</span><span id="StackedApp-950"><a href="#StackedApp-950"><span class="linenos"> 950</span></a><span class="sd">        Clicking on the tray icon doesn&#39;t seem to work in Windows 11, and the tray icon exhibits other wierd behaviors. Note --&gt; try it out in Windows 10 to get confirmation that it works there.</span>
</span><span id="StackedApp-951"><a href="#StackedApp-951"><span class="linenos"> 951</span></a>
</span><span id="StackedApp-952"><a href="#StackedApp-952"><span class="linenos"> 952</span></a><span class="sd">        Returns:</span>
</span><span id="StackedApp-953"><a href="#StackedApp-953"><span class="linenos"> 953</span></a><span class="sd">            tuple: returns a tuple containg the QSystemTrayIcon and the QMenu that&#39;s attached to it.</span>
</span><span id="StackedApp-954"><a href="#StackedApp-954"><span class="linenos"> 954</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-955"><a href="#StackedApp-955"><span class="linenos"> 955</span></a>        <span class="n">tray_icon</span> <span class="o">=</span> <span class="n">QSystemTrayIcon</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-956"><a href="#StackedApp-956"><span class="linenos"> 956</span></a>        <span class="n">tray_icon</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="StackedApp-957"><a href="#StackedApp-957"><span class="linenos"> 957</span></a>        <span class="n">tray_icon</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">app_name</span><span class="p">)</span>
</span><span id="StackedApp-958"><a href="#StackedApp-958"><span class="linenos"> 958</span></a>
</span><span id="StackedApp-959"><a href="#StackedApp-959"><span class="linenos"> 959</span></a>        <span class="c1"># create the tray menu</span>
</span><span id="StackedApp-960"><a href="#StackedApp-960"><span class="linenos"> 960</span></a>        <span class="n">tray_menu</span> <span class="o">=</span> <span class="n">QMenu</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-961"><a href="#StackedApp-961"><span class="linenos"> 961</span></a>        <span class="n">tray_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s2">&quot;About&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_help_dialog</span><span class="p">)</span>
</span><span id="StackedApp-962"><a href="#StackedApp-962"><span class="linenos"> 962</span></a>        <span class="n">tray_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s2">&quot;Exit&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
</span><span id="StackedApp-963"><a href="#StackedApp-963"><span class="linenos"> 963</span></a>        <span class="n">tray_icon</span><span class="o">.</span><span class="n">setContextMenu</span><span class="p">(</span><span class="n">tray_menu</span><span class="p">)</span>
</span><span id="StackedApp-964"><a href="#StackedApp-964"><span class="linenos"> 964</span></a>        <span class="k">return</span> <span class="n">tray_icon</span><span class="p">,</span> <span class="n">tray_menu</span>
</span><span id="StackedApp-965"><a href="#StackedApp-965"><span class="linenos"> 965</span></a>
</span><span id="StackedApp-966"><a href="#StackedApp-966"><span class="linenos"> 966</span></a>    <span class="k">def</span> <span class="nf">gen_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">notif_type</span><span class="p">:</span> <span class="n">QSystemTrayIcon</span> <span class="o">=</span> <span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">):</span>
</span><span id="StackedApp-967"><a href="#StackedApp-967"><span class="linenos"> 967</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-968"><a href="#StackedApp-968"><span class="linenos"> 968</span></a><span class="sd">        gen_notification generates a notification using the title and message provided. Notif_type is set to Information by default, but can be changed to Warning or Critical to change the icon that is displayed with the notification.</span>
</span><span id="StackedApp-969"><a href="#StackedApp-969"><span class="linenos"> 969</span></a>
</span><span id="StackedApp-970"><a href="#StackedApp-970"><span class="linenos"> 970</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp-971"><a href="#StackedApp-971"><span class="linenos"> 971</span></a><span class="sd">            title (str): the title of the system tray notification.</span>
</span><span id="StackedApp-972"><a href="#StackedApp-972"><span class="linenos"> 972</span></a><span class="sd">            message (str): the message body of the system tray notification.</span>
</span><span id="StackedApp-973"><a href="#StackedApp-973"><span class="linenos"> 973</span></a><span class="sd">            notif_type (QSystemTrayIcon, optional): the type of icon to be displayed with the system tray icon. Defaults to QSystemTrayIcon.Information.</span>
</span><span id="StackedApp-974"><a href="#StackedApp-974"><span class="linenos"> 974</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-975"><a href="#StackedApp-975"><span class="linenos"> 975</span></a>        <span class="c1"># if user has muted notifications, don&#39;t notify them</span>
</span><span id="StackedApp-976"><a href="#StackedApp-976"><span class="linenos"> 976</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mute</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="StackedApp-977"><a href="#StackedApp-977"><span class="linenos"> 977</span></a>            <span class="k">return</span>
</span><span id="StackedApp-978"><a href="#StackedApp-978"><span class="linenos"> 978</span></a>        <span class="c1"># create a notification</span>
</span><span id="StackedApp-979"><a href="#StackedApp-979"><span class="linenos"> 979</span></a>        <span class="n">notification</span> <span class="o">=</span> <span class="n">QSystemTrayIcon</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-980"><a href="#StackedApp-980"><span class="linenos"> 980</span></a>        <span class="n">notification</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="StackedApp-981"><a href="#StackedApp-981"><span class="linenos"> 981</span></a>        <span class="n">notification</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="StackedApp-982"><a href="#StackedApp-982"><span class="linenos"> 982</span></a>        <span class="n">notification</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">notif_type</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
</span><span id="StackedApp-983"><a href="#StackedApp-983"><span class="linenos"> 983</span></a>
</span><span id="StackedApp-984"><a href="#StackedApp-984"><span class="linenos"> 984</span></a>    <span class="k">def</span> <span class="nf">change_table_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp-985"><a href="#StackedApp-985"><span class="linenos"> 985</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-986"><a href="#StackedApp-986"><span class="linenos"> 986</span></a><span class="sd">        change_table_columns user can add or remove columns from the table that is currently being shown, using a popup that appears.</span>
</span><span id="StackedApp-987"><a href="#StackedApp-987"><span class="linenos"> 987</span></a>
</span><span id="StackedApp-988"><a href="#StackedApp-988"><span class="linenos"> 988</span></a><span class="sd">        If a table isn&#39;t currently being shown, nothing will happen.</span>
</span><span id="StackedApp-989"><a href="#StackedApp-989"><span class="linenos"> 989</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-990"><a href="#StackedApp-990"><span class="linenos"> 990</span></a>        <span class="c1"># the model attribute is created when a spreadsheet is shown</span>
</span><span id="StackedApp-991"><a href="#StackedApp-991"><span class="linenos"> 991</span></a>        <span class="n">initialize_config</span><span class="p">(</span>
</span><span id="StackedApp-992"><a href="#StackedApp-992"><span class="linenos"> 992</span></a>            <span class="bp">self</span>
</span><span id="StackedApp-993"><a href="#StackedApp-993"><span class="linenos"> 993</span></a>        <span class="p">)</span>  <span class="c1"># reread the config to get the selected column names, they might be new since start of app</span>
</span><span id="StackedApp-994"><a href="#StackedApp-994"><span class="linenos"> 994</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="StackedApp-995"><a href="#StackedApp-995"><span class="linenos"> 995</span></a>            <span class="c1"># get used columns from the config</span>
</span><span id="StackedApp-996"><a href="#StackedApp-996"><span class="linenos"> 996</span></a>            <span class="n">selected_columns</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StackedApp-997"><a href="#StackedApp-997"><span class="linenos"> 997</span></a>            <span class="c1"># self.selected_columns is set in initialize_config</span>
</span><span id="StackedApp-998"><a href="#StackedApp-998"><span class="linenos"> 998</span></a>            <span class="n">used_column_names</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="StackedApp-999"><a href="#StackedApp-999"><span class="linenos"> 999</span></a>                <span class="n">column_name</span> <span class="k">for</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_columns</span><span class="p">]</span>
</span><span id="StackedApp-1000"><a href="#StackedApp-1000"><span class="linenos">1000</span></a>            <span class="n">unused_columms</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StackedApp-1001"><a href="#StackedApp-1001"><span class="linenos">1001</span></a>            <span class="c1"># get indices of columns</span>
</span><span id="StackedApp-1002"><a href="#StackedApp-1002"><span class="linenos">1002</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StackedApp-1003"><a href="#StackedApp-1003"><span class="linenos">1003</span></a>                <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">used_column_names</span><span class="p">:</span>
</span><span id="StackedApp-1004"><a href="#StackedApp-1004"><span class="linenos">1004</span></a>                    <span class="c1"># selected_columns[selected_columns.index(value)] = index</span>
</span><span id="StackedApp-1005"><a href="#StackedApp-1005"><span class="linenos">1005</span></a>                    <span class="n">selected_columns</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)])</span>
</span><span id="StackedApp-1006"><a href="#StackedApp-1006"><span class="linenos">1006</span></a>                    <span class="c1"># selected_columns.replace(value[0], index)</span>
</span><span id="StackedApp-1007"><a href="#StackedApp-1007"><span class="linenos">1007</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-1008"><a href="#StackedApp-1008"><span class="linenos">1008</span></a>                    <span class="n">unused_columms</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)])</span>
</span><span id="StackedApp-1009"><a href="#StackedApp-1009"><span class="linenos">1009</span></a>
</span><span id="StackedApp-1010"><a href="#StackedApp-1010"><span class="linenos">1010</span></a>            <span class="n">header_list</span> <span class="o">=</span> <span class="n">selected_columns</span>
</span><span id="StackedApp-1011"><a href="#StackedApp-1011"><span class="linenos">1011</span></a>            <span class="n">unused_header_list</span> <span class="o">=</span> <span class="n">unused_columms</span>
</span><span id="StackedApp-1012"><a href="#StackedApp-1012"><span class="linenos">1012</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="StackedApp-1013"><a href="#StackedApp-1013"><span class="linenos">1013</span></a>                <span class="n">dialog</span> <span class="o">=</span> <span class="n">ColumnEdit</span><span class="p">(</span>
</span><span id="StackedApp-1014"><a href="#StackedApp-1014"><span class="linenos">1014</span></a>                    <span class="n">header_list</span><span class="p">,</span> <span class="n">unused_header_list</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-1015"><a href="#StackedApp-1015"><span class="linenos">1015</span></a>
</span><span id="StackedApp-1016"><a href="#StackedApp-1016"><span class="linenos">1016</span></a>                <span class="k">if</span> <span class="n">dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
</span><span id="StackedApp-1017"><a href="#StackedApp-1017"><span class="linenos">1017</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">table_columns</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">get_values</span><span class="p">()</span>
</span><span id="StackedApp-1018"><a href="#StackedApp-1018"><span class="linenos">1018</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">()</span>
</span><span id="StackedApp-1019"><a href="#StackedApp-1019"><span class="linenos">1019</span></a>                    <span class="n">dialog</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp-1020"><a href="#StackedApp-1020"><span class="linenos">1020</span></a>            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="StackedApp-1021"><a href="#StackedApp-1021"><span class="linenos">1021</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp-1022"><a href="#StackedApp-1022"><span class="linenos">1022</span></a>                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Wasn&#39;t able to open the column choices dialog.&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
</span><span id="StackedApp-1023"><a href="#StackedApp-1023"><span class="linenos">1023</span></a>
</span><span id="StackedApp-1024"><a href="#StackedApp-1024"><span class="linenos">1024</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-1025"><a href="#StackedApp-1025"><span class="linenos">1025</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp-1026"><a href="#StackedApp-1026"><span class="linenos">1026</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Cannot open dialog:&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No table is currently visible.&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp-1027"><a href="#StackedApp-1027"><span class="linenos">1027</span></a>
</span><span id="StackedApp-1028"><a href="#StackedApp-1028"><span class="linenos">1028</span></a>    <span class="k">def</span> <span class="nf">change_icon_colors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp-1029"><a href="#StackedApp-1029"><span class="linenos">1029</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-1030"><a href="#StackedApp-1030"><span class="linenos">1030</span></a><span class="sd">        change_icon_colors cycles through the qtawesome icons used in the app (like the ones used in the main menubar) and changes their color to white or black, depending on the theme that is currently being used.</span>
</span><span id="StackedApp-1031"><a href="#StackedApp-1031"><span class="linenos">1031</span></a>
</span><span id="StackedApp-1032"><a href="#StackedApp-1032"><span class="linenos">1032</span></a><span class="sd">        &lt;b&gt;Themes are divided into dark and light theme groups in the utils.toner_utils initialize_config module&lt;/b&gt;.</span>
</span><span id="StackedApp-1033"><a href="#StackedApp-1033"><span class="linenos">1033</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-1034"><a href="#StackedApp-1034"><span class="linenos">1034</span></a>        <span class="c1"># check the main application window&#39;s background color and see if  its dark or light</span>
</span><span id="StackedApp-1035"><a href="#StackedApp-1035"><span class="linenos">1035</span></a>        <span class="c1"># then  so set icon colors to near white</span>
</span><span id="StackedApp-1036"><a href="#StackedApp-1036"><span class="linenos">1036</span></a>        <span class="c1"># cycle through the main menubar actions and reset their icons</span>
</span><span id="StackedApp-1037"><a href="#StackedApp-1037"><span class="linenos">1037</span></a>        <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
</span><span id="StackedApp-1038"><a href="#StackedApp-1038"><span class="linenos">1038</span></a>            <span class="c1"># for each menu, iterate through its actions</span>
</span><span id="StackedApp-1039"><a href="#StackedApp-1039"><span class="linenos">1039</span></a>            <span class="k">for</span> <span class="n">subaction</span> <span class="ow">in</span> <span class="n">action</span><span class="o">.</span><span class="n">menu</span><span class="p">()</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
</span><span id="StackedApp-1040"><a href="#StackedApp-1040"><span class="linenos">1040</span></a>                <span class="c1"># get the text from the action</span>
</span><span id="StackedApp-1041"><a href="#StackedApp-1041"><span class="linenos">1041</span></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">subaction</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span><span id="StackedApp-1042"><a href="#StackedApp-1042"><span class="linenos">1042</span></a>                <span class="c1"># check if any of the icon string keys are in the text from the action (for example, the key &quot;import&quot; will be in the action text &quot;Import UPC File&quot;)</span>
</span><span id="StackedApp-1043"><a href="#StackedApp-1043"><span class="linenos">1043</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">icon_strings</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="StackedApp-1044"><a href="#StackedApp-1044"><span class="linenos">1044</span></a>                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
</span><span id="StackedApp-1045"><a href="#StackedApp-1045"><span class="linenos">1045</span></a>                        <span class="c1"># check if its a dark or light theme</span>
</span><span id="StackedApp-1046"><a href="#StackedApp-1046"><span class="linenos">1046</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theme</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dark_themes</span><span class="p">:</span>
</span><span id="StackedApp-1047"><a href="#StackedApp-1047"><span class="linenos">1047</span></a>                            <span class="c1"># create qtawesome icon</span>
</span><span id="StackedApp-1048"><a href="#StackedApp-1048"><span class="linenos">1048</span></a>                            <span class="n">icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="StackedApp-1049"><a href="#StackedApp-1049"><span class="linenos">1049</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">icon_strings</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
</span><span id="StackedApp-1050"><a href="#StackedApp-1050"><span class="linenos">1050</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp-1051"><a href="#StackedApp-1051"><span class="linenos">1051</span></a>                            <span class="n">icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="StackedApp-1052"><a href="#StackedApp-1052"><span class="linenos">1052</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">icon_strings</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="StackedApp-1053"><a href="#StackedApp-1053"><span class="linenos">1053</span></a>                        <span class="c1"># set the icon</span>
</span><span id="StackedApp-1054"><a href="#StackedApp-1054"><span class="linenos">1054</span></a>                        <span class="n">subaction</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>
</span><span id="StackedApp-1055"><a href="#StackedApp-1055"><span class="linenos">1055</span></a>
</span><span id="StackedApp-1056"><a href="#StackedApp-1056"><span class="linenos">1056</span></a>    <span class="k">def</span> <span class="nf">reset_database</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp-1057"><a href="#StackedApp-1057"><span class="linenos">1057</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-1058"><a href="#StackedApp-1058"><span class="linenos">1058</span></a><span class="sd">        reset_database resets all stock values in the inventory table to 0 after double-checking with the user.</span>
</span><span id="StackedApp-1059"><a href="#StackedApp-1059"><span class="linenos">1059</span></a>
</span><span id="StackedApp-1060"><a href="#StackedApp-1060"><span class="linenos">1060</span></a><span class="sd">        The app will also perform a silent backup to csv before resetting the database.</span>
</span><span id="StackedApp-1061"><a href="#StackedApp-1061"><span class="linenos">1061</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-1062"><a href="#StackedApp-1062"><span class="linenos">1062</span></a>        <span class="c1"># check if the user is sure they want to reset the database</span>
</span><span id="StackedApp-1063"><a href="#StackedApp-1063"><span class="linenos">1063</span></a>        <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
</span><span id="StackedApp-1064"><a href="#StackedApp-1064"><span class="linenos">1064</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
</span><span id="StackedApp-1065"><a href="#StackedApp-1065"><span class="linenos">1065</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Are you sure you want to reset the database?&quot;</span><span class="p">)</span>
</span><span id="StackedApp-1066"><a href="#StackedApp-1066"><span class="linenos">1066</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Reset Database&quot;</span><span class="p">)</span>
</span><span id="StackedApp-1067"><a href="#StackedApp-1067"><span class="linenos">1067</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>
</span><span id="StackedApp-1068"><a href="#StackedApp-1068"><span class="linenos">1068</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setDefaultButton</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>
</span><span id="StackedApp-1069"><a href="#StackedApp-1069"><span class="linenos">1069</span></a>        <span class="c1"># if the user clicks yes, reset the database</span>
</span><span id="StackedApp-1070"><a href="#StackedApp-1070"><span class="linenos">1070</span></a>        <span class="k">if</span> <span class="n">msg</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
</span><span id="StackedApp-1071"><a href="#StackedApp-1071"><span class="linenos">1071</span></a>
</span><span id="StackedApp-1072"><a href="#StackedApp-1072"><span class="linenos">1072</span></a>            <span class="c1"># update all stock in database to 0 after running backup.</span>
</span><span id="StackedApp-1073"><a href="#StackedApp-1073"><span class="linenos">1073</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">backup_to_csv</span><span class="p">(</span><span class="n">notification</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="StackedApp-1074"><a href="#StackedApp-1074"><span class="linenos">1074</span></a>            <span class="c1"># connect to database</span>
</span><span id="StackedApp-1075"><a href="#StackedApp-1075"><span class="linenos">1075</span></a>            <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="StackedApp-1076"><a href="#StackedApp-1076"><span class="linenos">1076</span></a>                <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="StackedApp-1077"><a href="#StackedApp-1077"><span class="linenos">1077</span></a>                <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="StackedApp-1078"><a href="#StackedApp-1078"><span class="linenos">1078</span></a>                <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="StackedApp-1079"><a href="#StackedApp-1079"><span class="linenos">1079</span></a>                <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="StackedApp-1080"><a href="#StackedApp-1080"><span class="linenos">1080</span></a>                <span class="n">dicttrue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="StackedApp-1081"><a href="#StackedApp-1081"><span class="linenos">1081</span></a>            <span class="p">)</span>
</span><span id="StackedApp-1082"><a href="#StackedApp-1082"><span class="linenos">1082</span></a>            <span class="c1"># had to disable SAFE UPDATES in MySQL database to be able to do this query</span>
</span><span id="StackedApp-1083"><a href="#StackedApp-1083"><span class="linenos">1083</span></a>            <span class="n">update_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET stock = 0 WHERE 1=1&quot;</span>
</span><span id="StackedApp-1084"><a href="#StackedApp-1084"><span class="linenos">1084</span></a>            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">update_query</span><span class="p">)</span>
</span><span id="StackedApp-1085"><a href="#StackedApp-1085"><span class="linenos">1085</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="StackedApp-1086"><a href="#StackedApp-1086"><span class="linenos">1086</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp-1087"><a href="#StackedApp-1087"><span class="linenos">1087</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp-1088"><a href="#StackedApp-1088"><span class="linenos">1088</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Database Reset&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Database has been reset.&quot;</span>
</span><span id="StackedApp-1089"><a href="#StackedApp-1089"><span class="linenos">1089</span></a>            <span class="p">)</span>
</span><span id="StackedApp-1090"><a href="#StackedApp-1090"><span class="linenos">1090</span></a>            <span class="c1"># log the reset</span>
</span><span id="StackedApp-1091"><a href="#StackedApp-1091"><span class="linenos">1091</span></a>            <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;RESET DB&quot;</span><span class="p">,</span>
</span><span id="StackedApp-1092"><a href="#StackedApp-1092"><span class="linenos">1092</span></a>                      <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;Database was reset, all stock values set to 0.&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp-1093"><a href="#StackedApp-1093"><span class="linenos">1093</span></a>
</span><span id="StackedApp-1094"><a href="#StackedApp-1094"><span class="linenos">1094</span></a>    <span class="k">def</span> <span class="nf">check_for_duplicates_popup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp-1095"><a href="#StackedApp-1095"><span class="linenos">1095</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-1096"><a href="#StackedApp-1096"><span class="linenos">1096</span></a><span class="sd">        check_for_duplicates generate popup window that shows a combo box with all table columns in it and an ok button</span>
</span><span id="StackedApp-1097"><a href="#StackedApp-1097"><span class="linenos">1097</span></a>
</span><span id="StackedApp-1098"><a href="#StackedApp-1098"><span class="linenos">1098</span></a><span class="sd">        Oftentimes, items that have duplicate values will be ones that can be linked. For example, two separate toner items that amount to the same part number (same yield value, same color, etc.) but they have different UPCs. By default, the app will separate these items into two different ones, but through the use of this function and &#39;linking the items&#39;, the user can choose to have the two items show up as one.</span>
</span><span id="StackedApp-1099"><a href="#StackedApp-1099"><span class="linenos">1099</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-1100"><a href="#StackedApp-1100"><span class="linenos">1100</span></a>        <span class="c1"># get the column names from the config</span>
</span><span id="StackedApp-1101"><a href="#StackedApp-1101"><span class="linenos">1101</span></a>        <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="StackedApp-1102"><a href="#StackedApp-1102"><span class="linenos">1102</span></a>        <span class="c1"># create a dialog</span>
</span><span id="StackedApp-1103"><a href="#StackedApp-1103"><span class="linenos">1103</span></a>        <span class="n">dialog</span> <span class="o">=</span> <span class="n">QDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp-1104"><a href="#StackedApp-1104"><span class="linenos">1104</span></a>        <span class="n">dialog</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Check for Duplicates&quot;</span><span class="p">)</span>
</span><span id="StackedApp-1105"><a href="#StackedApp-1105"><span class="linenos">1105</span></a>        <span class="n">dialog</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="StackedApp-1106"><a href="#StackedApp-1106"><span class="linenos">1106</span></a>        <span class="c1"># create a layout</span>
</span><span id="StackedApp-1107"><a href="#StackedApp-1107"><span class="linenos">1107</span></a>        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
</span><span id="StackedApp-1108"><a href="#StackedApp-1108"><span class="linenos">1108</span></a>        <span class="c1"># create a combo box</span>
</span><span id="StackedApp-1109"><a href="#StackedApp-1109"><span class="linenos">1109</span></a>        <span class="n">combo_box</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
</span><span id="StackedApp-1110"><a href="#StackedApp-1110"><span class="linenos">1110</span></a>        <span class="n">combo_box</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span>
</span><span id="StackedApp-1111"><a href="#StackedApp-1111"><span class="linenos">1111</span></a>        <span class="c1"># create a button</span>
</span><span id="StackedApp-1112"><a href="#StackedApp-1112"><span class="linenos">1112</span></a>        <span class="n">button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="n">dialog</span><span class="p">)</span>
</span><span id="StackedApp-1113"><a href="#StackedApp-1113"><span class="linenos">1113</span></a>        <span class="c1"># add the combo box and button to the layout</span>
</span><span id="StackedApp-1114"><a href="#StackedApp-1114"><span class="linenos">1114</span></a>        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">combo_box</span><span class="p">)</span>
</span><span id="StackedApp-1115"><a href="#StackedApp-1115"><span class="linenos">1115</span></a>        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>
</span><span id="StackedApp-1116"><a href="#StackedApp-1116"><span class="linenos">1116</span></a>        <span class="c1"># set the layout</span>
</span><span id="StackedApp-1117"><a href="#StackedApp-1117"><span class="linenos">1117</span></a>        <span class="n">dialog</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
</span><span id="StackedApp-1118"><a href="#StackedApp-1118"><span class="linenos">1118</span></a>        <span class="c1"># connect the button to a function</span>
</span><span id="StackedApp-1119"><a href="#StackedApp-1119"><span class="linenos">1119</span></a>        <span class="n">button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp-1120"><a href="#StackedApp-1120"><span class="linenos">1120</span></a>            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_for_duplicates_action</span><span class="p">(</span><span class="n">combo_box</span><span class="p">,</span> <span class="n">dialog</span><span class="p">))</span>
</span><span id="StackedApp-1121"><a href="#StackedApp-1121"><span class="linenos">1121</span></a>        <span class="c1"># show the dialog</span>
</span><span id="StackedApp-1122"><a href="#StackedApp-1122"><span class="linenos">1122</span></a>        <span class="n">dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp-1123"><a href="#StackedApp-1123"><span class="linenos">1123</span></a>
</span><span id="StackedApp-1124"><a href="#StackedApp-1124"><span class="linenos">1124</span></a>    <span class="k">def</span> <span class="nf">check_for_duplicates_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combo_box</span><span class="p">,</span> <span class="n">dialog</span><span class="p">):</span>
</span><span id="StackedApp-1125"><a href="#StackedApp-1125"><span class="linenos">1125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp-1126"><a href="#StackedApp-1126"><span class="linenos">1126</span></a><span class="sd">        check_for_duplicates_action the action of checking for duplicates.</span>
</span><span id="StackedApp-1127"><a href="#StackedApp-1127"><span class="linenos">1127</span></a>
</span><span id="StackedApp-1128"><a href="#StackedApp-1128"><span class="linenos">1128</span></a><span class="sd">        &lt;b&gt;Read description of check_for_duplicates_popup for more information.&lt;/b&gt;</span>
</span><span id="StackedApp-1129"><a href="#StackedApp-1129"><span class="linenos">1129</span></a>
</span><span id="StackedApp-1130"><a href="#StackedApp-1130"><span class="linenos">1130</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp-1131"><a href="#StackedApp-1131"><span class="linenos">1131</span></a><span class="sd">            combo_box (QComboBox): necessary so that the function can get the text from the combo box (the column that will be searched for duplicates)</span>
</span><span id="StackedApp-1132"><a href="#StackedApp-1132"><span class="linenos">1132</span></a><span class="sd">            dialog (QDialog): so the app can close the QDialog.</span>
</span><span id="StackedApp-1133"><a href="#StackedApp-1133"><span class="linenos">1133</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp-1134"><a href="#StackedApp-1134"><span class="linenos">1134</span></a>        <span class="c1"># get text from combobox</span>
</span><span id="StackedApp-1135"><a href="#StackedApp-1135"><span class="linenos">1135</span></a>        <span class="n">column_name</span> <span class="o">=</span> <span class="n">combo_box</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
</span><span id="StackedApp-1136"><a href="#StackedApp-1136"><span class="linenos">1136</span></a>        <span class="c1"># close the dialog</span>
</span><span id="StackedApp-1137"><a href="#StackedApp-1137"><span class="linenos">1137</span></a>        <span class="n">dialog</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp-1138"><a href="#StackedApp-1138"><span class="linenos">1138</span></a>        <span class="c1"># get query ready for table</span>
</span><span id="StackedApp-1139"><a href="#StackedApp-1139"><span class="linenos">1139</span></a>        <span class="n">column_str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
</span><span id="StackedApp-1140"><a href="#StackedApp-1140"><span class="linenos">1140</span></a>
</span><span id="StackedApp-1141"><a href="#StackedApp-1141"><span class="linenos">1141</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT </span><span class="si">{</span><span class="n">column_str</span><span class="si">}</span><span class="s2"> FROM </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> WHERE </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> IN (SELECT </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> FROM </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> GROUP BY </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> HAVING COUNT(*) &gt; 1)&quot;</span>
</span><span id="StackedApp-1142"><a href="#StackedApp-1142"><span class="linenos">1142</span></a>        <span class="c1"># display table with the data</span>
</span><span id="StackedApp-1143"><a href="#StackedApp-1143"><span class="linenos">1143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_table_page</span><span class="p">(</span><span class="n">table_query</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>QWidget(parent: typing.Optional[QWidget] = None, flags: Union[Qt.WindowFlags, Qt.WindowType] = Qt.WindowFlags())</p>
</div>


                            <div id="StackedApp.__init__" class="classattr">
                                        <input id="StackedApp.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">StackedApp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">parent</span><span class="p">:</span> <span class="n">PyQt5</span><span class="o">.</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMainWindow</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="StackedApp.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.__init__-39"><a href="#StackedApp.__init__-39"><span class="linenos"> 39</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span><span class="n">QMainWindow</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="StackedApp.__init__-40"><a href="#StackedApp.__init__-40"><span class="linenos"> 40</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.__init__-41"><a href="#StackedApp.__init__-41"><span class="linenos"> 41</span></a><span class="sd">        __init__ This is the main QWidget used by the app GUI. The QMainWindow is just a shell that holds this widget, because QMainWindows come with the main menubars built-in and made building the GUI easier.</span>
</span><span id="StackedApp.__init__-42"><a href="#StackedApp.__init__-42"><span class="linenos"> 42</span></a>
</span><span id="StackedApp.__init__-43"><a href="#StackedApp.__init__-43"><span class="linenos"> 43</span></a><span class="sd">        The main widget inside of this class, is saved in the &#39;stack&#39; property, which is a QStackedWidget. This widget is used to switch between the three main pages of the app: home, table, and dashboard using the statement: self.stack.setCurrentIndex(index).</span>
</span><span id="StackedApp.__init__-44"><a href="#StackedApp.__init__-44"><span class="linenos"> 44</span></a>
</span><span id="StackedApp.__init__-45"><a href="#StackedApp.__init__-45"><span class="linenos"> 45</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp.__init__-46"><a href="#StackedApp.__init__-46"><span class="linenos"> 46</span></a><span class="sd">            parent (QMainWindow, optional): _description_. Defaults to None.</span>
</span><span id="StackedApp.__init__-47"><a href="#StackedApp.__init__-47"><span class="linenos"> 47</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.__init__-48"><a href="#StackedApp.__init__-48"><span class="linenos"> 48</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">StackedApp</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</span><span id="StackedApp.__init__-49"><a href="#StackedApp.__init__-49"><span class="linenos"> 49</span></a>        <span class="n">initialize_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.__init__-50"><a href="#StackedApp.__init__-50"><span class="linenos"> 50</span></a>        <span class="c1"># this dictionary is to change the menubar icon colors, based on whether the user has a light or dark theme set:</span>
</span><span id="StackedApp.__init__-51"><a href="#StackedApp.__init__-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">icon_strings</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StackedApp.__init__-52"><a href="#StackedApp.__init__-52"><span class="linenos"> 52</span></a>            <span class="s2">&quot;search&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;fa5s.search&quot;</span><span class="p">],</span>
</span><span id="StackedApp.__init__-53"><a href="#StackedApp.__init__-53"><span class="linenos"> 53</span></a>            <span class="s2">&quot;reset&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi6.database-refresh&quot;</span><span class="p">],</span>
</span><span id="StackedApp.__init__-54"><a href="#StackedApp.__init__-54"><span class="linenos"> 54</span></a>            <span class="s2">&quot;import&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi.import&quot;</span><span class="p">],</span>
</span><span id="StackedApp.__init__-55"><a href="#StackedApp.__init__-55"><span class="linenos"> 55</span></a>            <span class="s2">&quot;home&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi.home&quot;</span><span class="p">],</span>
</span><span id="StackedApp.__init__-56"><a href="#StackedApp.__init__-56"><span class="linenos"> 56</span></a>            <span class="s2">&quot;insert&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi.plus-box-outline&quot;</span><span class="p">],</span>
</span><span id="StackedApp.__init__-57"><a href="#StackedApp.__init__-57"><span class="linenos"> 57</span></a>            <span class="s2">&quot;edit&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi6.database-edit-outline&quot;</span><span class="p">],</span>
</span><span id="StackedApp.__init__-58"><a href="#StackedApp.__init__-58"><span class="linenos"> 58</span></a>            <span class="s2">&quot;theme&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi6.monitor-eye&quot;</span><span class="p">],</span>
</span><span id="StackedApp.__init__-59"><a href="#StackedApp.__init__-59"><span class="linenos"> 59</span></a>            <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ri.insert-column-left&quot;</span><span class="p">],</span>
</span><span id="StackedApp.__init__-60"><a href="#StackedApp.__init__-60"><span class="linenos"> 60</span></a>            <span class="s2">&quot;settings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi6.cog&quot;</span><span class="p">],</span>
</span><span id="StackedApp.__init__-61"><a href="#StackedApp.__init__-61"><span class="linenos"> 61</span></a>            <span class="s2">&quot;about&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mdi.information-outline&quot;</span><span class="p">]</span>
</span><span id="StackedApp.__init__-62"><a href="#StackedApp.__init__-62"><span class="linenos"> 62</span></a>        <span class="p">}</span>
</span><span id="StackedApp.__init__-63"><a href="#StackedApp.__init__-63"><span class="linenos"> 63</span></a>        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.__init__-64"><a href="#StackedApp.__init__-64"><span class="linenos"> 64</span></a>        <span class="c1"># create the three QWidgets</span>
</span><span id="StackedApp.__init__-65"><a href="#StackedApp.__init__-65"><span class="linenos"> 65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_page</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.__init__-66"><a href="#StackedApp.__init__-66"><span class="linenos"> 66</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_page</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.__init__-67"><a href="#StackedApp.__init__-67"><span class="linenos"> 67</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_page</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.__init__-68"><a href="#StackedApp.__init__-68"><span class="linenos"> 68</span></a>
</span><span id="StackedApp.__init__-69"><a href="#StackedApp.__init__-69"><span class="linenos"> 69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tray_icon</span><span class="p">,</span> <span class="n">tray_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_tray</span><span class="p">()</span>
</span><span id="StackedApp.__init__-70"><a href="#StackedApp.__init__-70"><span class="linenos"> 70</span></a>
</span><span id="StackedApp.__init__-71"><a href="#StackedApp.__init__-71"><span class="linenos"> 71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span> <span class="o">=</span> <span class="n">QStackedWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.__init__-72"><a href="#StackedApp.__init__-72"><span class="linenos"> 72</span></a>
</span><span id="StackedApp.__init__-73"><a href="#StackedApp.__init__-73"><span class="linenos"> 73</span></a>        <span class="c1"># set each qwidgets layout to be the corresponding page</span>
</span><span id="StackedApp.__init__-74"><a href="#StackedApp.__init__-74"><span class="linenos"> 74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span> <span class="o">=</span> <span class="n">HomeLayout</span><span class="p">()</span>
</span><span id="StackedApp.__init__-75"><a href="#StackedApp.__init__-75"><span class="linenos"> 75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_page</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="p">)</span>
</span><span id="StackedApp.__init__-76"><a href="#StackedApp.__init__-76"><span class="linenos"> 76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span> <span class="o">=</span> <span class="n">TableLayout</span><span class="p">()</span>
</span><span id="StackedApp.__init__-77"><a href="#StackedApp.__init__-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">rowclicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_app_item</span><span class="p">)</span>
</span><span id="StackedApp.__init__-78"><a href="#StackedApp.__init__-78"><span class="linenos"> 78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_page</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="p">)</span>
</span><span id="StackedApp.__init__-79"><a href="#StackedApp.__init__-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span> <span class="o">=</span> <span class="n">DashboardLayout</span><span class="p">()</span>
</span><span id="StackedApp.__init__-80"><a href="#StackedApp.__init__-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_page</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="p">)</span>
</span><span id="StackedApp.__init__-81"><a href="#StackedApp.__init__-81"><span class="linenos"> 81</span></a>
</span><span id="StackedApp.__init__-82"><a href="#StackedApp.__init__-82"><span class="linenos"> 82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">home_page</span><span class="p">)</span>
</span><span id="StackedApp.__init__-83"><a href="#StackedApp.__init__-83"><span class="linenos"> 83</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_page</span><span class="p">)</span>
</span><span id="StackedApp.__init__-84"><a href="#StackedApp.__init__-84"><span class="linenos"> 84</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dashboard_page</span><span class="p">)</span>
</span><span id="StackedApp.__init__-85"><a href="#StackedApp.__init__-85"><span class="linenos"> 85</span></a>
</span><span id="StackedApp.__init__-86"><a href="#StackedApp.__init__-86"><span class="linenos"> 86</span></a>        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span>
</span><span id="StackedApp.__init__-87"><a href="#StackedApp.__init__-87"><span class="linenos"> 87</span></a>
</span><span id="StackedApp.__init__-88"><a href="#StackedApp.__init__-88"><span class="linenos"> 88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="StackedApp.__init__-89"><a href="#StackedApp.__init__-89"><span class="linenos"> 89</span></a>
</span><span id="StackedApp.__init__-90"><a href="#StackedApp.__init__-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
</span><span id="StackedApp.__init__-91"><a href="#StackedApp.__init__-91"><span class="linenos"> 91</span></a>
</span><span id="StackedApp.__init__-92"><a href="#StackedApp.__init__-92"><span class="linenos"> 92</span></a>        <span class="c1"># set up qcompleters for the textbox on home window</span>
</span><span id="StackedApp.__init__-93"><a href="#StackedApp.__init__-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">printer_models_qcompleter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">codes_qcompleter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_qcompleters</span><span class="p">()</span>
</span><span id="StackedApp.__init__-94"><a href="#StackedApp.__init__-94"><span class="linenos"> 94</span></a>        <span class="c1"># TODO: attach either the printer models or item codes q completer based on user selection (will have to add buttons next to the QlineEdit on the home page or something similar)</span>
</span><span id="StackedApp.__init__-95"><a href="#StackedApp.__init__-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">setCompleter</span><span class="p">(</span>
</span><span id="StackedApp.__init__-96"><a href="#StackedApp.__init__-96"><span class="linenos"> 96</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">printer_models_qcompleter</span><span class="p">)</span>
</span><span id="StackedApp.__init__-97"><a href="#StackedApp.__init__-97"><span class="linenos"> 97</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">setCompleter</span><span class="p">(</span>
</span><span id="StackedApp.__init__-98"><a href="#StackedApp.__init__-98"><span class="linenos"> 98</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">printer_models_qcompleter</span><span class="p">)</span>
</span><span id="StackedApp.__init__-99"><a href="#StackedApp.__init__-99"><span class="linenos"> 99</span></a>        <span class="c1"># connections</span>
</span><span id="StackedApp.__init__-100"><a href="#StackedApp.__init__-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">completer</span><span class="p">()</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp.__init__-101"><a href="#StackedApp.__init__-101"><span class="linenos">101</span></a>            <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_dashboard_page</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;home&quot;</span><span class="p">))</span>
</span><span id="StackedApp.__init__-102"><a href="#StackedApp.__init__-102"><span class="linenos">102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">search_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp.__init__-103"><a href="#StackedApp.__init__-103"><span class="linenos">103</span></a>            <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_dashboard_page</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;home&quot;</span><span class="p">))</span>
</span><span id="StackedApp.__init__-104"><a href="#StackedApp.__init__-104"><span class="linenos">104</span></a>
</span><span id="StackedApp.__init__-105"><a href="#StackedApp.__init__-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">search_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp.__init__-106"><a href="#StackedApp.__init__-106"><span class="linenos">106</span></a>            <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_dashboard_page</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;dashboard&quot;</span><span class="p">))</span>
</span><span id="StackedApp.__init__-107"><a href="#StackedApp.__init__-107"><span class="linenos">107</span></a>
</span><span id="StackedApp.__init__-108"><a href="#StackedApp.__init__-108"><span class="linenos">108</span></a>        <span class="c1"># connect the search bar button to search function</span>
</span><span id="StackedApp.__init__-109"><a href="#StackedApp.__init__-109"><span class="linenos">109</span></a>        <span class="c1"># if enter is pressed</span>
</span><span id="StackedApp.__init__-110"><a href="#StackedApp.__init__-110"><span class="linenos">110</span></a>        <span class="c1"># self.table_layout.search_bar.completer().activated.connect(</span>
</span><span id="StackedApp.__init__-111"><a href="#StackedApp.__init__-111"><span class="linenos">111</span></a>        <span class="c1">#     lambda: self.show_dashboard_page(window=&quot;home&quot;))</span>
</span><span id="StackedApp.__init__-112"><a href="#StackedApp.__init__-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">search_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp.__init__-113"><a href="#StackedApp.__init__-113"><span class="linenos">113</span></a>            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_db_mode</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;table&quot;</span><span class="p">))</span>
</span><span id="StackedApp.__init__-114"><a href="#StackedApp.__init__-114"><span class="linenos">114</span></a>
</span><span id="StackedApp.__init__-115"><a href="#StackedApp.__init__-115"><span class="linenos">115</span></a>        <span class="c1"># connect main buttons on home layout</span>
</span><span id="StackedApp.__init__-116"><a href="#StackedApp.__init__-116"><span class="linenos">116</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">button</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StackedApp.__init__-117"><a href="#StackedApp.__init__-117"><span class="linenos">117</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="StackedApp.__init__-118"><a href="#StackedApp.__init__-118"><span class="linenos">118</span></a>                <span class="n">button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp.__init__-119"><a href="#StackedApp.__init__-119"><span class="linenos">119</span></a>                    <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_table_page</span><span class="p">,</span> <span class="n">manufacturer</span><span class="o">=</span><span class="n">k</span><span class="p">))</span>
</span><span id="StackedApp.__init__-120"><a href="#StackedApp.__init__-120"><span class="linenos">120</span></a>        <span class="c1"># -- SET the THEME --</span>
</span><span id="StackedApp.__init__-121"><a href="#StackedApp.__init__-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">theme</span><span class="p">)</span>
</span><span id="StackedApp.__init__-122"><a href="#StackedApp.__init__-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_layout_assigned</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="StackedApp.__init__-123"><a href="#StackedApp.__init__-123"><span class="linenos">123</span></a>        <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;APP START&quot;</span><span class="p">,</span>
</span><span id="StackedApp.__init__-124"><a href="#StackedApp.__init__-124"><span class="linenos">124</span></a>                  <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;Application started&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp.__init__-125"><a href="#StackedApp.__init__-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Application started&quot;</span><span class="p">,</span>
</span><span id="StackedApp.__init__-126"><a href="#StackedApp.__init__-126"><span class="linenos">126</span></a>                              <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Printer Supply App started&quot;</span><span class="p">)</span>
</span><span id="StackedApp.__init__-127"><a href="#StackedApp.__init__-127"><span class="linenos">127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>__init__ This is the main QWidget used by the app GUI. The QMainWindow is just a shell that holds this widget, because QMainWindows come with the main menubars built-in and made building the GUI easier.</p>

<p>The main widget inside of this class, is saved in the 'stack' property, which is a QStackedWidget. This widget is used to switch between the three main pages of the app: home, table, and dashboard using the statement: self.stack.setCurrentIndex(index).</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>parent (QMainWindow, optional):</strong>  _description_. Defaults to None.</li>
</ul>
</div>


                            </div>
                            <div id="StackedApp.fill_columns" class="classattr">
                                        <input id="StackedApp.fill_columns-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fill_columns</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.fill_columns-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.fill_columns"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.fill_columns-129"><a href="#StackedApp.fill_columns-129"><span class="linenos">129</span></a>    <span class="k">def</span> <span class="nf">fill_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp.fill_columns-130"><a href="#StackedApp.fill_columns-130"><span class="linenos">130</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.fill_columns-131"><a href="#StackedApp.fill_columns-131"><span class="linenos">131</span></a><span class="sd">        fill_columns run the fillout_columns.py utility in the utils folder. This file (the DBHousekeeping class) will try to fill in any empty or invalid values held by items for columns including brand, type, color, and possibly more.</span>
</span><span id="StackedApp.fill_columns-132"><a href="#StackedApp.fill_columns-132"><span class="linenos">132</span></a>
</span><span id="StackedApp.fill_columns-133"><a href="#StackedApp.fill_columns-133"><span class="linenos">133</span></a><span class="sd">        fillout_columns.py can also be used independent of the application.</span>
</span><span id="StackedApp.fill_columns-134"><a href="#StackedApp.fill_columns-134"><span class="linenos">134</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.fill_columns-135"><a href="#StackedApp.fill_columns-135"><span class="linenos">135</span></a>        <span class="n">DBHousekeeping</span><span class="p">()</span>
</span><span id="StackedApp.fill_columns-136"><a href="#StackedApp.fill_columns-136"><span class="linenos">136</span></a>        <span class="c1"># messagebox popup saying columns have been filled in as much as possible</span>
</span><span id="StackedApp.fill_columns-137"><a href="#StackedApp.fill_columns-137"><span class="linenos">137</span></a>        <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
</span><span id="StackedApp.fill_columns-138"><a href="#StackedApp.fill_columns-138"><span class="linenos">138</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp.fill_columns-139"><a href="#StackedApp.fill_columns-139"><span class="linenos">139</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columns have been filled in as much as possible.&quot;</span><span class="p">)</span>
</span><span id="StackedApp.fill_columns-140"><a href="#StackedApp.fill_columns-140"><span class="linenos">140</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Columns Filled&quot;</span><span class="p">)</span>
</span><span id="StackedApp.fill_columns-141"><a href="#StackedApp.fill_columns-141"><span class="linenos">141</span></a>        <span class="n">ok_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">)</span>
</span><span id="StackedApp.fill_columns-142"><a href="#StackedApp.fill_columns-142"><span class="linenos">142</span></a>        <span class="n">ok_button</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">35</span><span class="p">)</span>
</span><span id="StackedApp.fill_columns-143"><a href="#StackedApp.fill_columns-143"><span class="linenos">143</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="n">ok_button</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">AcceptRole</span><span class="p">)</span>
</span><span id="StackedApp.fill_columns-144"><a href="#StackedApp.fill_columns-144"><span class="linenos">144</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>fill_columns run the fillout_columns.py utility in the utils folder. This file (the DBHousekeeping class) will try to fill in any empty or invalid values held by items for columns including brand, type, color, and possibly more.</p>

<p>fillout_columns.py can also be used independent of the application.</p>
</div>


                            </div>
                            <div id="StackedApp.show_home_page" class="classattr">
                                        <input id="StackedApp.show_home_page-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">show_home_page</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.show_home_page-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.show_home_page"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.show_home_page-146"><a href="#StackedApp.show_home_page-146"><span class="linenos">146</span></a>    <span class="k">def</span> <span class="nf">show_home_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp.show_home_page-147"><a href="#StackedApp.show_home_page-147"><span class="linenos">147</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.show_home_page-148"><a href="#StackedApp.show_home_page-148"><span class="linenos">148</span></a><span class="sd">        show_home_page shows the main window of the application.</span>
</span><span id="StackedApp.show_home_page-149"><a href="#StackedApp.show_home_page-149"><span class="linenos">149</span></a>
</span><span id="StackedApp.show_home_page-150"><a href="#StackedApp.show_home_page-150"><span class="linenos">150</span></a><span class="sd">        Displays the campus (set in config) above a QLineEdit (textbox) where the user can search by printer model. Four buttons are stacked beneath the textbox which lead to the app&#39;s spreadsheet view.</span>
</span><span id="StackedApp.show_home_page-151"><a href="#StackedApp.show_home_page-151"><span class="linenos">151</span></a>
</span><span id="StackedApp.show_home_page-152"><a href="#StackedApp.show_home_page-152"><span class="linenos">152</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.show_home_page-153"><a href="#StackedApp.show_home_page-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>show_home_page shows the main window of the application.</p>

<p>Displays the campus (set in config) above a QLineEdit (textbox) where the user can search by printer model. Four buttons are stacked beneath the textbox which lead to the app's spreadsheet view.</p>
</div>


                            </div>
                            <div id="StackedApp.show_table_page" class="classattr">
                                        <input id="StackedApp.show_table_page-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">show_table_page</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">manufacturer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">table_query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.show_table_page-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.show_table_page"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.show_table_page-155"><a href="#StackedApp.show_table_page-155"><span class="linenos">155</span></a>    <span class="k">def</span> <span class="nf">show_table_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">manufacturer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">table_query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="StackedApp.show_table_page-156"><a href="#StackedApp.show_table_page-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.show_table_page-157"><a href="#StackedApp.show_table_page-157"><span class="linenos">157</span></a><span class="sd">        show_table_page displays the spreadsheet view of the stacked widget, index 1. The home page/view is index 0, and the dashboard view is index 2.</span>
</span><span id="StackedApp.show_table_page-158"><a href="#StackedApp.show_table_page-158"><span class="linenos">158</span></a>
</span><span id="StackedApp.show_table_page-159"><a href="#StackedApp.show_table_page-159"><span class="linenos">159</span></a><span class="sd">        Using a QStackedWidget allows to easily change between the app&#39;s 3 different windows, and change the actual data that the windows use to display information as well.</span>
</span><span id="StackedApp.show_table_page-160"><a href="#StackedApp.show_table_page-160"><span class="linenos">160</span></a>
</span><span id="StackedApp.show_table_page-161"><a href="#StackedApp.show_table_page-161"><span class="linenos">161</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp.show_table_page-162"><a href="#StackedApp.show_table_page-162"><span class="linenos">162</span></a><span class="sd">            manufacturer (str, optional): manufacturer of items being shown. &lt;b&gt;If this argument is supplied, it means one of the home page&#39;s buttons is being clicked, or one of the View options in menubar&lt;/b&gt;. Defaults to None.</span>
</span><span id="StackedApp.show_table_page-163"><a href="#StackedApp.show_table_page-163"><span class="linenos">163</span></a><span class="sd">            table_query (str, optional): query that the app will use to populate the table with items. Defaults to None.</span>
</span><span id="StackedApp.show_table_page-164"><a href="#StackedApp.show_table_page-164"><span class="linenos">164</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.show_table_page-165"><a href="#StackedApp.show_table_page-165"><span class="linenos">165</span></a>        <span class="n">column_str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
</span><span id="StackedApp.show_table_page-166"><a href="#StackedApp.show_table_page-166"><span class="linenos">166</span></a>
</span><span id="StackedApp.show_table_page-167"><a href="#StackedApp.show_table_page-167"><span class="linenos">167</span></a>        <span class="c1"># if the manufacturer argument is supplied, it means either the main page buttons or the View &gt; Spreadsheet buttons are being clicked</span>
</span><span id="StackedApp.show_table_page-168"><a href="#StackedApp.show_table_page-168"><span class="linenos">168</span></a>        <span class="c1"># --------------------------------------------------------------------------------------------------------------------------------------</span>
</span><span id="StackedApp.show_table_page-169"><a href="#StackedApp.show_table_page-169"><span class="linenos">169</span></a>        <span class="k">if</span> <span class="n">manufacturer</span> <span class="ow">and</span> <span class="p">(</span><span class="n">manufacturer</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;others&quot;</span><span class="p">):</span>
</span><span id="StackedApp.show_table_page-170"><a href="#StackedApp.show_table_page-170"><span class="linenos">170</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">(</span>
</span><span id="StackedApp.show_table_page-171"><a href="#StackedApp.show_table_page-171"><span class="linenos">171</span></a>                <span class="n">query</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;SELECT </span><span class="si">{</span><span class="n">column_str</span><span class="si">}</span><span class="s2"> FROM inventory WHERE brand=&#39;</span><span class="si">{</span><span class="n">manufacturer</span><span class="si">}</span><span class="s2">&#39;;&quot;</span><span class="p">)</span>
</span><span id="StackedApp.show_table_page-172"><a href="#StackedApp.show_table_page-172"><span class="linenos">172</span></a>            <span class="k">if</span> <span class="n">manufacturer</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;hp&quot;</span><span class="p">:</span>
</span><span id="StackedApp.show_table_page-173"><a href="#StackedApp.show_table_page-173"><span class="linenos">173</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
</span><span id="StackedApp.show_table_page-174"><a href="#StackedApp.show_table_page-174"><span class="linenos">174</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">manufacturer</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> Inventory&quot;</span><span class="p">)</span>
</span><span id="StackedApp.show_table_page-175"><a href="#StackedApp.show_table_page-175"><span class="linenos">175</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.show_table_page-176"><a href="#StackedApp.show_table_page-176"><span class="linenos">176</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
</span><span id="StackedApp.show_table_page-177"><a href="#StackedApp.show_table_page-177"><span class="linenos">177</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">manufacturer</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> Inventory&quot;</span><span class="p">)</span>
</span><span id="StackedApp.show_table_page-178"><a href="#StackedApp.show_table_page-178"><span class="linenos">178</span></a>        <span class="k">elif</span> <span class="n">manufacturer</span> <span class="ow">and</span> <span class="p">(</span><span class="n">manufacturer</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;others&quot;</span><span class="p">):</span>
</span><span id="StackedApp.show_table_page-179"><a href="#StackedApp.show_table_page-179"><span class="linenos">179</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">(</span>
</span><span id="StackedApp.show_table_page-180"><a href="#StackedApp.show_table_page-180"><span class="linenos">180</span></a>                <span class="n">query</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;SELECT </span><span class="si">{</span><span class="n">column_str</span><span class="si">}</span><span class="s2"> FROM inventory WHERE LOWER(brand) NOT IN (&#39;hp&#39;, &#39;lexmark&#39;, &#39;dell&#39;)&quot;</span><span class="p">)</span>
</span><span id="StackedApp.show_table_page-181"><a href="#StackedApp.show_table_page-181"><span class="linenos">181</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
</span><span id="StackedApp.show_table_page-182"><a href="#StackedApp.show_table_page-182"><span class="linenos">182</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">manufacturer</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> Inventory&quot;</span><span class="p">)</span>
</span><span id="StackedApp.show_table_page-183"><a href="#StackedApp.show_table_page-183"><span class="linenos">183</span></a>
</span><span id="StackedApp.show_table_page-184"><a href="#StackedApp.show_table_page-184"><span class="linenos">184</span></a>        <span class="c1"># if the manufacturer argument is not supplied, but query is, use that to grab the table data</span>
</span><span id="StackedApp.show_table_page-185"><a href="#StackedApp.show_table_page-185"><span class="linenos">185</span></a>        <span class="k">elif</span> <span class="n">table_query</span><span class="p">:</span>
</span><span id="StackedApp.show_table_page-186"><a href="#StackedApp.show_table_page-186"><span class="linenos">186</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">table_query</span><span class="p">)</span>
</span><span id="StackedApp.show_table_page-187"><a href="#StackedApp.show_table_page-187"><span class="linenos">187</span></a>            <span class="c1"># TODO: come up with better looking title than whats below</span>
</span><span id="StackedApp.show_table_page-188"><a href="#StackedApp.show_table_page-188"><span class="linenos">188</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Results: </span><span class="si">{</span><span class="n">table_query</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="StackedApp.show_table_page-189"><a href="#StackedApp.show_table_page-189"><span class="linenos">189</span></a>        <span class="c1"># --------------------------------------------------------------------------------------------------------------------------------------</span>
</span><span id="StackedApp.show_table_page-190"><a href="#StackedApp.show_table_page-190"><span class="linenos">190</span></a>
</span><span id="StackedApp.show_table_page-191"><a href="#StackedApp.show_table_page-191"><span class="linenos">191</span></a>        <span class="c1"># set stacked widget to show the table view</span>
</span><span id="StackedApp.show_table_page-192"><a href="#StackedApp.show_table_page-192"><span class="linenos">192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="StackedApp.show_table_page-193"><a href="#StackedApp.show_table_page-193"><span class="linenos">193</span></a>
</span><span id="StackedApp.show_table_page-194"><a href="#StackedApp.show_table_page-194"><span class="linenos">194</span></a>        <span class="c1"># THE IF STATEMENT BELOW IS NECESSARY BECAUSE - without it, the table will make the doubleclicked connection to edit_app_item multiple times (every time the table page is reloaded)</span>
</span><span id="StackedApp.show_table_page-195"><a href="#StackedApp.show_table_page-195"><span class="linenos">195</span></a>        <span class="c1"># edit item dialog will popup more and more times</span>
</span><span id="StackedApp.show_table_page-196"><a href="#StackedApp.show_table_page-196"><span class="linenos">196</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_layout_assigned</span><span class="p">:</span>
</span><span id="StackedApp.show_table_page-197"><a href="#StackedApp.show_table_page-197"><span class="linenos">197</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">doubleClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_app_item</span><span class="p">)</span>
</span><span id="StackedApp.show_table_page-198"><a href="#StackedApp.show_table_page-198"><span class="linenos">198</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout_assigned</span> <span class="o">=</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>show_table_page displays the spreadsheet view of the stacked widget, index 1. The home page/view is index 0, and the dashboard view is index 2.</p>

<p>Using a QStackedWidget allows to easily change between the app's 3 different windows, and change the actual data that the windows use to display information as well.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>manufacturer (str, optional):</strong>  manufacturer of items being shown. <b>If this argument is supplied, it means one of the home page's buttons is being clicked, or one of the View options in menubar</b>. Defaults to None.</li>
<li><strong>table_query (str, optional):</strong>  query that the app will use to populate the table with items. Defaults to None.</li>
</ul>
</div>


                            </div>
                            <div id="StackedApp.show_dashboard_page" class="classattr">
                                        <input id="StackedApp.show_dashboard_page-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">show_dashboard_page</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">window</span><span class="o">=</span><span class="s1">&#39;home&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.show_dashboard_page-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.show_dashboard_page"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.show_dashboard_page-200"><a href="#StackedApp.show_dashboard_page-200"><span class="linenos">200</span></a>    <span class="k">def</span> <span class="nf">show_dashboard_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;home&quot;</span><span class="p">):</span>
</span><span id="StackedApp.show_dashboard_page-201"><a href="#StackedApp.show_dashboard_page-201"><span class="linenos">201</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.show_dashboard_page-202"><a href="#StackedApp.show_dashboard_page-202"><span class="linenos">202</span></a><span class="sd">        show_dashboard_page displays the second index of the QStackedWidget that the application uses - the dashboard view.</span>
</span><span id="StackedApp.show_dashboard_page-203"><a href="#StackedApp.show_dashboard_page-203"><span class="linenos">203</span></a>
</span><span id="StackedApp.show_dashboard_page-204"><a href="#StackedApp.show_dashboard_page-204"><span class="linenos">204</span></a><span class="sd">        A printer model&#39;s &quot;dashboard&quot; will show all of the items held in inventory that are compatible with that printer model. It&#39;s a quick way to see if you have enough resources for a particular model, providing the compatible printers column of the inventory table has been filled out correctly.</span>
</span><span id="StackedApp.show_dashboard_page-205"><a href="#StackedApp.show_dashboard_page-205"><span class="linenos">205</span></a>
</span><span id="StackedApp.show_dashboard_page-206"><a href="#StackedApp.show_dashboard_page-206"><span class="linenos">206</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp.show_dashboard_page-207"><a href="#StackedApp.show_dashboard_page-207"><span class="linenos">207</span></a><span class="sd">            window (str, optional): the window that the app is leaving to come into the dashboard view. Defaults to &quot;home&quot;.</span>
</span><span id="StackedApp.show_dashboard_page-208"><a href="#StackedApp.show_dashboard_page-208"><span class="linenos">208</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.show_dashboard_page-209"><a href="#StackedApp.show_dashboard_page-209"><span class="linenos">209</span></a>        <span class="c1"># get the current text from the home layout search bar</span>
</span><span id="StackedApp.show_dashboard_page-210"><a href="#StackedApp.show_dashboard_page-210"><span class="linenos">210</span></a>        <span class="k">if</span> <span class="n">window</span> <span class="o">==</span> <span class="s2">&quot;home&quot;</span><span class="p">:</span>
</span><span id="StackedApp.show_dashboard_page-211"><a href="#StackedApp.show_dashboard_page-211"><span class="linenos">211</span></a>            <span class="n">home_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span><span id="StackedApp.show_dashboard_page-212"><a href="#StackedApp.show_dashboard_page-212"><span class="linenos">212</span></a>            <span class="n">printer_model</span> <span class="o">=</span> <span class="n">home_model</span>
</span><span id="StackedApp.show_dashboard_page-213"><a href="#StackedApp.show_dashboard_page-213"><span class="linenos">213</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.show_dashboard_page-214"><a href="#StackedApp.show_dashboard_page-214"><span class="linenos">214</span></a>            <span class="n">dash_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span><span id="StackedApp.show_dashboard_page-215"><a href="#StackedApp.show_dashboard_page-215"><span class="linenos">215</span></a>            <span class="n">printer_model</span> <span class="o">=</span> <span class="n">dash_model</span>
</span><span id="StackedApp.show_dashboard_page-216"><a href="#StackedApp.show_dashboard_page-216"><span class="linenos">216</span></a>        <span class="c1"># check if printer model is in the qcompleter list - if it&#39;s not, it won&#39;t be a valid printer model from printers column in database</span>
</span><span id="StackedApp.show_dashboard_page-217"><a href="#StackedApp.show_dashboard_page-217"><span class="linenos">217</span></a>        <span class="k">if</span> <span class="n">printer_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">printer_models_qcompleter</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">stringList</span><span class="p">():</span>
</span><span id="StackedApp.show_dashboard_page-218"><a href="#StackedApp.show_dashboard_page-218"><span class="linenos">218</span></a>            <span class="k">if</span> <span class="n">printer_model</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;hp&quot;</span><span class="p">):</span>
</span><span id="StackedApp.show_dashboard_page-219"><a href="#StackedApp.show_dashboard_page-219"><span class="linenos">219</span></a>                <span class="n">model_name</span> <span class="o">=</span> <span class="n">printer_model</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
</span><span id="StackedApp.show_dashboard_page-220"><a href="#StackedApp.show_dashboard_page-220"><span class="linenos">220</span></a>            <span class="k">elif</span> <span class="n">printer_model</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;dell&quot;</span><span class="p">):</span>
</span><span id="StackedApp.show_dashboard_page-221"><a href="#StackedApp.show_dashboard_page-221"><span class="linenos">221</span></a>                <span class="n">model_name</span> <span class="o">=</span> <span class="n">printer_model</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>
</span><span id="StackedApp.show_dashboard_page-222"><a href="#StackedApp.show_dashboard_page-222"><span class="linenos">222</span></a>            <span class="k">elif</span> <span class="n">printer_model</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;lexmark&quot;</span><span class="p">):</span>
</span><span id="StackedApp.show_dashboard_page-223"><a href="#StackedApp.show_dashboard_page-223"><span class="linenos">223</span></a>                <span class="n">model_name</span> <span class="o">=</span> <span class="n">printer_model</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
</span><span id="StackedApp.show_dashboard_page-224"><a href="#StackedApp.show_dashboard_page-224"><span class="linenos">224</span></a>            <span class="k">elif</span> <span class="n">printer_model</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;brother&quot;</span><span class="p">):</span>
</span><span id="StackedApp.show_dashboard_page-225"><a href="#StackedApp.show_dashboard_page-225"><span class="linenos">225</span></a>                <span class="n">model_name</span> <span class="o">=</span> <span class="n">printer_model</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
</span><span id="StackedApp.show_dashboard_page-226"><a href="#StackedApp.show_dashboard_page-226"><span class="linenos">226</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.show_dashboard_page-227"><a href="#StackedApp.show_dashboard_page-227"><span class="linenos">227</span></a>                <span class="n">model_name</span> <span class="o">=</span> <span class="n">printer_model</span>
</span><span id="StackedApp.show_dashboard_page-228"><a href="#StackedApp.show_dashboard_page-228"><span class="linenos">228</span></a>            <span class="c1"># set title of dashboard padge</span>
</span><span id="StackedApp.show_dashboard_page-229"><a href="#StackedApp.show_dashboard_page-229"><span class="linenos">229</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">set_model_title</span><span class="p">(</span><span class="n">printer_model</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
</span><span id="StackedApp.show_dashboard_page-230"><a href="#StackedApp.show_dashboard_page-230"><span class="linenos">230</span></a>
</span><span id="StackedApp.show_dashboard_page-231"><a href="#StackedApp.show_dashboard_page-231"><span class="linenos">231</span></a>            <span class="c1"># construct the query</span>
</span><span id="StackedApp.show_dashboard_page-232"><a href="#StackedApp.show_dashboard_page-232"><span class="linenos">232</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM inventory WHERE FIND_IN_SET(</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, LOWER(printers))&quot;</span>
</span><span id="StackedApp.show_dashboard_page-233"><a href="#StackedApp.show_dashboard_page-233"><span class="linenos">233</span></a>            <span class="c1"># query the database</span>
</span><span id="StackedApp.show_dashboard_page-234"><a href="#StackedApp.show_dashboard_page-234"><span class="linenos">234</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_database</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="StackedApp.show_dashboard_page-235"><a href="#StackedApp.show_dashboard_page-235"><span class="linenos">235</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="StackedApp.show_dashboard_page-236"><a href="#StackedApp.show_dashboard_page-236"><span class="linenos">236</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">populate_dashboard</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span><span id="StackedApp.show_dashboard_page-237"><a href="#StackedApp.show_dashboard_page-237"><span class="linenos">237</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>show_dashboard_page displays the second index of the QStackedWidget that the application uses - the dashboard view.</p>

<p>A printer model's "dashboard" will show all of the items held in inventory that are compatible with that printer model. It's a quick way to see if you have enough resources for a particular model, providing the compatible printers column of the inventory table has been filled out correctly.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>window (str, optional):</strong>  the window that the app is leaving to come into the dashboard view. Defaults to "home".</li>
</ul>
</div>


                            </div>
                            <div id="StackedApp.populate_dashboard" class="classattr">
                                        <input id="StackedApp.populate_dashboard-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">populate_dashboard</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">results</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.populate_dashboard-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.populate_dashboard"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.populate_dashboard-239"><a href="#StackedApp.populate_dashboard-239"><span class="linenos">239</span></a>    <span class="k">def</span> <span class="nf">populate_dashboard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
</span><span id="StackedApp.populate_dashboard-240"><a href="#StackedApp.populate_dashboard-240"><span class="linenos">240</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.populate_dashboard-241"><a href="#StackedApp.populate_dashboard-241"><span class="linenos">241</span></a><span class="sd">        populate_dashboard function to populate the app&#39;s dashboard view with widgets. Toner and ink items have the colored radials as their widgets.</span>
</span><span id="StackedApp.populate_dashboard-242"><a href="#StackedApp.populate_dashboard-242"><span class="linenos">242</span></a>
</span><span id="StackedApp.populate_dashboard-243"><a href="#StackedApp.populate_dashboard-243"><span class="linenos">243</span></a><span class="sd">        As of 5/6/23, other items like fusers, drums, waste containers, all use the same stock dashboard widget. &lt;b&gt;It&#39;d be great to get some help coming up with ideas for widgets for these item types!&lt;/b&gt;</span>
</span><span id="StackedApp.populate_dashboard-244"><a href="#StackedApp.populate_dashboard-244"><span class="linenos">244</span></a>
</span><span id="StackedApp.populate_dashboard-245"><a href="#StackedApp.populate_dashboard-245"><span class="linenos">245</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp.populate_dashboard-246"><a href="#StackedApp.populate_dashboard-246"><span class="linenos">246</span></a><span class="sd">            results (list): a list of item dictionaries that the app will use to populate the dashboard with item widgets.</span>
</span><span id="StackedApp.populate_dashboard-247"><a href="#StackedApp.populate_dashboard-247"><span class="linenos">247</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.populate_dashboard-248"><a href="#StackedApp.populate_dashboard-248"><span class="linenos">248</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">count</span><span class="p">())):</span>
</span><span id="StackedApp.populate_dashboard-249"><a href="#StackedApp.populate_dashboard-249"><span class="linenos">249</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span><span id="StackedApp.populate_dashboard-250"><a href="#StackedApp.populate_dashboard-250"><span class="linenos">250</span></a>        <span class="n">toner_radials</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StackedApp.populate_dashboard-251"><a href="#StackedApp.populate_dashboard-251"><span class="linenos">251</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;radial_widgets&quot;</span><span class="p">):</span>
</span><span id="StackedApp.populate_dashboard-252"><a href="#StackedApp.populate_dashboard-252"><span class="linenos">252</span></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">radial_widgets</span><span class="p">:</span>
</span><span id="StackedApp.populate_dashboard-253"><a href="#StackedApp.populate_dashboard-253"><span class="linenos">253</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">radial_widgets</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span><span id="StackedApp.populate_dashboard-254"><a href="#StackedApp.populate_dashboard-254"><span class="linenos">254</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">radial_widgets</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StackedApp.populate_dashboard-255"><a href="#StackedApp.populate_dashboard-255"><span class="linenos">255</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="StackedApp.populate_dashboard-256"><a href="#StackedApp.populate_dashboard-256"><span class="linenos">256</span></a>        <span class="n">x2</span><span class="o">=</span><span class="mi">0</span>
</span><span id="StackedApp.populate_dashboard-257"><a href="#StackedApp.populate_dashboard-257"><span class="linenos">257</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="StackedApp.populate_dashboard-258"><a href="#StackedApp.populate_dashboard-258"><span class="linenos">258</span></a>        <span class="n">y2</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="StackedApp.populate_dashboard-259"><a href="#StackedApp.populate_dashboard-259"><span class="linenos">259</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="StackedApp.populate_dashboard-260"><a href="#StackedApp.populate_dashboard-260"><span class="linenos">260</span></a>            <span class="c1"># if its toner or ink, create a circular progress bar (radial)</span>
</span><span id="StackedApp.populate_dashboard-261"><a href="#StackedApp.populate_dashboard-261"><span class="linenos">261</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;toner&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ink&quot;</span><span class="p">):</span>
</span><span id="StackedApp.populate_dashboard-262"><a href="#StackedApp.populate_dashboard-262"><span class="linenos">262</span></a>                <span class="c1"># this creates the frame that holds the radial / labels for a toner object</span>
</span><span id="StackedApp.populate_dashboard-263"><a href="#StackedApp.populate_dashboard-263"><span class="linenos">263</span></a>                <span class="n">toner_radials</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">RadialFrame</span><span class="p">(</span>
</span><span id="StackedApp.populate_dashboard-264"><a href="#StackedApp.populate_dashboard-264"><span class="linenos">264</span></a>                    <span class="n">item</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">())</span>
</span><span id="StackedApp.populate_dashboard-265"><a href="#StackedApp.populate_dashboard-265"><span class="linenos">265</span></a>                <span class="c1"># connect the radials signal to edit function</span>
</span><span id="StackedApp.populate_dashboard-266"><a href="#StackedApp.populate_dashboard-266"><span class="linenos">266</span></a>                <span class="n">toner_radials</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">userClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp.populate_dashboard-267"><a href="#StackedApp.populate_dashboard-267"><span class="linenos">267</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">edit_app_item</span><span class="p">)</span>
</span><span id="StackedApp.populate_dashboard-268"><a href="#StackedApp.populate_dashboard-268"><span class="linenos">268</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span>
</span><span id="StackedApp.populate_dashboard-269"><a href="#StackedApp.populate_dashboard-269"><span class="linenos">269</span></a>                    <span class="n">toner_radials</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]],</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="StackedApp.populate_dashboard-270"><a href="#StackedApp.populate_dashboard-270"><span class="linenos">270</span></a>                <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="StackedApp.populate_dashboard-271"><a href="#StackedApp.populate_dashboard-271"><span class="linenos">271</span></a>                <span class="c1"># this (along with lines in elif statement) will try to separate the toner/ink radials from the other item widgets on the dashboard</span>
</span><span id="StackedApp.populate_dashboard-272"><a href="#StackedApp.populate_dashboard-272"><span class="linenos">272</span></a>                <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="StackedApp.populate_dashboard-273"><a href="#StackedApp.populate_dashboard-273"><span class="linenos">273</span></a>                    <span class="n">y</span> <span class="o">+=</span> <span class="mi">2</span>
</span><span id="StackedApp.populate_dashboard-274"><a href="#StackedApp.populate_dashboard-274"><span class="linenos">274</span></a>                    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="StackedApp.populate_dashboard-275"><a href="#StackedApp.populate_dashboard-275"><span class="linenos">275</span></a>            <span class="k">elif</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="StackedApp.populate_dashboard-276"><a href="#StackedApp.populate_dashboard-276"><span class="linenos">276</span></a>                <span class="s2">&quot;drum&quot;</span><span class="p">,</span>
</span><span id="StackedApp.populate_dashboard-277"><a href="#StackedApp.populate_dashboard-277"><span class="linenos">277</span></a>                <span class="s2">&quot;fuser&quot;</span><span class="p">,</span>
</span><span id="StackedApp.populate_dashboard-278"><a href="#StackedApp.populate_dashboard-278"><span class="linenos">278</span></a>                <span class="s2">&quot;transfer&quot;</span><span class="p">,</span>
</span><span id="StackedApp.populate_dashboard-279"><a href="#StackedApp.populate_dashboard-279"><span class="linenos">279</span></a>                <span class="s2">&quot;waste&quot;</span><span class="p">,</span>
</span><span id="StackedApp.populate_dashboard-280"><a href="#StackedApp.populate_dashboard-280"><span class="linenos">280</span></a>                <span class="s2">&quot;developer&quot;</span><span class="p">,</span>
</span><span id="StackedApp.populate_dashboard-281"><a href="#StackedApp.populate_dashboard-281"><span class="linenos">281</span></a>                <span class="s2">&quot;cleaner&quot;</span><span class="p">,</span>
</span><span id="StackedApp.populate_dashboard-282"><a href="#StackedApp.populate_dashboard-282"><span class="linenos">282</span></a>                <span class="s2">&quot;roller&quot;</span><span class="p">,</span>
</span><span id="StackedApp.populate_dashboard-283"><a href="#StackedApp.populate_dashboard-283"><span class="linenos">283</span></a>                <span class="s2">&quot;toner&quot;</span><span class="p">,</span>
</span><span id="StackedApp.populate_dashboard-284"><a href="#StackedApp.populate_dashboard-284"><span class="linenos">284</span></a>                <span class="s2">&quot;paper&quot;</span><span class="p">,</span>
</span><span id="StackedApp.populate_dashboard-285"><a href="#StackedApp.populate_dashboard-285"><span class="linenos">285</span></a>            <span class="p">]:</span>
</span><span id="StackedApp.populate_dashboard-286"><a href="#StackedApp.populate_dashboard-286"><span class="linenos">286</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;aframe&quot;</span><span class="p">)</span>
</span><span id="StackedApp.populate_dashboard-287"><a href="#StackedApp.populate_dashboard-287"><span class="linenos">287</span></a>                <span class="n">aframe</span> <span class="o">=</span> <span class="n">ItemFrame</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">())</span>
</span><span id="StackedApp.populate_dashboard-288"><a href="#StackedApp.populate_dashboard-288"><span class="linenos">288</span></a>                <span class="c1"># aframe.userClicked.connect(self.edit_item)</span>
</span><span id="StackedApp.populate_dashboard-289"><a href="#StackedApp.populate_dashboard-289"><span class="linenos">289</span></a>                <span class="n">aframe</span><span class="o">.</span><span class="n">userClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_app_item</span><span class="p">)</span>
</span><span id="StackedApp.populate_dashboard-290"><a href="#StackedApp.populate_dashboard-290"><span class="linenos">290</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_layout</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">aframe</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
</span><span id="StackedApp.populate_dashboard-291"><a href="#StackedApp.populate_dashboard-291"><span class="linenos">291</span></a>                <span class="n">x2</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="StackedApp.populate_dashboard-292"><a href="#StackedApp.populate_dashboard-292"><span class="linenos">292</span></a>                <span class="k">if</span> <span class="n">x2</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="StackedApp.populate_dashboard-293"><a href="#StackedApp.populate_dashboard-293"><span class="linenos">293</span></a>                    <span class="n">y2</span> <span class="o">+=</span> <span class="mi">2</span>
</span><span id="StackedApp.populate_dashboard-294"><a href="#StackedApp.populate_dashboard-294"><span class="linenos">294</span></a>                    <span class="n">x2</span> <span class="o">=</span> <span class="mi">0</span>
</span></pre></div>


            <div class="docstring"><p>populate_dashboard function to populate the app's dashboard view with widgets. Toner and ink items have the colored radials as their widgets.</p>

<p>As of 5/6/23, other items like fusers, drums, waste containers, all use the same stock dashboard widget. <b>It'd be great to get some help coming up with ideas for widgets for these item types!</b></p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>results (list):</strong>  a list of item dictionaries that the app will use to populate the dashboard with item widgets.</li>
</ul>
</div>


                            </div>
                            <div id="StackedApp.open_help_dialog" class="classattr">
                                        <input id="StackedApp.open_help_dialog-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">open_help_dialog</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.open_help_dialog-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.open_help_dialog"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.open_help_dialog-301"><a href="#StackedApp.open_help_dialog-301"><span class="linenos">301</span></a>    <span class="k">def</span> <span class="nf">open_help_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp.open_help_dialog-302"><a href="#StackedApp.open_help_dialog-302"><span class="linenos">302</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;open_help_dialog Function opens the help dialog window&quot;&quot;&quot;</span>
</span><span id="StackedApp.open_help_dialog-303"><a href="#StackedApp.open_help_dialog-303"><span class="linenos">303</span></a>        <span class="n">help_dialog</span> <span class="o">=</span> <span class="n">HelpPopup</span><span class="p">()</span>
</span><span id="StackedApp.open_help_dialog-304"><a href="#StackedApp.open_help_dialog-304"><span class="linenos">304</span></a>        <span class="n">help_dialog</span><span class="o">.</span><span class="n">docs_clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp.open_help_dialog-305"><a href="#StackedApp.open_help_dialog-305"><span class="linenos">305</span></a>            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_in_browser</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">docs_file</span><span class="p">))</span>
</span><span id="StackedApp.open_help_dialog-306"><a href="#StackedApp.open_help_dialog-306"><span class="linenos">306</span></a>        <span class="n">help_dialog</span><span class="o">.</span><span class="n">app_guide_clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp.open_help_dialog-307"><a href="#StackedApp.open_help_dialog-307"><span class="linenos">307</span></a>            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_in_browser</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">guide_file</span><span class="p">))</span>
</span><span id="StackedApp.open_help_dialog-308"><a href="#StackedApp.open_help_dialog-308"><span class="linenos">308</span></a>        <span class="n">help_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>open_help_dialog Function opens the help dialog window</p>
</div>


                            </div>
                            <div id="StackedApp.open_search_dialog" class="classattr">
                                        <input id="StackedApp.open_search_dialog-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">open_search_dialog</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.open_search_dialog-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.open_search_dialog"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.open_search_dialog-310"><a href="#StackedApp.open_search_dialog-310"><span class="linenos">310</span></a>    <span class="k">def</span> <span class="nf">open_search_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp.open_search_dialog-311"><a href="#StackedApp.open_search_dialog-311"><span class="linenos">311</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.open_search_dialog-312"><a href="#StackedApp.open_search_dialog-312"><span class="linenos">312</span></a><span class="sd">        open_search_dialog opens the popup dialog that has a QComboBox, QLineEdit, and QPushButton, so the user can choose a column and enter a search term to display items that fit those criteria.</span>
</span><span id="StackedApp.open_search_dialog-313"><a href="#StackedApp.open_search_dialog-313"><span class="linenos">313</span></a>
</span><span id="StackedApp.open_search_dialog-314"><a href="#StackedApp.open_search_dialog-314"><span class="linenos">314</span></a><span class="sd">        The search dialog is displayed by clicking the search option on either the main menubar or the app&#39;s secondary toolbar.</span>
</span><span id="StackedApp.open_search_dialog-315"><a href="#StackedApp.open_search_dialog-315"><span class="linenos">315</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.open_search_dialog-316"><a href="#StackedApp.open_search_dialog-316"><span class="linenos">316</span></a>        <span class="c1"># show the search dialog</span>
</span><span id="StackedApp.open_search_dialog-317"><a href="#StackedApp.open_search_dialog-317"><span class="linenos">317</span></a>        <span class="n">search_dialog</span> <span class="o">=</span> <span class="n">SearchColumnsPopup</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.open_search_dialog-318"><a href="#StackedApp.open_search_dialog-318"><span class="linenos">318</span></a>        <span class="n">search_dialog</span><span class="o">.</span><span class="n">dataEntered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_db_mode</span><span class="p">)</span>
</span><span id="StackedApp.open_search_dialog-319"><a href="#StackedApp.open_search_dialog-319"><span class="linenos">319</span></a>
</span><span id="StackedApp.open_search_dialog-320"><a href="#StackedApp.open_search_dialog-320"><span class="linenos">320</span></a>        <span class="n">search_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>open_search_dialog opens the popup dialog that has a QComboBox, QLineEdit, and QPushButton, so the user can choose a column and enter a search term to display items that fit those criteria.</p>

<p>The search dialog is displayed by clicking the search option on either the main menubar or the app's secondary toolbar.</p>
</div>


                            </div>
                            <div id="StackedApp.open_settings_dialog" class="classattr">
                                        <input id="StackedApp.open_settings_dialog-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">open_settings_dialog</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.open_settings_dialog-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.open_settings_dialog"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.open_settings_dialog-322"><a href="#StackedApp.open_settings_dialog-322"><span class="linenos">322</span></a>    <span class="k">def</span> <span class="nf">open_settings_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp.open_settings_dialog-323"><a href="#StackedApp.open_settings_dialog-323"><span class="linenos">323</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;open_settings_dialog Function opens the settings dialog window&quot;&quot;&quot;</span>
</span><span id="StackedApp.open_settings_dialog-324"><a href="#StackedApp.open_settings_dialog-324"><span class="linenos">324</span></a>        <span class="n">settings_dialog</span> <span class="o">=</span> <span class="n">SettingsPopup</span><span class="p">()</span>
</span><span id="StackedApp.open_settings_dialog-325"><a href="#StackedApp.open_settings_dialog-325"><span class="linenos">325</span></a>        <span class="c1"># if the settings dialog returns accepted() signal</span>
</span><span id="StackedApp.open_settings_dialog-326"><a href="#StackedApp.open_settings_dialog-326"><span class="linenos">326</span></a>        <span class="k">if</span> <span class="n">settings_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">():</span>
</span><span id="StackedApp.open_settings_dialog-327"><a href="#StackedApp.open_settings_dialog-327"><span class="linenos">327</span></a>            <span class="c1"># the setting that you really notice right away when it doesn&#39;t take effect, is the theme</span>
</span><span id="StackedApp.open_settings_dialog-328"><a href="#StackedApp.open_settings_dialog-328"><span class="linenos">328</span></a>            <span class="c1"># so we just run set_theme after initializing the config</span>
</span><span id="StackedApp.open_settings_dialog-329"><a href="#StackedApp.open_settings_dialog-329"><span class="linenos">329</span></a>            <span class="n">initialize_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.open_settings_dialog-330"><a href="#StackedApp.open_settings_dialog-330"><span class="linenos">330</span></a>            <span class="n">initialize_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">())</span>
</span><span id="StackedApp.open_settings_dialog-331"><a href="#StackedApp.open_settings_dialog-331"><span class="linenos">331</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theme</span><span class="p">)</span>
</span><span id="StackedApp.open_settings_dialog-332"><a href="#StackedApp.open_settings_dialog-332"><span class="linenos">332</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_home_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">campus</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>open_settings_dialog Function opens the settings dialog window</p>
</div>


                            </div>
                            <div id="StackedApp.set_home_title" class="classattr">
                                        <input id="StackedApp.set_home_title-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_home_title</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">campus</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.set_home_title-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.set_home_title"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.set_home_title-334"><a href="#StackedApp.set_home_title-334"><span class="linenos">334</span></a>    <span class="k">def</span> <span class="nf">set_home_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">campus</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="StackedApp.set_home_title-335"><a href="#StackedApp.set_home_title-335"><span class="linenos">335</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;set_home_title Function sets the title of the home page&quot;&quot;&quot;</span>
</span><span id="StackedApp.set_home_title-336"><a href="#StackedApp.set_home_title-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">home_layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
</span><span id="StackedApp.set_home_title-337"><a href="#StackedApp.set_home_title-337"><span class="linenos">337</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">campus</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> Printer Inventory&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>set_home_title Function sets the title of the home page</p>
</div>


                            </div>
                            <div id="StackedApp.open_in_browser" class="classattr">
                                        <input id="StackedApp.open_in_browser-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">open_in_browser</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filepath</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.open_in_browser-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.open_in_browser"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.open_in_browser-339"><a href="#StackedApp.open_in_browser-339"><span class="linenos">339</span></a>    <span class="k">def</span> <span class="nf">open_in_browser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>
</span><span id="StackedApp.open_in_browser-340"><a href="#StackedApp.open_in_browser-340"><span class="linenos">340</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;open_in_browser Function opens the filepath in the default browser&quot;&quot;&quot;</span>
</span><span id="StackedApp.open_in_browser-341"><a href="#StackedApp.open_in_browser-341"><span class="linenos">341</span></a>        <span class="c1"># Convert the file path to a QUrl object</span>
</span><span id="StackedApp.open_in_browser-342"><a href="#StackedApp.open_in_browser-342"><span class="linenos">342</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
</span><span id="StackedApp.open_in_browser-343"><a href="#StackedApp.open_in_browser-343"><span class="linenos">343</span></a>        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open_new_tab</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>open_in_browser Function opens the filepath in the default browser</p>
</div>


                            </div>
                            <div id="StackedApp.open_theme_dialog" class="classattr">
                                        <input id="StackedApp.open_theme_dialog-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">open_theme_dialog</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.open_theme_dialog-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.open_theme_dialog"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.open_theme_dialog-348"><a href="#StackedApp.open_theme_dialog-348"><span class="linenos">348</span></a>    <span class="k">def</span> <span class="nf">open_theme_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp.open_theme_dialog-349"><a href="#StackedApp.open_theme_dialog-349"><span class="linenos">349</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;open_theme_dialog Function opens the theme dialog window&quot;&quot;&quot;</span>
</span><span id="StackedApp.open_theme_dialog-350"><a href="#StackedApp.open_theme_dialog-350"><span class="linenos">350</span></a>        <span class="n">theme_dialog</span> <span class="o">=</span> <span class="n">ThemePopup</span><span class="p">()</span>
</span><span id="StackedApp.open_theme_dialog-351"><a href="#StackedApp.open_theme_dialog-351"><span class="linenos">351</span></a>        <span class="n">theme_dialog</span><span class="o">.</span><span class="n">themeSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_theme</span><span class="p">)</span>
</span><span id="StackedApp.open_theme_dialog-352"><a href="#StackedApp.open_theme_dialog-352"><span class="linenos">352</span></a>        <span class="n">theme_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp.open_theme_dialog-353"><a href="#StackedApp.open_theme_dialog-353"><span class="linenos">353</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;set_theme Function sets the theme of the application based on the config file&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>open_theme_dialog Function opens the theme dialog window</p>
</div>


                            </div>
                            <div id="StackedApp.set_theme" class="classattr">
                                        <input id="StackedApp.set_theme-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_theme</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">theme</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.set_theme-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.set_theme"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.set_theme-355"><a href="#StackedApp.set_theme-355"><span class="linenos">355</span></a>    <span class="k">def</span> <span class="nf">set_theme</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theme</span><span class="p">):</span>
</span><span id="StackedApp.set_theme-356"><a href="#StackedApp.set_theme-356"><span class="linenos">356</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.set_theme-357"><a href="#StackedApp.set_theme-357"><span class="linenos">357</span></a><span class="sd">        set_theme sets the QSS stylesheet and theme of the app based on the configuration file, or the user&#39;s choices in one of the settings popups.</span>
</span><span id="StackedApp.set_theme-358"><a href="#StackedApp.set_theme-358"><span class="linenos">358</span></a>
</span><span id="StackedApp.set_theme-359"><a href="#StackedApp.set_theme-359"><span class="linenos">359</span></a><span class="sd">        _extended_summary_</span>
</span><span id="StackedApp.set_theme-360"><a href="#StackedApp.set_theme-360"><span class="linenos">360</span></a>
</span><span id="StackedApp.set_theme-361"><a href="#StackedApp.set_theme-361"><span class="linenos">361</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp.set_theme-362"><a href="#StackedApp.set_theme-362"><span class="linenos">362</span></a><span class="sd">            theme (str): a filename of a QSS stylesheet, without the .qss file extension.</span>
</span><span id="StackedApp.set_theme-363"><a href="#StackedApp.set_theme-363"><span class="linenos">363</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.set_theme-364"><a href="#StackedApp.set_theme-364"><span class="linenos">364</span></a>        <span class="c1"># make sure the user chose a theme:</span>
</span><span id="StackedApp.set_theme-365"><a href="#StackedApp.set_theme-365"><span class="linenos">365</span></a>        <span class="k">if</span> <span class="n">theme</span> <span class="o">==</span> <span class="s2">&quot;Select a theme&quot;</span><span class="p">:</span>
</span><span id="StackedApp.set_theme-366"><a href="#StackedApp.set_theme-366"><span class="linenos">366</span></a>            <span class="k">return</span>
</span><span id="StackedApp.set_theme-367"><a href="#StackedApp.set_theme-367"><span class="linenos">367</span></a>        <span class="c1"># set current app config theme to be the new theme</span>
</span><span id="StackedApp.set_theme-368"><a href="#StackedApp.set_theme-368"><span class="linenos">368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">theme</span> <span class="o">=</span> <span class="n">theme</span>
</span><span id="StackedApp.set_theme-369"><a href="#StackedApp.set_theme-369"><span class="linenos">369</span></a>        <span class="c1"># load the new theme stylesheet and apply to app</span>
</span><span id="StackedApp.set_theme-370"><a href="#StackedApp.set_theme-370"><span class="linenos">370</span></a>        <span class="c1"># try this - unless file isn&#39;t found, then load elegantdark</span>
</span><span id="StackedApp.set_theme-371"><a href="#StackedApp.set_theme-371"><span class="linenos">371</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="StackedApp.set_theme-372"><a href="#StackedApp.set_theme-372"><span class="linenos">372</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;themes/</span><span class="si">{</span><span class="n">theme</span><span class="si">}</span><span class="s2">.qss&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="StackedApp.set_theme-373"><a href="#StackedApp.set_theme-373"><span class="linenos">373</span></a>                <span class="n">app</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="StackedApp.set_theme-374"><a href="#StackedApp.set_theme-374"><span class="linenos">374</span></a>
</span><span id="StackedApp.set_theme-375"><a href="#StackedApp.set_theme-375"><span class="linenos">375</span></a>        <span class="c1"># if somethings wrong and the specified theme file isn&#39;t found, load elegantdark (hopefully no one deletes this one?)</span>
</span><span id="StackedApp.set_theme-376"><a href="#StackedApp.set_theme-376"><span class="linenos">376</span></a>        <span class="c1"># TODO: fallback to blank style / no file?</span>
</span><span id="StackedApp.set_theme-377"><a href="#StackedApp.set_theme-377"><span class="linenos">377</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="StackedApp.set_theme-378"><a href="#StackedApp.set_theme-378"><span class="linenos">378</span></a>            <span class="n">theme</span> <span class="o">=</span> <span class="s2">&quot;ElegantDark&quot;</span>
</span><span id="StackedApp.set_theme-379"><a href="#StackedApp.set_theme-379"><span class="linenos">379</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">theme</span> <span class="o">=</span> <span class="n">theme</span>
</span><span id="StackedApp.set_theme-380"><a href="#StackedApp.set_theme-380"><span class="linenos">380</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;themes/</span><span class="si">{</span><span class="n">theme</span><span class="si">}</span><span class="s2">.qss&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="StackedApp.set_theme-381"><a href="#StackedApp.set_theme-381"><span class="linenos">381</span></a>                <span class="n">app</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="StackedApp.set_theme-382"><a href="#StackedApp.set_theme-382"><span class="linenos">382</span></a>
</span><span id="StackedApp.set_theme-383"><a href="#StackedApp.set_theme-383"><span class="linenos">383</span></a>        <span class="c1"># either way,</span>
</span><span id="StackedApp.set_theme-384"><a href="#StackedApp.set_theme-384"><span class="linenos">384</span></a>        <span class="c1"># rewrite the ./config/config.yaml to show the new [app][theme]</span>
</span><span id="StackedApp.set_theme-385"><a href="#StackedApp.set_theme-385"><span class="linenos">385</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./config/config.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="StackedApp.set_theme-386"><a href="#StackedApp.set_theme-386"><span class="linenos">386</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="StackedApp.set_theme-387"><a href="#StackedApp.set_theme-387"><span class="linenos">387</span></a>            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">][</span><span class="s2">&quot;theme&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">theme</span>
</span><span id="StackedApp.set_theme-388"><a href="#StackedApp.set_theme-388"><span class="linenos">388</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./config/config.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="StackedApp.set_theme-389"><a href="#StackedApp.set_theme-389"><span class="linenos">389</span></a>            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="StackedApp.set_theme-390"><a href="#StackedApp.set_theme-390"><span class="linenos">390</span></a>        <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;THEME CHANGE&quot;</span><span class="p">,</span>
</span><span id="StackedApp.set_theme-391"><a href="#StackedApp.set_theme-391"><span class="linenos">391</span></a>                  <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Theme set to </span><span class="si">{</span><span class="n">theme</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp.set_theme-392"><a href="#StackedApp.set_theme-392"><span class="linenos">392</span></a>
</span><span id="StackedApp.set_theme-393"><a href="#StackedApp.set_theme-393"><span class="linenos">393</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">change_icon_colors</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>set_theme sets the QSS stylesheet and theme of the app based on the configuration file, or the user's choices in one of the settings popups.</p>

<p>_extended_summary_</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>theme (str):</strong>  a filename of a QSS stylesheet, without the .qss file extension.</li>
</ul>
</div>


                            </div>
                            <div id="StackedApp.open_scan_dialog" class="classattr">
                                        <input id="StackedApp.open_scan_dialog-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">open_scan_dialog</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.open_scan_dialog-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.open_scan_dialog"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.open_scan_dialog-395"><a href="#StackedApp.open_scan_dialog-395"><span class="linenos">395</span></a>    <span class="k">def</span> <span class="nf">open_scan_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp.open_scan_dialog-396"><a href="#StackedApp.open_scan_dialog-396"><span class="linenos">396</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.open_scan_dialog-397"><a href="#StackedApp.open_scan_dialog-397"><span class="linenos">397</span></a><span class="sd">        open_scan_dialog open the popup that the user can use to scan printer-related item codes into the database.</span>
</span><span id="StackedApp.open_scan_dialog-398"><a href="#StackedApp.open_scan_dialog-398"><span class="linenos">398</span></a>
</span><span id="StackedApp.open_scan_dialog-399"><a href="#StackedApp.open_scan_dialog-399"><span class="linenos">399</span></a><span class="sd">        it has a red and greed &#39;LED&#39; widget that will light up green when its ok to keep scanning, and red when you need to stop. The app will also play a sound when the red LED lights up, and play a relatively pleasant chime sound on a successful scan event.</span>
</span><span id="StackedApp.open_scan_dialog-400"><a href="#StackedApp.open_scan_dialog-400"><span class="linenos">400</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.open_scan_dialog-401"><a href="#StackedApp.open_scan_dialog-401"><span class="linenos">401</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_window</span> <span class="o">=</span> <span class="n">ScanInputWindow</span><span class="p">(</span>
</span><span id="StackedApp.open_scan_dialog-402"><a href="#StackedApp.open_scan_dialog-402"><span class="linenos">402</span></a>            <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">systemtray</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tray_icon</span><span class="p">)</span>
</span><span id="StackedApp.open_scan_dialog-403"><a href="#StackedApp.open_scan_dialog-403"><span class="linenos">403</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># display the input window</span>
</span><span id="StackedApp.open_scan_dialog-404"><a href="#StackedApp.open_scan_dialog-404"><span class="linenos">404</span></a>        <span class="c1"># set focus on the textEdit widget, hopefully place users cursor inside textbox</span>
</span><span id="StackedApp.open_scan_dialog-405"><a href="#StackedApp.open_scan_dialog-405"><span class="linenos">405</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_window</span><span class="o">.</span><span class="n">textEdit</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>open_scan_dialog open the popup that the user can use to scan printer-related item codes into the database.</p>

<p>it has a red and greed 'LED' widget that will light up green when its ok to keep scanning, and red when you need to stop. The app will also play a sound when the red LED lights up, and play a relatively pleasant chime sound on a successful scan event.</p>
</div>


                            </div>
                            <div id="StackedApp.open_column_dialog" class="classattr">
                                        <input id="StackedApp.open_column_dialog-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">open_column_dialog</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.open_column_dialog-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.open_column_dialog"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.open_column_dialog-411"><a href="#StackedApp.open_column_dialog-411"><span class="linenos">411</span></a>    <span class="k">def</span> <span class="nf">open_column_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp.open_column_dialog-412"><a href="#StackedApp.open_column_dialog-412"><span class="linenos">412</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;open_column_dialog Function opens the column dialog window&quot;&quot;&quot;</span>
</span><span id="StackedApp.open_column_dialog-413"><a href="#StackedApp.open_column_dialog-413"><span class="linenos">413</span></a>        <span class="c1"># check to make sure a table is currently being displayed</span>
</span><span id="StackedApp.open_column_dialog-414"><a href="#StackedApp.open_column_dialog-414"><span class="linenos">414</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="StackedApp.open_column_dialog-415"><a href="#StackedApp.open_column_dialog-415"><span class="linenos">415</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp.open_column_dialog-416"><a href="#StackedApp.open_column_dialog-416"><span class="linenos">416</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Table not showing&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Table must be visible to change columns in view.&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp.open_column_dialog-417"><a href="#StackedApp.open_column_dialog-417"><span class="linenos">417</span></a>            <span class="k">return</span>
</span><span id="StackedApp.open_column_dialog-418"><a href="#StackedApp.open_column_dialog-418"><span class="linenos">418</span></a>        <span class="n">column_dialog</span> <span class="o">=</span> <span class="n">ColumnSelection</span><span class="p">()</span>
</span><span id="StackedApp.open_column_dialog-419"><a href="#StackedApp.open_column_dialog-419"><span class="linenos">419</span></a>        <span class="n">column_dialog</span><span class="o">.</span><span class="n">data_ready</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_columns</span><span class="p">)</span>
</span><span id="StackedApp.open_column_dialog-420"><a href="#StackedApp.open_column_dialog-420"><span class="linenos">420</span></a>        <span class="n">column_dialog</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">styleSheet</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>open_column_dialog Function opens the column dialog window</p>
</div>


                            </div>
                            <div id="StackedApp.set_columns" class="classattr">
                                        <input id="StackedApp.set_columns-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_columns</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">selected</span><span class="p">:</span> <span class="nb">list</span>, </span><span class="param"><span class="n">unselected</span><span class="p">:</span> <span class="nb">list</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.set_columns-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.set_columns"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.set_columns-422"><a href="#StackedApp.set_columns-422"><span class="linenos">422</span></a>    <span class="k">def</span> <span class="nf">set_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">unselected</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="StackedApp.set_columns-423"><a href="#StackedApp.set_columns-423"><span class="linenos">423</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.set_columns-424"><a href="#StackedApp.set_columns-424"><span class="linenos">424</span></a><span class="sd">        set_columns sets the columns of the table based on the config file</span>
</span><span id="StackedApp.set_columns-425"><a href="#StackedApp.set_columns-425"><span class="linenos">425</span></a>
</span><span id="StackedApp.set_columns-426"><a href="#StackedApp.set_columns-426"><span class="linenos">426</span></a><span class="sd">        _extended_summary_</span>
</span><span id="StackedApp.set_columns-427"><a href="#StackedApp.set_columns-427"><span class="linenos">427</span></a>
</span><span id="StackedApp.set_columns-428"><a href="#StackedApp.set_columns-428"><span class="linenos">428</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp.set_columns-429"><a href="#StackedApp.set_columns-429"><span class="linenos">429</span></a><span class="sd">            selected (list): list of selected columns (in text / header form, not index)</span>
</span><span id="StackedApp.set_columns-430"><a href="#StackedApp.set_columns-430"><span class="linenos">430</span></a><span class="sd">            unselected (list): list of unselected columns in text</span>
</span><span id="StackedApp.set_columns-431"><a href="#StackedApp.set_columns-431"><span class="linenos">431</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.set_columns-432"><a href="#StackedApp.set_columns-432"><span class="linenos">432</span></a>        <span class="c1"># loop through self.columns.items() and get the selected indices and unused indices</span>
</span><span id="StackedApp.set_columns-433"><a href="#StackedApp.set_columns-433"><span class="linenos">433</span></a>        <span class="n">selected_indices</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StackedApp.set_columns-434"><a href="#StackedApp.set_columns-434"><span class="linenos">434</span></a>        <span class="n">unused_indices</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StackedApp.set_columns-435"><a href="#StackedApp.set_columns-435"><span class="linenos">435</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">col_name_list</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
</span><span id="StackedApp.set_columns-436"><a href="#StackedApp.set_columns-436"><span class="linenos">436</span></a>
</span><span id="StackedApp.set_columns-437"><a href="#StackedApp.set_columns-437"><span class="linenos">437</span></a>            <span class="k">if</span> <span class="n">col_name_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">:</span>
</span><span id="StackedApp.set_columns-438"><a href="#StackedApp.set_columns-438"><span class="linenos">438</span></a>                <span class="n">selected_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="StackedApp.set_columns-439"><a href="#StackedApp.set_columns-439"><span class="linenos">439</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.set_columns-440"><a href="#StackedApp.set_columns-440"><span class="linenos">440</span></a>                <span class="n">unused_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="StackedApp.set_columns-441"><a href="#StackedApp.set_columns-441"><span class="linenos">441</span></a>
</span><span id="StackedApp.set_columns-442"><a href="#StackedApp.set_columns-442"><span class="linenos">442</span></a>        <span class="c1"># open config/config.yaml and set all 4 config variables after converting the lists to comma separated strings</span>
</span><span id="StackedApp.set_columns-443"><a href="#StackedApp.set_columns-443"><span class="linenos">443</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./config/config.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="StackedApp.set_columns-444"><a href="#StackedApp.set_columns-444"><span class="linenos">444</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="StackedApp.set_columns-445"><a href="#StackedApp.set_columns-445"><span class="linenos">445</span></a>            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;preferences&quot;</span><span class="p">][</span><span class="s2">&quot;selectedcolumns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span>
</span><span id="StackedApp.set_columns-446"><a href="#StackedApp.set_columns-446"><span class="linenos">446</span></a>            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;preferences&quot;</span><span class="p">][</span><span class="s2">&quot;selectedindices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StackedApp.set_columns-447"><a href="#StackedApp.set_columns-447"><span class="linenos">447</span></a>                <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">selected_indices</span><span class="p">])</span>
</span><span id="StackedApp.set_columns-448"><a href="#StackedApp.set_columns-448"><span class="linenos">448</span></a>            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;preferences&quot;</span><span class="p">][</span><span class="s2">&quot;unusedcolumns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unselected</span><span class="p">)</span>
</span><span id="StackedApp.set_columns-449"><a href="#StackedApp.set_columns-449"><span class="linenos">449</span></a>            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;preferences&quot;</span><span class="p">][</span><span class="s2">&quot;unusedindices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StackedApp.set_columns-450"><a href="#StackedApp.set_columns-450"><span class="linenos">450</span></a>                <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">unused_indices</span><span class="p">])</span>
</span><span id="StackedApp.set_columns-451"><a href="#StackedApp.set_columns-451"><span class="linenos">451</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./config/config.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="StackedApp.set_columns-452"><a href="#StackedApp.set_columns-452"><span class="linenos">452</span></a>            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="StackedApp.set_columns-453"><a href="#StackedApp.set_columns-453"><span class="linenos">453</span></a>        <span class="c1"># hide/show the correct columns with selected/unused indices</span>
</span><span id="StackedApp.set_columns-454"><a href="#StackedApp.set_columns-454"><span class="linenos">454</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">selected_indices</span><span class="p">:</span>
</span><span id="StackedApp.set_columns-455"><a href="#StackedApp.set_columns-455"><span class="linenos">455</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setColumnHidden</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="StackedApp.set_columns-456"><a href="#StackedApp.set_columns-456"><span class="linenos">456</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">unused_indices</span><span class="p">:</span>
</span><span id="StackedApp.set_columns-457"><a href="#StackedApp.set_columns-457"><span class="linenos">457</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setColumnHidden</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp.set_columns-458"><a href="#StackedApp.set_columns-458"><span class="linenos">458</span></a>        <span class="c1"># reset the table model</span>
</span><span id="StackedApp.set_columns-459"><a href="#StackedApp.set_columns-459"><span class="linenos">459</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>set_columns sets the columns of the table based on the config file</p>

<p>_extended_summary_</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>selected (list):</strong>  list of selected columns (in text / header form, not index)</li>
<li><strong>unselected (list):</strong>  list of unselected columns in text</li>
</ul>
</div>


                            </div>
                            <div id="StackedApp.handle_item_dialog" class="classattr">
                                        <input id="StackedApp.handle_item_dialog-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">handle_item_dialog</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">item</span>, </span><span class="param"><span class="n">operation</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.handle_item_dialog-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.handle_item_dialog"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.handle_item_dialog-461"><a href="#StackedApp.handle_item_dialog-461"><span class="linenos">461</span></a>    <span class="k">def</span> <span class="nf">handle_item_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">operation</span><span class="p">):</span>
</span><span id="StackedApp.handle_item_dialog-462"><a href="#StackedApp.handle_item_dialog-462"><span class="linenos">462</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.handle_item_dialog-463"><a href="#StackedApp.handle_item_dialog-463"><span class="linenos">463</span></a><span class="sd">        handle_item_dialog handles the signals emitted from the item dialog</span>
</span><span id="StackedApp.handle_item_dialog-464"><a href="#StackedApp.handle_item_dialog-464"><span class="linenos">464</span></a>
</span><span id="StackedApp.handle_item_dialog-465"><a href="#StackedApp.handle_item_dialog-465"><span class="linenos">465</span></a><span class="sd">        _extended_summary_</span>
</span><span id="StackedApp.handle_item_dialog-466"><a href="#StackedApp.handle_item_dialog-466"><span class="linenos">466</span></a>
</span><span id="StackedApp.handle_item_dialog-467"><a href="#StackedApp.handle_item_dialog-467"><span class="linenos">467</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp.handle_item_dialog-468"><a href="#StackedApp.handle_item_dialog-468"><span class="linenos">468</span></a><span class="sd">            item (dict): dictionary containing details about an item.</span>
</span><span id="StackedApp.handle_item_dialog-469"><a href="#StackedApp.handle_item_dialog-469"><span class="linenos">469</span></a><span class="sd">            operation (str): string containing the operation to perform on the item. (edit, delete, insert)</span>
</span><span id="StackedApp.handle_item_dialog-470"><a href="#StackedApp.handle_item_dialog-470"><span class="linenos">470</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.handle_item_dialog-471"><a href="#StackedApp.handle_item_dialog-471"><span class="linenos">471</span></a>        <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;edit&quot;</span><span class="p">:</span>
</span><span id="StackedApp.handle_item_dialog-472"><a href="#StackedApp.handle_item_dialog-472"><span class="linenos">472</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edit_db_item</span><span class="p">(</span><span class="n">item</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="StackedApp.handle_item_dialog-473"><a href="#StackedApp.handle_item_dialog-473"><span class="linenos">473</span></a>        <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;delete&quot;</span><span class="p">:</span>
</span><span id="StackedApp.handle_item_dialog-474"><a href="#StackedApp.handle_item_dialog-474"><span class="linenos">474</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">delete_from_db</span><span class="p">(</span><span class="n">input_arg</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="StackedApp.handle_item_dialog-475"><a href="#StackedApp.handle_item_dialog-475"><span class="linenos">475</span></a>        <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s2">&quot;insert&quot;</span><span class="p">:</span>
</span><span id="StackedApp.handle_item_dialog-476"><a href="#StackedApp.handle_item_dialog-476"><span class="linenos">476</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">insert_into_db</span><span class="p">(</span><span class="n">item_dict</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="StackedApp.handle_item_dialog-477"><a href="#StackedApp.handle_item_dialog-477"><span class="linenos">477</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.handle_item_dialog-478"><a href="#StackedApp.handle_item_dialog-478"><span class="linenos">478</span></a>            <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>handle_item_dialog handles the signals emitted from the item dialog</p>

<p>_extended_summary_</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>item (dict):</strong>  dictionary containing details about an item.</li>
<li><strong>operation (str):</strong>  string containing the operation to perform on the item. (edit, delete, insert)</li>
</ul>
</div>


                            </div>
                            <div id="StackedApp.export_to_excel" class="classattr">
                                        <input id="StackedApp.export_to_excel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">export_to_excel</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.export_to_excel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.export_to_excel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.export_to_excel-483"><a href="#StackedApp.export_to_excel-483"><span class="linenos">483</span></a>    <span class="k">def</span> <span class="nf">export_to_excel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp.export_to_excel-484"><a href="#StackedApp.export_to_excel-484"><span class="linenos">484</span></a>
</span><span id="StackedApp.export_to_excel-485"><a href="#StackedApp.export_to_excel-485"><span class="linenos">485</span></a>        <span class="c1"># TODO: Get report type and some other details into the log</span>
</span><span id="StackedApp.export_to_excel-486"><a href="#StackedApp.export_to_excel-486"><span class="linenos">486</span></a>        <span class="n">ReportDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp.export_to_excel-487"><a href="#StackedApp.export_to_excel-487"><span class="linenos">487</span></a>        <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;REPORT CREATED&quot;</span><span class="p">,</span>
</span><span id="StackedApp.export_to_excel-488"><a href="#StackedApp.export_to_excel-488"><span class="linenos">488</span></a>                  <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Report created&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp.export_to_excel-489"><a href="#StackedApp.export_to_excel-489"><span class="linenos">489</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp.export_to_excel-490"><a href="#StackedApp.export_to_excel-490"><span class="linenos">490</span></a>            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Report Created&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Report created successfully&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="StackedApp.import_item_list" class="classattr">
                                        <input id="StackedApp.import_item_list-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">import_item_list</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.import_item_list-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.import_item_list"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.import_item_list-492"><a href="#StackedApp.import_item_list-492"><span class="linenos">492</span></a>    <span class="k">def</span> <span class="nf">import_item_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp.import_item_list-493"><a href="#StackedApp.import_item_list-493"><span class="linenos">493</span></a>
</span><span id="StackedApp.import_item_list-494"><a href="#StackedApp.import_item_list-494"><span class="linenos">494</span></a>        <span class="n">upcfile</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span>
</span><span id="StackedApp.import_item_list-495"><a href="#StackedApp.import_item_list-495"><span class="linenos">495</span></a>            <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Choose file to import&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;Text Files (*.txt)&quot;</span>
</span><span id="StackedApp.import_item_list-496"><a href="#StackedApp.import_item_list-496"><span class="linenos">496</span></a>        <span class="p">)</span>
</span><span id="StackedApp.import_item_list-497"><a href="#StackedApp.import_item_list-497"><span class="linenos">497</span></a>        <span class="n">lookup_fails</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StackedApp.import_item_list-498"><a href="#StackedApp.import_item_list-498"><span class="linenos">498</span></a>        <span class="k">if</span> <span class="n">upcfile</span><span class="p">:</span>
</span><span id="StackedApp.import_item_list-499"><a href="#StackedApp.import_item_list-499"><span class="linenos">499</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">upcfile</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="StackedApp.import_item_list-500"><a href="#StackedApp.import_item_list-500"><span class="linenos">500</span></a>                <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="StackedApp.import_item_list-501"><a href="#StackedApp.import_item_list-501"><span class="linenos">501</span></a>                <span class="c1"># for each code</span>
</span><span id="StackedApp.import_item_list-502"><a href="#StackedApp.import_item_list-502"><span class="linenos">502</span></a>                <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="StackedApp.import_item_list-503"><a href="#StackedApp.import_item_list-503"><span class="linenos">503</span></a>                    <span class="n">lookup_result</span> <span class="o">=</span> <span class="n">ItemLookup</span><span class="p">(</span>
</span><span id="StackedApp.import_item_list-504"><a href="#StackedApp.import_item_list-504"><span class="linenos">504</span></a>                        <span class="n">input_code</span><span class="o">=</span><span class="n">code</span><span class="p">,</span> <span class="n">systemtray</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tray_icon</span>
</span><span id="StackedApp.import_item_list-505"><a href="#StackedApp.import_item_list-505"><span class="linenos">505</span></a>                    <span class="p">)</span>
</span><span id="StackedApp.import_item_list-506"><a href="#StackedApp.import_item_list-506"><span class="linenos">506</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">lookup_result</span><span class="o">.</span><span class="n">look_up_code</span><span class="p">():</span>
</span><span id="StackedApp.import_item_list-507"><a href="#StackedApp.import_item_list-507"><span class="linenos">507</span></a>                        <span class="n">lookup_fails</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span><span id="StackedApp.import_item_list-508"><a href="#StackedApp.import_item_list-508"><span class="linenos">508</span></a>
</span><span id="StackedApp.import_item_list-509"><a href="#StackedApp.import_item_list-509"><span class="linenos">509</span></a>            <span class="c1"># write failed lookups to file</span>
</span><span id="StackedApp.import_item_list-510"><a href="#StackedApp.import_item_list-510"><span class="linenos">510</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;failed-lookups.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="StackedApp.import_item_list-511"><a href="#StackedApp.import_item_list-511"><span class="linenos">511</span></a>                <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">lookup_fails</span><span class="p">)</span>
</span><span id="StackedApp.import_item_list-512"><a href="#StackedApp.import_item_list-512"><span class="linenos">512</span></a>            <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;FILE IMPORT&quot;</span><span class="p">,</span>
</span><span id="StackedApp.import_item_list-513"><a href="#StackedApp.import_item_list-513"><span class="linenos">513</span></a>                      <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Imported </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span><span class="si">}</span><span class="s2"> items from </span><span class="si">{</span><span class="n">upcfile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp.import_item_list-514"><a href="#StackedApp.import_item_list-514"><span class="linenos">514</span></a>            <span class="c1"># TODO: write system tray notification function that can do informational, alert, warning, etc. with a title and a message argument</span>
</span><span id="StackedApp.import_item_list-515"><a href="#StackedApp.import_item_list-515"><span class="linenos">515</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp.import_item_list-516"><a href="#StackedApp.import_item_list-516"><span class="linenos">516</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Import Complete&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Imported </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span><span class="si">}</span><span class="s2"> items from </span><span class="si">{</span><span class="n">upcfile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp.import_item_list-517"><a href="#StackedApp.import_item_list-517"><span class="linenos">517</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.import_item_list-518"><a href="#StackedApp.import_item_list-518"><span class="linenos">518</span></a>            <span class="k">pass</span>
</span></pre></div>


    

                            </div>
                            <div id="StackedApp.query_database" class="classattr">
                                        <input id="StackedApp.query_database-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">query_database</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">query</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">fetch_num</span><span class="o">=</span><span class="s1">&#39;all&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.query_database-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.query_database"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.query_database-523"><a href="#StackedApp.query_database-523"><span class="linenos">523</span></a>    <span class="k">def</span> <span class="nf">query_database</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fetch_num</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">):</span>
</span><span id="StackedApp.query_database-524"><a href="#StackedApp.query_database-524"><span class="linenos">524</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.query_database-525"><a href="#StackedApp.query_database-525"><span class="linenos">525</span></a><span class="sd">        query_database takes arguments of: 1. an SQL query as a string, and 2. the number of results to fetch (all or one) and returns the results of the query</span>
</span><span id="StackedApp.query_database-526"><a href="#StackedApp.query_database-526"><span class="linenos">526</span></a>
</span><span id="StackedApp.query_database-527"><a href="#StackedApp.query_database-527"><span class="linenos">527</span></a><span class="sd">        The results of the query are returned as a list of dictionaries. Each dictionary represents a row in the database table and the keys are the column names.</span>
</span><span id="StackedApp.query_database-528"><a href="#StackedApp.query_database-528"><span class="linenos">528</span></a>
</span><span id="StackedApp.query_database-529"><a href="#StackedApp.query_database-529"><span class="linenos">529</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp.query_database-530"><a href="#StackedApp.query_database-530"><span class="linenos">530</span></a><span class="sd">            query (str): SQL query to execute</span>
</span><span id="StackedApp.query_database-531"><a href="#StackedApp.query_database-531"><span class="linenos">531</span></a><span class="sd">            fetch_num (str, optional): how many rows or items to get (fetchall, fetchone...). Defaults to &quot;all&quot;.</span>
</span><span id="StackedApp.query_database-532"><a href="#StackedApp.query_database-532"><span class="linenos">532</span></a>
</span><span id="StackedApp.query_database-533"><a href="#StackedApp.query_database-533"><span class="linenos">533</span></a><span class="sd">        Returns:</span>
</span><span id="StackedApp.query_database-534"><a href="#StackedApp.query_database-534"><span class="linenos">534</span></a><span class="sd">            _type_: _description_</span>
</span><span id="StackedApp.query_database-535"><a href="#StackedApp.query_database-535"><span class="linenos">535</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.query_database-536"><a href="#StackedApp.query_database-536"><span class="linenos">536</span></a>        <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="StackedApp.query_database-537"><a href="#StackedApp.query_database-537"><span class="linenos">537</span></a>            <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="StackedApp.query_database-538"><a href="#StackedApp.query_database-538"><span class="linenos">538</span></a>            <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="StackedApp.query_database-539"><a href="#StackedApp.query_database-539"><span class="linenos">539</span></a>            <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="StackedApp.query_database-540"><a href="#StackedApp.query_database-540"><span class="linenos">540</span></a>            <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="StackedApp.query_database-541"><a href="#StackedApp.query_database-541"><span class="linenos">541</span></a>            <span class="n">dicttrue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="StackedApp.query_database-542"><a href="#StackedApp.query_database-542"><span class="linenos">542</span></a>        <span class="p">)</span>
</span><span id="StackedApp.query_database-543"><a href="#StackedApp.query_database-543"><span class="linenos">543</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="StackedApp.query_database-544"><a href="#StackedApp.query_database-544"><span class="linenos">544</span></a>        <span class="k">if</span> <span class="n">fetch_num</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="StackedApp.query_database-545"><a href="#StackedApp.query_database-545"><span class="linenos">545</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span><span id="StackedApp.query_database-546"><a href="#StackedApp.query_database-546"><span class="linenos">546</span></a>        <span class="k">elif</span> <span class="n">fetch_num</span> <span class="o">==</span> <span class="s2">&quot;one&quot;</span><span class="p">:</span>
</span><span id="StackedApp.query_database-547"><a href="#StackedApp.query_database-547"><span class="linenos">547</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
</span><span id="StackedApp.query_database-548"><a href="#StackedApp.query_database-548"><span class="linenos">548</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp.query_database-549"><a href="#StackedApp.query_database-549"><span class="linenos">549</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp.query_database-550"><a href="#StackedApp.query_database-550"><span class="linenos">550</span></a>        <span class="k">return</span> <span class="n">results</span>
</span></pre></div>


            <div class="docstring"><p>query_database takes arguments of: 1. an SQL query as a string, and 2. the number of results to fetch (all or one) and returns the results of the query</p>

<p>The results of the query are returned as a list of dictionaries. Each dictionary represents a row in the database table and the keys are the column names.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>query (str):</strong>  SQL query to execute</li>
<li><strong>fetch_num (str, optional):</strong>  how many rows or items to get (fetchall, fetchone...). Defaults to "all".</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>_type_: _description_</p>
</blockquote>
</div>


                            </div>
                            <div id="StackedApp.insert_into_db" class="classattr">
                                        <input id="StackedApp.insert_into_db-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">insert_into_db</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">item_dict</span><span class="p">:</span> <span class="nb">dict</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.insert_into_db-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.insert_into_db"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.insert_into_db-553"><a href="#StackedApp.insert_into_db-553"><span class="linenos">553</span></a>    <span class="k">def</span> <span class="nf">insert_into_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StackedApp.insert_into_db-554"><a href="#StackedApp.insert_into_db-554"><span class="linenos">554</span></a>        <span class="c1"># connect to the database</span>
</span><span id="StackedApp.insert_into_db-555"><a href="#StackedApp.insert_into_db-555"><span class="linenos">555</span></a>        <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="StackedApp.insert_into_db-556"><a href="#StackedApp.insert_into_db-556"><span class="linenos">556</span></a>            <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="StackedApp.insert_into_db-557"><a href="#StackedApp.insert_into_db-557"><span class="linenos">557</span></a>            <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="StackedApp.insert_into_db-558"><a href="#StackedApp.insert_into_db-558"><span class="linenos">558</span></a>            <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="StackedApp.insert_into_db-559"><a href="#StackedApp.insert_into_db-559"><span class="linenos">559</span></a>            <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="StackedApp.insert_into_db-560"><a href="#StackedApp.insert_into_db-560"><span class="linenos">560</span></a>            <span class="n">dicttrue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="StackedApp.insert_into_db-561"><a href="#StackedApp.insert_into_db-561"><span class="linenos">561</span></a>        <span class="p">)</span>
</span><span id="StackedApp.insert_into_db-562"><a href="#StackedApp.insert_into_db-562"><span class="linenos">562</span></a>        <span class="c1"># construct the query</span>
</span><span id="StackedApp.insert_into_db-563"><a href="#StackedApp.insert_into_db-563"><span class="linenos">563</span></a>        <span class="n">insert_statement</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;INSERT INTO inventory (brand,description,code,upc,stock,part_num,color,yield,type,comments,linked_codes,needed) VALUES (</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;brand&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;upc&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;stock&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;part_num&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;yield&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;comments&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;linked_codes&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;needed&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="StackedApp.insert_into_db-564"><a href="#StackedApp.insert_into_db-564"><span class="linenos">564</span></a>        <span class="c1"># TODO: check to make sure user has entered the 3 -5 required fields</span>
</span><span id="StackedApp.insert_into_db-565"><a href="#StackedApp.insert_into_db-565"><span class="linenos">565</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_statement</span><span class="p">)</span>
</span><span id="StackedApp.insert_into_db-566"><a href="#StackedApp.insert_into_db-566"><span class="linenos">566</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="StackedApp.insert_into_db-567"><a href="#StackedApp.insert_into_db-567"><span class="linenos">567</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp.insert_into_db-568"><a href="#StackedApp.insert_into_db-568"><span class="linenos">568</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp.insert_into_db-569"><a href="#StackedApp.insert_into_db-569"><span class="linenos">569</span></a>        <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;INSERT&quot;</span><span class="p">,</span>
</span><span id="StackedApp.insert_into_db-570"><a href="#StackedApp.insert_into_db-570"><span class="linenos">570</span></a>                  <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> into database&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp.insert_into_db-571"><a href="#StackedApp.insert_into_db-571"><span class="linenos">571</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp.insert_into_db-572"><a href="#StackedApp.insert_into_db-572"><span class="linenos">572</span></a>            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Inserted&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">item_dict</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> into database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="StackedApp.edit_db_item" class="classattr">
                                        <input id="StackedApp.edit_db_item-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">edit_db_item</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">item</span><span class="p">:</span> <span class="nb">dict</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.edit_db_item-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.edit_db_item"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.edit_db_item-577"><a href="#StackedApp.edit_db_item-577"><span class="linenos">577</span></a>    <span class="k">def</span> <span class="nf">edit_db_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StackedApp.edit_db_item-578"><a href="#StackedApp.edit_db_item-578"><span class="linenos">578</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.edit_db_item-579"><a href="#StackedApp.edit_db_item-579"><span class="linenos">579</span></a><span class="sd">        edit_db_item basic function that takes a dictionary of item details as an argument, and edits the specified item in the database.</span>
</span><span id="StackedApp.edit_db_item-580"><a href="#StackedApp.edit_db_item-580"><span class="linenos">580</span></a>
</span><span id="StackedApp.edit_db_item-581"><a href="#StackedApp.edit_db_item-581"><span class="linenos">581</span></a><span class="sd">        Since the user is not allowed to change the UPC through the GUI, the UPC will stay the same, and therefore can be used to identify the item the user is trying to edit.</span>
</span><span id="StackedApp.edit_db_item-582"><a href="#StackedApp.edit_db_item-582"><span class="linenos">582</span></a>
</span><span id="StackedApp.edit_db_item-583"><a href="#StackedApp.edit_db_item-583"><span class="linenos">583</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp.edit_db_item-584"><a href="#StackedApp.edit_db_item-584"><span class="linenos">584</span></a><span class="sd">            item (dict): dictionary of item details, each key is a column name from the &#39;inventory&#39; table in the database, value is the data value of that item from that column.</span>
</span><span id="StackedApp.edit_db_item-585"><a href="#StackedApp.edit_db_item-585"><span class="linenos">585</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.edit_db_item-586"><a href="#StackedApp.edit_db_item-586"><span class="linenos">586</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="StackedApp.edit_db_item-587"><a href="#StackedApp.edit_db_item-587"><span class="linenos">587</span></a>            <span class="c1"># connect to the database</span>
</span><span id="StackedApp.edit_db_item-588"><a href="#StackedApp.edit_db_item-588"><span class="linenos">588</span></a>            <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="StackedApp.edit_db_item-589"><a href="#StackedApp.edit_db_item-589"><span class="linenos">589</span></a>                <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="StackedApp.edit_db_item-590"><a href="#StackedApp.edit_db_item-590"><span class="linenos">590</span></a>                <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="StackedApp.edit_db_item-591"><a href="#StackedApp.edit_db_item-591"><span class="linenos">591</span></a>                <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="StackedApp.edit_db_item-592"><a href="#StackedApp.edit_db_item-592"><span class="linenos">592</span></a>                <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="StackedApp.edit_db_item-593"><a href="#StackedApp.edit_db_item-593"><span class="linenos">593</span></a>                <span class="n">dicttrue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="StackedApp.edit_db_item-594"><a href="#StackedApp.edit_db_item-594"><span class="linenos">594</span></a>            <span class="p">)</span>
</span><span id="StackedApp.edit_db_item-595"><a href="#StackedApp.edit_db_item-595"><span class="linenos">595</span></a>            <span class="c1"># construct the query</span>
</span><span id="StackedApp.edit_db_item-596"><a href="#StackedApp.edit_db_item-596"><span class="linenos">596</span></a>            <span class="n">update_statement</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE inventory SET brand=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;brand&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, description=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">,printers=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;printers&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, code=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, stock=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;stock&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, part_num=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;part_num&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, color=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, yield=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;yield&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, type=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, comments=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;comments&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, linked_codes=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;linked_codes&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">, needed=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;needed&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2"> WHERE upc=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;upc&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="StackedApp.edit_db_item-597"><a href="#StackedApp.edit_db_item-597"><span class="linenos">597</span></a>            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">update_statement</span><span class="p">)</span>
</span><span id="StackedApp.edit_db_item-598"><a href="#StackedApp.edit_db_item-598"><span class="linenos">598</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="StackedApp.edit_db_item-599"><a href="#StackedApp.edit_db_item-599"><span class="linenos">599</span></a>            <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp.edit_db_item-600"><a href="#StackedApp.edit_db_item-600"><span class="linenos">600</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp.edit_db_item-601"><a href="#StackedApp.edit_db_item-601"><span class="linenos">601</span></a>            <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;UPDATE&quot;</span><span class="p">,</span>
</span><span id="StackedApp.edit_db_item-602"><a href="#StackedApp.edit_db_item-602"><span class="linenos">602</span></a>                      <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Updated </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> in database&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp.edit_db_item-603"><a href="#StackedApp.edit_db_item-603"><span class="linenos">603</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp.edit_db_item-604"><a href="#StackedApp.edit_db_item-604"><span class="linenos">604</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Updated&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Updated </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> in database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp.edit_db_item-605"><a href="#StackedApp.edit_db_item-605"><span class="linenos">605</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StackedApp.edit_db_item-606"><a href="#StackedApp.edit_db_item-606"><span class="linenos">606</span></a>            <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;UPDATE FAIL&quot;</span><span class="p">,</span>
</span><span id="StackedApp.edit_db_item-607"><a href="#StackedApp.edit_db_item-607"><span class="linenos">607</span></a>                      <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> Failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp.edit_db_item-608"><a href="#StackedApp.edit_db_item-608"><span class="linenos">608</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp.edit_db_item-609"><a href="#StackedApp.edit_db_item-609"><span class="linenos">609</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Update Failed&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Failed to update </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> in database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
</span><span id="StackedApp.edit_db_item-610"><a href="#StackedApp.edit_db_item-610"><span class="linenos">610</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="StackedApp.edit_db_item-611"><a href="#StackedApp.edit_db_item-611"><span class="linenos">611</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>edit_db_item basic function that takes a dictionary of item details as an argument, and edits the specified item in the database.</p>

<p>Since the user is not allowed to change the UPC through the GUI, the UPC will stay the same, and therefore can be used to identify the item the user is trying to edit.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>item (dict):</strong>  dictionary of item details, each key is a column name from the 'inventory' table in the database, value is the data value of that item from that column.</li>
</ul>
</div>


                            </div>
                            <div id="StackedApp.insert_item" class="classattr">
                                        <input id="StackedApp.insert_item-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">insert_item</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.insert_item-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.insert_item"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.insert_item-616"><a href="#StackedApp.insert_item-616"><span class="linenos">616</span></a>    <span class="k">def</span> <span class="nf">insert_item</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp.insert_item-617"><a href="#StackedApp.insert_item-617"><span class="linenos">617</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.insert_item-618"><a href="#StackedApp.insert_item-618"><span class="linenos">618</span></a><span class="sd">        insert_item allows user to insert items into the database after checking to make sure theyre not already in there.</span>
</span><span id="StackedApp.insert_item-619"><a href="#StackedApp.insert_item-619"><span class="linenos">619</span></a>
</span><span id="StackedApp.insert_item-620"><a href="#StackedApp.insert_item-620"><span class="linenos">620</span></a><span class="sd">        The app will also try to grab as many details about the item as possible and insert them into the database using whatever code is typed in by the user.</span>
</span><span id="StackedApp.insert_item-621"><a href="#StackedApp.insert_item-621"><span class="linenos">621</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.insert_item-622"><a href="#StackedApp.insert_item-622"><span class="linenos">622</span></a>        <span class="c1"># first ask user to type code into a ApiLookup - app will try to look it up and grab details\</span>
</span><span id="StackedApp.insert_item-623"><a href="#StackedApp.insert_item-623"><span class="linenos">623</span></a>        <span class="n">user_notes</span> <span class="o">=</span> <span class="n">ApiLookup</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.insert_item-624"><a href="#StackedApp.insert_item-624"><span class="linenos">624</span></a>        <span class="k">if</span> <span class="n">user_notes</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
</span><span id="StackedApp.insert_item-625"><a href="#StackedApp.insert_item-625"><span class="linenos">625</span></a>            <span class="c1"># get code and try look it up, this will actually check the database first, but then it will go out and check api</span>
</span><span id="StackedApp.insert_item-626"><a href="#StackedApp.insert_item-626"><span class="linenos">626</span></a>            <span class="n">notes</span> <span class="o">=</span> <span class="n">user_notes</span><span class="o">.</span><span class="n">textValue</span><span class="p">()</span>
</span><span id="StackedApp.insert_item-627"><a href="#StackedApp.insert_item-627"><span class="linenos">627</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">notes</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">notes</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
</span><span id="StackedApp.insert_item-628"><a href="#StackedApp.insert_item-628"><span class="linenos">628</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">ItemLookup</span><span class="p">(</span><span class="n">input_code</span><span class="o">=</span><span class="n">notes</span><span class="p">)</span><span class="o">.</span><span class="n">look_up_code</span><span class="p">()</span>
</span><span id="StackedApp.insert_item-629"><a href="#StackedApp.insert_item-629"><span class="linenos">629</span></a>                <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
</span><span id="StackedApp.insert_item-630"><a href="#StackedApp.insert_item-630"><span class="linenos">630</span></a>                    <span class="c1"># TODO: open an edit item dialog, with the item&#39;s existing details (one&#39;s that api pulled) inserted in the qlineedits</span>
</span><span id="StackedApp.insert_item-631"><a href="#StackedApp.insert_item-631"><span class="linenos">631</span></a>                    <span class="c1"># if the lookup was successful, then item has been inserted into the database, so open an edit item dialog with the item details</span>
</span><span id="StackedApp.insert_item-632"><a href="#StackedApp.insert_item-632"><span class="linenos">632</span></a>                    <span class="c1"># -- for now, just display popup saying item was added</span>
</span><span id="StackedApp.insert_item-633"><a href="#StackedApp.insert_item-633"><span class="linenos">633</span></a>                    <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
</span><span id="StackedApp.insert_item-634"><a href="#StackedApp.insert_item-634"><span class="linenos">634</span></a>                    <span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp.insert_item-635"><a href="#StackedApp.insert_item-635"><span class="linenos">635</span></a>                    <span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Item </span><span class="si">{</span><span class="n">notes</span><span class="si">}</span><span class="s2"> added to database.&quot;</span><span class="p">)</span>
</span><span id="StackedApp.insert_item-636"><a href="#StackedApp.insert_item-636"><span class="linenos">636</span></a>                    <span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Item Added&quot;</span><span class="p">)</span>
</span><span id="StackedApp.insert_item-637"><a href="#StackedApp.insert_item-637"><span class="linenos">637</span></a>                    <span class="n">ok_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">)</span>
</span><span id="StackedApp.insert_item-638"><a href="#StackedApp.insert_item-638"><span class="linenos">638</span></a>                    <span class="n">ok_button</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">35</span><span class="p">)</span>
</span><span id="StackedApp.insert_item-639"><a href="#StackedApp.insert_item-639"><span class="linenos">639</span></a>                    <span class="n">msg</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="n">ok_button</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">AcceptRole</span><span class="p">)</span>
</span><span id="StackedApp.insert_item-640"><a href="#StackedApp.insert_item-640"><span class="linenos">640</span></a>                    <span class="n">msg</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp.insert_item-641"><a href="#StackedApp.insert_item-641"><span class="linenos">641</span></a>
</span><span id="StackedApp.insert_item-642"><a href="#StackedApp.insert_item-642"><span class="linenos">642</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.insert_item-643"><a href="#StackedApp.insert_item-643"><span class="linenos">643</span></a>                    <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="StackedApp.insert_item-644"><a href="#StackedApp.insert_item-644"><span class="linenos">644</span></a>                        <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;insert&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.insert_item-645"><a href="#StackedApp.insert_item-645"><span class="linenos">645</span></a>                    <span class="c1"># item_dialog.dataEntered.connect(self.edit_db_item)</span>
</span><span id="StackedApp.insert_item-646"><a href="#StackedApp.insert_item-646"><span class="linenos">646</span></a>                    <span class="k">if</span> <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
</span><span id="StackedApp.insert_item-647"><a href="#StackedApp.insert_item-647"><span class="linenos">647</span></a>                        <span class="c1"># get the item from the item dialog</span>
</span><span id="StackedApp.insert_item-648"><a href="#StackedApp.insert_item-648"><span class="linenos">648</span></a>                        <span class="n">item</span> <span class="o">=</span> <span class="n">item_dialog</span><span class="o">.</span><span class="n">get_item</span><span class="p">()</span>
</span><span id="StackedApp.insert_item-649"><a href="#StackedApp.insert_item-649"><span class="linenos">649</span></a>                        <span class="c1"># open the edit item dialog</span>
</span><span id="StackedApp.insert_item-650"><a href="#StackedApp.insert_item-650"><span class="linenos">650</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">insert_into_db</span><span class="p">(</span><span class="n">item_dict</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="StackedApp.insert_item-651"><a href="#StackedApp.insert_item-651"><span class="linenos">651</span></a>
</span><span id="StackedApp.insert_item-652"><a href="#StackedApp.insert_item-652"><span class="linenos">652</span></a>                <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;INSERT&quot;</span><span class="p">,</span>
</span><span id="StackedApp.insert_item-653"><a href="#StackedApp.insert_item-653"><span class="linenos">653</span></a>                          <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">notes</span><span class="si">}</span><span class="s2"> into database&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp.insert_item-654"><a href="#StackedApp.insert_item-654"><span class="linenos">654</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp.insert_item-655"><a href="#StackedApp.insert_item-655"><span class="linenos">655</span></a>                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Inserted&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">notes</span><span class="si">}</span><span class="s2"> into database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp.insert_item-656"><a href="#StackedApp.insert_item-656"><span class="linenos">656</span></a>                <span class="k">return</span>
</span><span id="StackedApp.insert_item-657"><a href="#StackedApp.insert_item-657"><span class="linenos">657</span></a>        <span class="c1"># if user closes the notes dialog or something else goes wrong:</span>
</span><span id="StackedApp.insert_item-658"><a href="#StackedApp.insert_item-658"><span class="linenos">658</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.insert_item-659"><a href="#StackedApp.insert_item-659"><span class="linenos">659</span></a>            <span class="c1"># just open the item dialog with a blank item</span>
</span><span id="StackedApp.insert_item-660"><a href="#StackedApp.insert_item-660"><span class="linenos">660</span></a>            <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="StackedApp.insert_item-661"><a href="#StackedApp.insert_item-661"><span class="linenos">661</span></a>                <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;insert&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.insert_item-662"><a href="#StackedApp.insert_item-662"><span class="linenos">662</span></a>            <span class="c1"># item_dialog.dataEntered.connect(self.edit_db_item)</span>
</span><span id="StackedApp.insert_item-663"><a href="#StackedApp.insert_item-663"><span class="linenos">663</span></a>            <span class="k">if</span> <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
</span><span id="StackedApp.insert_item-664"><a href="#StackedApp.insert_item-664"><span class="linenos">664</span></a>                <span class="c1"># get the item from the item dialog</span>
</span><span id="StackedApp.insert_item-665"><a href="#StackedApp.insert_item-665"><span class="linenos">665</span></a>                <span class="n">item</span> <span class="o">=</span> <span class="n">item_dialog</span><span class="o">.</span><span class="n">get_item</span><span class="p">()</span>
</span><span id="StackedApp.insert_item-666"><a href="#StackedApp.insert_item-666"><span class="linenos">666</span></a>                <span class="c1"># open the edit item dialog</span>
</span><span id="StackedApp.insert_item-667"><a href="#StackedApp.insert_item-667"><span class="linenos">667</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">insert_into_db</span><span class="p">(</span><span class="n">item_dict</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="StackedApp.insert_item-668"><a href="#StackedApp.insert_item-668"><span class="linenos">668</span></a>                <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;INSERT&quot;</span><span class="p">,</span>
</span><span id="StackedApp.insert_item-669"><a href="#StackedApp.insert_item-669"><span class="linenos">669</span></a>                          <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> into the database&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp.insert_item-670"><a href="#StackedApp.insert_item-670"><span class="linenos">670</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp.insert_item-671"><a href="#StackedApp.insert_item-671"><span class="linenos">671</span></a>                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Inserted&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inserted </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2"> into database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>insert_item allows user to insert items into the database after checking to make sure theyre not already in there.</p>

<p>The app will also try to grab as many details about the item as possible and insert them into the database using whatever code is typed in by the user.</p>
</div>


                            </div>
                            <div id="StackedApp.edit_app_item" class="classattr">
                                        <input id="StackedApp.edit_app_item-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">edit_app_item</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">input_arg</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.edit_app_item-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.edit_app_item"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.edit_app_item-673"><a href="#StackedApp.edit_app_item-673"><span class="linenos">673</span></a>    <span class="k">def</span> <span class="nf">edit_app_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_arg</span><span class="p">):</span>
</span><span id="StackedApp.edit_app_item-674"><a href="#StackedApp.edit_app_item-674"><span class="linenos">674</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.edit_app_item-675"><a href="#StackedApp.edit_app_item-675"><span class="linenos">675</span></a><span class="sd">        edit_app_item called when the user double-clicks either a an item via a table row, or a widget on a dashboard. When the user double-clicks a table row, input_arg will be a QModelIndex. When the user clicks dashboard widget, input_arge will be a dictionary of the widget&#39;s details.</span>
</span><span id="StackedApp.edit_app_item-676"><a href="#StackedApp.edit_app_item-676"><span class="linenos">676</span></a>
</span><span id="StackedApp.edit_app_item-677"><a href="#StackedApp.edit_app_item-677"><span class="linenos">677</span></a><span class="sd">        This function is meant to combine the multiple edit functions present in previous versions.</span>
</span><span id="StackedApp.edit_app_item-678"><a href="#StackedApp.edit_app_item-678"><span class="linenos">678</span></a>
</span><span id="StackedApp.edit_app_item-679"><a href="#StackedApp.edit_app_item-679"><span class="linenos">679</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp.edit_app_item-680"><a href="#StackedApp.edit_app_item-680"><span class="linenos">680</span></a><span class="sd">            input_arg (_type_): _description_</span>
</span><span id="StackedApp.edit_app_item-681"><a href="#StackedApp.edit_app_item-681"><span class="linenos">681</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.edit_app_item-682"><a href="#StackedApp.edit_app_item-682"><span class="linenos">682</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_arg</span><span class="p">,</span> <span class="n">QModelIndex</span><span class="p">):</span>
</span><span id="StackedApp.edit_app_item-683"><a href="#StackedApp.edit_app_item-683"><span class="linenos">683</span></a>            <span class="n">row</span> <span class="o">=</span> <span class="n">input_arg</span><span class="o">.</span><span class="n">row</span><span class="p">()</span>
</span><span id="StackedApp.edit_app_item-684"><a href="#StackedApp.edit_app_item-684"><span class="linenos">684</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StackedApp.edit_app_item-685"><a href="#StackedApp.edit_app_item-685"><span class="linenos">685</span></a>            <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">columnCount</span><span class="p">()):</span>
</span><span id="StackedApp.edit_app_item-686"><a href="#StackedApp.edit_app_item-686"><span class="linenos">686</span></a>                <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">headerData</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">)</span>
</span><span id="StackedApp.edit_app_item-687"><a href="#StackedApp.edit_app_item-687"><span class="linenos">687</span></a>                <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">DisplayRole</span><span class="p">)</span>
</span><span id="StackedApp.edit_app_item-688"><a href="#StackedApp.edit_app_item-688"><span class="linenos">688</span></a>                <span class="n">data</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">item</span>
</span><span id="StackedApp.edit_app_item-689"><a href="#StackedApp.edit_app_item-689"><span class="linenos">689</span></a>            <span class="c1"># open item dialog with the item dictionary</span>
</span><span id="StackedApp.edit_app_item-690"><a href="#StackedApp.edit_app_item-690"><span class="linenos">690</span></a>            <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="StackedApp.edit_app_item-691"><a href="#StackedApp.edit_app_item-691"><span class="linenos">691</span></a>                <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_item</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="StackedApp.edit_app_item-692"><a href="#StackedApp.edit_app_item-692"><span class="linenos">692</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">db_operation</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_item_dialog</span><span class="p">)</span>
</span><span id="StackedApp.edit_app_item-693"><a href="#StackedApp.edit_app_item-693"><span class="linenos">693</span></a>
</span><span id="StackedApp.edit_app_item-694"><a href="#StackedApp.edit_app_item-694"><span class="linenos">694</span></a>            <span class="c1"># item_dialog.dataEntered.connect(self.edit_db_item)</span>
</span><span id="StackedApp.edit_app_item-695"><a href="#StackedApp.edit_app_item-695"><span class="linenos">695</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp.edit_app_item-696"><a href="#StackedApp.edit_app_item-696"><span class="linenos">696</span></a>            <span class="c1"># return</span>
</span><span id="StackedApp.edit_app_item-697"><a href="#StackedApp.edit_app_item-697"><span class="linenos">697</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_arg</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StackedApp.edit_app_item-698"><a href="#StackedApp.edit_app_item-698"><span class="linenos">698</span></a>            <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="StackedApp.edit_app_item-699"><a href="#StackedApp.edit_app_item-699"><span class="linenos">699</span></a>                <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_item</span><span class="o">=</span><span class="n">input_arg</span><span class="p">)</span>
</span><span id="StackedApp.edit_app_item-700"><a href="#StackedApp.edit_app_item-700"><span class="linenos">700</span></a>            <span class="c1"># item_dialog.dataEntered.connect(self.edit_db_item)</span>
</span><span id="StackedApp.edit_app_item-701"><a href="#StackedApp.edit_app_item-701"><span class="linenos">701</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">db_operation</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_item_dialog</span><span class="p">)</span>
</span><span id="StackedApp.edit_app_item-702"><a href="#StackedApp.edit_app_item-702"><span class="linenos">702</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp.edit_app_item-703"><a href="#StackedApp.edit_app_item-703"><span class="linenos">703</span></a>
</span><span id="StackedApp.edit_app_item-704"><a href="#StackedApp.edit_app_item-704"><span class="linenos">704</span></a>            <span class="c1"># return</span>
</span><span id="StackedApp.edit_app_item-705"><a href="#StackedApp.edit_app_item-705"><span class="linenos">705</span></a>        <span class="k">elif</span> <span class="n">input_arg</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StackedApp.edit_app_item-706"><a href="#StackedApp.edit_app_item-706"><span class="linenos">706</span></a>            <span class="n">popup</span> <span class="o">=</span> <span class="n">FindItemDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.edit_app_item-707"><a href="#StackedApp.edit_app_item-707"><span class="linenos">707</span></a>            <span class="n">popup</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp.edit_app_item-708"><a href="#StackedApp.edit_app_item-708"><span class="linenos">708</span></a>            <span class="k">if</span> <span class="n">popup</span><span class="o">.</span><span class="n">result</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="StackedApp.edit_app_item-709"><a href="#StackedApp.edit_app_item-709"><span class="linenos">709</span></a>                <span class="c1"># get the code and upc from the popup</span>
</span><span id="StackedApp.edit_app_item-710"><a href="#StackedApp.edit_app_item-710"><span class="linenos">710</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">popup</span><span class="o">.</span><span class="n">code</span>
</span><span id="StackedApp.edit_app_item-711"><a href="#StackedApp.edit_app_item-711"><span class="linenos">711</span></a>                <span class="n">upc</span> <span class="o">=</span> <span class="n">popup</span><span class="o">.</span><span class="n">upc</span>
</span><span id="StackedApp.edit_app_item-712"><a href="#StackedApp.edit_app_item-712"><span class="linenos">712</span></a>
</span><span id="StackedApp.edit_app_item-713"><a href="#StackedApp.edit_app_item-713"><span class="linenos">713</span></a>                <span class="c1"># construct query using the parameters entered (either code, upc, or both)</span>
</span><span id="StackedApp.edit_app_item-714"><a href="#StackedApp.edit_app_item-714"><span class="linenos">714</span></a>                <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">upc</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="StackedApp.edit_app_item-715"><a href="#StackedApp.edit_app_item-715"><span class="linenos">715</span></a>                    <span class="k">return</span>
</span><span id="StackedApp.edit_app_item-716"><a href="#StackedApp.edit_app_item-716"><span class="linenos">716</span></a>                <span class="k">elif</span> <span class="n">code</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="StackedApp.edit_app_item-717"><a href="#StackedApp.edit_app_item-717"><span class="linenos">717</span></a>                    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM inventory WHERE upc=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">upc</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="StackedApp.edit_app_item-718"><a href="#StackedApp.edit_app_item-718"><span class="linenos">718</span></a>                <span class="k">elif</span> <span class="n">upc</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="StackedApp.edit_app_item-719"><a href="#StackedApp.edit_app_item-719"><span class="linenos">719</span></a>                    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM inventory WHERE code=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="StackedApp.edit_app_item-720"><a href="#StackedApp.edit_app_item-720"><span class="linenos">720</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.edit_app_item-721"><a href="#StackedApp.edit_app_item-721"><span class="linenos">721</span></a>                    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM inventory WHERE code=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2"> AND upc=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">upc</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="StackedApp.edit_app_item-722"><a href="#StackedApp.edit_app_item-722"><span class="linenos">722</span></a>                <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_database</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">fetch_num</span><span class="o">=</span><span class="s2">&quot;one&quot;</span><span class="p">)</span>
</span><span id="StackedApp.edit_app_item-723"><a href="#StackedApp.edit_app_item-723"><span class="linenos">723</span></a>                <span class="c1"># if there are no results, show a popup saying that no item was found</span>
</span><span id="StackedApp.edit_app_item-724"><a href="#StackedApp.edit_app_item-724"><span class="linenos">724</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="StackedApp.edit_app_item-725"><a href="#StackedApp.edit_app_item-725"><span class="linenos">725</span></a>                    <span class="k">return</span>
</span><span id="StackedApp.edit_app_item-726"><a href="#StackedApp.edit_app_item-726"><span class="linenos">726</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.edit_app_item-727"><a href="#StackedApp.edit_app_item-727"><span class="linenos">727</span></a>                    <span class="c1"># if there are results, populate the item dialog with the data</span>
</span><span id="StackedApp.edit_app_item-728"><a href="#StackedApp.edit_app_item-728"><span class="linenos">728</span></a>                    <span class="c1"># open item dialog with data pre-populated</span>
</span><span id="StackedApp.edit_app_item-729"><a href="#StackedApp.edit_app_item-729"><span class="linenos">729</span></a>                    <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="StackedApp.edit_app_item-730"><a href="#StackedApp.edit_app_item-730"><span class="linenos">730</span></a>                        <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_item</span><span class="o">=</span><span class="n">results</span><span class="p">)</span>
</span><span id="StackedApp.edit_app_item-731"><a href="#StackedApp.edit_app_item-731"><span class="linenos">731</span></a>                    <span class="n">item_dialog</span><span class="o">.</span><span class="n">db_operation</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_item_dialog</span><span class="p">)</span>
</span><span id="StackedApp.edit_app_item-732"><a href="#StackedApp.edit_app_item-732"><span class="linenos">732</span></a>                    <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp.edit_app_item-733"><a href="#StackedApp.edit_app_item-733"><span class="linenos">733</span></a>
</span><span id="StackedApp.edit_app_item-734"><a href="#StackedApp.edit_app_item-734"><span class="linenos">734</span></a>        <span class="c1"># if there are results, populate the item dialog with the data</span>
</span><span id="StackedApp.edit_app_item-735"><a href="#StackedApp.edit_app_item-735"><span class="linenos">735</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.edit_app_item-736"><a href="#StackedApp.edit_app_item-736"><span class="linenos">736</span></a>            <span class="c1"># open item dialog with data pre-populated</span>
</span><span id="StackedApp.edit_app_item-737"><a href="#StackedApp.edit_app_item-737"><span class="linenos">737</span></a>            <span class="n">item_dialog</span> <span class="o">=</span> <span class="n">ItemPopup</span><span class="p">(</span>
</span><span id="StackedApp.edit_app_item-738"><a href="#StackedApp.edit_app_item-738"><span class="linenos">738</span></a>                <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_item</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
</span><span id="StackedApp.edit_app_item-739"><a href="#StackedApp.edit_app_item-739"><span class="linenos">739</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">db_operation</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_item_dialog</span><span class="p">)</span>
</span><span id="StackedApp.edit_app_item-740"><a href="#StackedApp.edit_app_item-740"><span class="linenos">740</span></a>            <span class="n">item_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>edit_app_item called when the user double-clicks either a an item via a table row, or a widget on a dashboard. When the user double-clicks a table row, input_arg will be a QModelIndex. When the user clicks dashboard widget, input_arge will be a dictionary of the widget's details.</p>

<p>This function is meant to combine the multiple edit functions present in previous versions.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>input_arg (_type_):</strong>  _description_</li>
</ul>
</div>


                            </div>
                            <div id="StackedApp.delete_from_db" class="classattr">
                                        <input id="StackedApp.delete_from_db-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">delete_from_db</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">input_arg</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.delete_from_db-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.delete_from_db"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.delete_from_db-742"><a href="#StackedApp.delete_from_db-742"><span class="linenos">742</span></a>    <span class="k">def</span> <span class="nf">delete_from_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_arg</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="StackedApp.delete_from_db-743"><a href="#StackedApp.delete_from_db-743"><span class="linenos">743</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.delete_from_db-744"><a href="#StackedApp.delete_from_db-744"><span class="linenos">744</span></a><span class="sd">        delete_from_db deletes item from the database, and from the table on display (if applicable).</span>
</span><span id="StackedApp.delete_from_db-745"><a href="#StackedApp.delete_from_db-745"><span class="linenos">745</span></a>
</span><span id="StackedApp.delete_from_db-746"><a href="#StackedApp.delete_from_db-746"><span class="linenos">746</span></a><span class="sd">        Function is called when the user clicks on the trash can icon, after double-clicking a row on a table or widget on a dashboard.</span>
</span><span id="StackedApp.delete_from_db-747"><a href="#StackedApp.delete_from_db-747"><span class="linenos">747</span></a>
</span><span id="StackedApp.delete_from_db-748"><a href="#StackedApp.delete_from_db-748"><span class="linenos">748</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp.delete_from_db-749"><a href="#StackedApp.delete_from_db-749"><span class="linenos">749</span></a><span class="sd">            input_arg (_type_, optional): _description_. Defaults to None.</span>
</span><span id="StackedApp.delete_from_db-750"><a href="#StackedApp.delete_from_db-750"><span class="linenos">750</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.delete_from_db-751"><a href="#StackedApp.delete_from_db-751"><span class="linenos">751</span></a>        <span class="n">description</span> <span class="o">=</span> <span class="n">input_arg</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span>
</span><span id="StackedApp.delete_from_db-752"><a href="#StackedApp.delete_from_db-752"><span class="linenos">752</span></a>        <span class="n">upc</span> <span class="o">=</span> <span class="n">input_arg</span><span class="p">[</span><span class="s2">&quot;upc&quot;</span><span class="p">]</span>
</span><span id="StackedApp.delete_from_db-753"><a href="#StackedApp.delete_from_db-753"><span class="linenos">753</span></a>
</span><span id="StackedApp.delete_from_db-754"><a href="#StackedApp.delete_from_db-754"><span class="linenos">754</span></a>        <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="StackedApp.delete_from_db-755"><a href="#StackedApp.delete_from_db-755"><span class="linenos">755</span></a>            <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="StackedApp.delete_from_db-756"><a href="#StackedApp.delete_from_db-756"><span class="linenos">756</span></a>            <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="StackedApp.delete_from_db-757"><a href="#StackedApp.delete_from_db-757"><span class="linenos">757</span></a>            <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="StackedApp.delete_from_db-758"><a href="#StackedApp.delete_from_db-758"><span class="linenos">758</span></a>            <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="StackedApp.delete_from_db-759"><a href="#StackedApp.delete_from_db-759"><span class="linenos">759</span></a>            <span class="n">dicttrue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="StackedApp.delete_from_db-760"><a href="#StackedApp.delete_from_db-760"><span class="linenos">760</span></a>        <span class="p">)</span>
</span><span id="StackedApp.delete_from_db-761"><a href="#StackedApp.delete_from_db-761"><span class="linenos">761</span></a>        <span class="n">delete_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;DELETE FROM </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> WHERE upc = </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">upc</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2"> AND description=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="StackedApp.delete_from_db-762"><a href="#StackedApp.delete_from_db-762"><span class="linenos">762</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">delete_query</span><span class="p">)</span>
</span><span id="StackedApp.delete_from_db-763"><a href="#StackedApp.delete_from_db-763"><span class="linenos">763</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="StackedApp.delete_from_db-764"><a href="#StackedApp.delete_from_db-764"><span class="linenos">764</span></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp.delete_from_db-765"><a href="#StackedApp.delete_from_db-765"><span class="linenos">765</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp.delete_from_db-766"><a href="#StackedApp.delete_from_db-766"><span class="linenos">766</span></a>        <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
</span><span id="StackedApp.delete_from_db-767"><a href="#StackedApp.delete_from_db-767"><span class="linenos">767</span></a>                  <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Deleted </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2"> from database&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StackedApp.delete_from_db-768"><a href="#StackedApp.delete_from_db-768"><span class="linenos">768</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp.delete_from_db-769"><a href="#StackedApp.delete_from_db-769"><span class="linenos">769</span></a>            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Item Deleted&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Deleted </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2"> from database&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp.delete_from_db-770"><a href="#StackedApp.delete_from_db-770"><span class="linenos">770</span></a>        <span class="c1"># if a table is being displayed, then get currently selected row and delete it from the table</span>
</span><span id="StackedApp.delete_from_db-771"><a href="#StackedApp.delete_from_db-771"><span class="linenos">771</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="StackedApp.delete_from_db-772"><a href="#StackedApp.delete_from_db-772"><span class="linenos">772</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>delete_from_db deletes item from the database, and from the table on display (if applicable).</p>

<p>Function is called when the user clicks on the trash can icon, after double-clicking a row on a table or widget on a dashboard.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>input_arg (_type_, optional):</strong>  _description_. Defaults to None.</li>
</ul>
</div>


                            </div>
                            <div id="StackedApp.search_db_mode" class="classattr">
                                        <input id="StackedApp.search_db_mode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">search_db_mode</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">mode</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">input_query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.search_db_mode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.search_db_mode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.search_db_mode-774"><a href="#StackedApp.search_db_mode-774"><span class="linenos">774</span></a>    <span class="k">def</span> <span class="nf">search_db_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">input_query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="StackedApp.search_db_mode-775"><a href="#StackedApp.search_db_mode-775"><span class="linenos">775</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.search_db_mode-776"><a href="#StackedApp.search_db_mode-776"><span class="linenos">776</span></a><span class="sd">        search_db_mode the user can search any of the columns in the inventory table by typing in the search bar. This function will display the results in a table.</span>
</span><span id="StackedApp.search_db_mode-777"><a href="#StackedApp.search_db_mode-777"><span class="linenos">777</span></a>
</span><span id="StackedApp.search_db_mode-778"><a href="#StackedApp.search_db_mode-778"><span class="linenos">778</span></a><span class="sd">        _extended_summary_</span>
</span><span id="StackedApp.search_db_mode-779"><a href="#StackedApp.search_db_mode-779"><span class="linenos">779</span></a>
</span><span id="StackedApp.search_db_mode-780"><a href="#StackedApp.search_db_mode-780"><span class="linenos">780</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp.search_db_mode-781"><a href="#StackedApp.search_db_mode-781"><span class="linenos">781</span></a><span class="sd">            mode (str): where the search is initiated from. Can be either &#39;table&#39; or &#39;popup&#39;, this tells the app in which QLineEdit (textbox) to look for the search term that the user has typed.</span>
</span><span id="StackedApp.search_db_mode-782"><a href="#StackedApp.search_db_mode-782"><span class="linenos">782</span></a><span class="sd">            input_query (str, optional): an SQL query passed in as an argument when the search is initiated from the popup. A user can view this popup by choosing search on one of the menubars. Defaults to None.</span>
</span><span id="StackedApp.search_db_mode-783"><a href="#StackedApp.search_db_mode-783"><span class="linenos">783</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.search_db_mode-784"><a href="#StackedApp.search_db_mode-784"><span class="linenos">784</span></a>        <span class="c1"># search the database for the search term</span>
</span><span id="StackedApp.search_db_mode-785"><a href="#StackedApp.search_db_mode-785"><span class="linenos">785</span></a>        <span class="c1"># column stirng</span>
</span><span id="StackedApp.search_db_mode-786"><a href="#StackedApp.search_db_mode-786"><span class="linenos">786</span></a>        <span class="n">column_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="StackedApp.search_db_mode-787"><a href="#StackedApp.search_db_mode-787"><span class="linenos">787</span></a>        <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="StackedApp.search_db_mode-788"><a href="#StackedApp.search_db_mode-788"><span class="linenos">788</span></a>            <span class="n">column_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="StackedApp.search_db_mode-789"><a href="#StackedApp.search_db_mode-789"><span class="linenos">789</span></a>        <span class="n">column_str</span> <span class="o">=</span> <span class="n">column_str</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="StackedApp.search_db_mode-790"><a href="#StackedApp.search_db_mode-790"><span class="linenos">790</span></a>        <span class="c1"># set the table model to the results of the search</span>
</span><span id="StackedApp.search_db_mode-791"><a href="#StackedApp.search_db_mode-791"><span class="linenos">791</span></a>        <span class="c1"># if mode is table, get text from table qlineedit</span>
</span><span id="StackedApp.search_db_mode-792"><a href="#StackedApp.search_db_mode-792"><span class="linenos">792</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;table&quot;</span><span class="p">:</span>
</span><span id="StackedApp.search_db_mode-793"><a href="#StackedApp.search_db_mode-793"><span class="linenos">793</span></a>            <span class="n">search_term</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span><span id="StackedApp.search_db_mode-794"><a href="#StackedApp.search_db_mode-794"><span class="linenos">794</span></a>            <span class="c1"># get column name from combobox</span>
</span><span id="StackedApp.search_db_mode-795"><a href="#StackedApp.search_db_mode-795"><span class="linenos">795</span></a>            <span class="n">column_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
</span><span id="StackedApp.search_db_mode-796"><a href="#StackedApp.search_db_mode-796"><span class="linenos">796</span></a>            <span class="k">if</span> <span class="n">search_term</span> <span class="ow">and</span> <span class="n">column_name</span> <span class="o">!=</span> <span class="s2">&quot;Choose column:&quot;</span><span class="p">:</span>
</span><span id="StackedApp.search_db_mode-797"><a href="#StackedApp.search_db_mode-797"><span class="linenos">797</span></a>                <span class="c1"># construct query</span>
</span><span id="StackedApp.search_db_mode-798"><a href="#StackedApp.search_db_mode-798"><span class="linenos">798</span></a>                <span class="c1"># CANNOT just use * in query, because the table model will not be able to match the correct column&#39;s data to the correct column header</span>
</span><span id="StackedApp.search_db_mode-799"><a href="#StackedApp.search_db_mode-799"><span class="linenos">799</span></a>                <span class="c1"># TODO: Try to fix the above issue.</span>
</span><span id="StackedApp.search_db_mode-800"><a href="#StackedApp.search_db_mode-800"><span class="linenos">800</span></a>                <span class="n">search_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT </span><span class="si">{</span><span class="n">column_str</span><span class="si">}</span><span class="s2"> FROM inventory WHERE </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> LIKE &#39;%</span><span class="si">{</span><span class="n">search_term</span><span class="si">}</span><span class="s2">%&#39;&quot;</span>
</span><span id="StackedApp.search_db_mode-801"><a href="#StackedApp.search_db_mode-801"><span class="linenos">801</span></a>                <span class="n">new_title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Search Results: </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">search_term</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StackedApp.search_db_mode-802"><a href="#StackedApp.search_db_mode-802"><span class="linenos">802</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">search_query</span><span class="p">)</span>
</span><span id="StackedApp.search_db_mode-803"><a href="#StackedApp.search_db_mode-803"><span class="linenos">803</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_title_text</span><span class="p">(</span><span class="n">new_title</span><span class="p">)</span>
</span><span id="StackedApp.search_db_mode-804"><a href="#StackedApp.search_db_mode-804"><span class="linenos">804</span></a>        <span class="c1"># if search is done from the popup dialog</span>
</span><span id="StackedApp.search_db_mode-805"><a href="#StackedApp.search_db_mode-805"><span class="linenos">805</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;popup&quot;</span><span class="p">:</span>
</span><span id="StackedApp.search_db_mode-806"><a href="#StackedApp.search_db_mode-806"><span class="linenos">806</span></a>            <span class="c1"># don&#39;t need to get search text because query passed in input_query</span>
</span><span id="StackedApp.search_db_mode-807"><a href="#StackedApp.search_db_mode-807"><span class="linenos">807</span></a>            <span class="n">search_query</span> <span class="o">=</span> <span class="n">input_query</span>
</span><span id="StackedApp.search_db_mode-808"><a href="#StackedApp.search_db_mode-808"><span class="linenos">808</span></a>            <span class="n">new_title</span> <span class="o">=</span> <span class="s2">&quot;Search Results:&quot;</span>
</span><span id="StackedApp.search_db_mode-809"><a href="#StackedApp.search_db_mode-809"><span class="linenos">809</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">search_query</span><span class="p">)</span>
</span><span id="StackedApp.search_db_mode-810"><a href="#StackedApp.search_db_mode-810"><span class="linenos">810</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_title_text</span><span class="p">(</span><span class="n">new_title</span><span class="p">)</span>
</span><span id="StackedApp.search_db_mode-811"><a href="#StackedApp.search_db_mode-811"><span class="linenos">811</span></a>
</span><span id="StackedApp.search_db_mode-812"><a href="#StackedApp.search_db_mode-812"><span class="linenos">812</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_table_page</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>search_db_mode the user can search any of the columns in the inventory table by typing in the search bar. This function will display the results in a table.</p>

<p>_extended_summary_</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>mode (str):</strong>  where the search is initiated from. Can be either 'table' or 'popup', this tells the app in which QLineEdit (textbox) to look for the search term that the user has typed.</li>
<li><strong>input_query (str, optional):</strong>  an SQL query passed in as an argument when the search is initiated from the popup. A user can view this popup by choosing search on one of the menubars. Defaults to None.</li>
</ul>
</div>


                            </div>
                            <div id="StackedApp.backup_to_csv" class="classattr">
                                        <input id="StackedApp.backup_to_csv-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">backup_to_csv</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">notification</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.backup_to_csv-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.backup_to_csv"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.backup_to_csv-814"><a href="#StackedApp.backup_to_csv-814"><span class="linenos">814</span></a>    <span class="k">def</span> <span class="nf">backup_to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">notification</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="StackedApp.backup_to_csv-815"><a href="#StackedApp.backup_to_csv-815"><span class="linenos">815</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.backup_to_csv-816"><a href="#StackedApp.backup_to_csv-816"><span class="linenos">816</span></a><span class="sd">        backup_to_csv first prompts the user with a yes/no popup asking if they&#39;d like to backup the inventory table to a csv file. If yes, then the table is backed up to a csv file in the &lt;b&gt;output folder.&lt;/b&gt;</span>
</span><span id="StackedApp.backup_to_csv-817"><a href="#StackedApp.backup_to_csv-817"><span class="linenos">817</span></a>
</span><span id="StackedApp.backup_to_csv-818"><a href="#StackedApp.backup_to_csv-818"><span class="linenos">818</span></a><span class="sd">        If the user hasn&#39;t muted the app&#39;s notifications, then a notification is sent to the system tray with the filename. CSV filenames are auto-generated with the date and time appended to the end.</span>
</span><span id="StackedApp.backup_to_csv-819"><a href="#StackedApp.backup_to_csv-819"><span class="linenos">819</span></a>
</span><span id="StackedApp.backup_to_csv-820"><a href="#StackedApp.backup_to_csv-820"><span class="linenos">820</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp.backup_to_csv-821"><a href="#StackedApp.backup_to_csv-821"><span class="linenos">821</span></a><span class="sd">            notification (bool, optional): _description_. Defaults to True.</span>
</span><span id="StackedApp.backup_to_csv-822"><a href="#StackedApp.backup_to_csv-822"><span class="linenos">822</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.backup_to_csv-823"><a href="#StackedApp.backup_to_csv-823"><span class="linenos">823</span></a>        <span class="c1"># output filename is auto-created</span>
</span><span id="StackedApp.backup_to_csv-824"><a href="#StackedApp.backup_to_csv-824"><span class="linenos">824</span></a>        <span class="c1"># TODO: make config setting for this, or prompt user?</span>
</span><span id="StackedApp.backup_to_csv-825"><a href="#StackedApp.backup_to_csv-825"><span class="linenos">825</span></a>        <span class="c1"># first do yes no messagebox asking user if they want to backup to csv</span>
</span><span id="StackedApp.backup_to_csv-826"><a href="#StackedApp.backup_to_csv-826"><span class="linenos">826</span></a>        <span class="c1"># make QMessageBox w/ok button</span>
</span><span id="StackedApp.backup_to_csv-827"><a href="#StackedApp.backup_to_csv-827"><span class="linenos">827</span></a>        <span class="n">popup</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
</span><span id="StackedApp.backup_to_csv-828"><a href="#StackedApp.backup_to_csv-828"><span class="linenos">828</span></a>        <span class="n">popup</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Backup to CSV?&quot;</span><span class="p">)</span>
</span><span id="StackedApp.backup_to_csv-829"><a href="#StackedApp.backup_to_csv-829"><span class="linenos">829</span></a>        <span class="n">popup</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="StackedApp.backup_to_csv-830"><a href="#StackedApp.backup_to_csv-830"><span class="linenos">830</span></a>        <span class="n">popup</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
</span><span id="StackedApp.backup_to_csv-831"><a href="#StackedApp.backup_to_csv-831"><span class="linenos">831</span></a>            <span class="s2">&quot;Would you like to backup the inventory table to a CSV file?&quot;</span><span class="p">)</span>
</span><span id="StackedApp.backup_to_csv-832"><a href="#StackedApp.backup_to_csv-832"><span class="linenos">832</span></a>        <span class="n">popup</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Question</span><span class="p">)</span>
</span><span id="StackedApp.backup_to_csv-833"><a href="#StackedApp.backup_to_csv-833"><span class="linenos">833</span></a>        <span class="n">popup</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">)</span>
</span><span id="StackedApp.backup_to_csv-834"><a href="#StackedApp.backup_to_csv-834"><span class="linenos">834</span></a>        <span class="k">for</span> <span class="n">button</span> <span class="ow">in</span> <span class="n">popup</span><span class="o">.</span><span class="n">buttons</span><span class="p">():</span>
</span><span id="StackedApp.backup_to_csv-835"><a href="#StackedApp.backup_to_csv-835"><span class="linenos">835</span></a>            <span class="n">button</span><span class="o">.</span><span class="n">setCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">PointingHandCursor</span><span class="p">)</span>
</span><span id="StackedApp.backup_to_csv-836"><a href="#StackedApp.backup_to_csv-836"><span class="linenos">836</span></a>        <span class="k">if</span> <span class="n">popup</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
</span><span id="StackedApp.backup_to_csv-837"><a href="#StackedApp.backup_to_csv-837"><span class="linenos">837</span></a>            <span class="c1"># filepath is returned from databackup - put it on Okpopup for user</span>
</span><span id="StackedApp.backup_to_csv-838"><a href="#StackedApp.backup_to_csv-838"><span class="linenos">838</span></a>            <span class="n">backup</span> <span class="o">=</span> <span class="n">DataBackup</span><span class="p">()</span>
</span><span id="StackedApp.backup_to_csv-839"><a href="#StackedApp.backup_to_csv-839"><span class="linenos">839</span></a>            <span class="n">relative_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">,</span> <span class="n">backup</span><span class="o">.</span><span class="n">csvname</span><span class="p">)</span>
</span><span id="StackedApp.backup_to_csv-840"><a href="#StackedApp.backup_to_csv-840"><span class="linenos">840</span></a>            <span class="c1"># show popup QMessageBox with filepath</span>
</span><span id="StackedApp.backup_to_csv-841"><a href="#StackedApp.backup_to_csv-841"><span class="linenos">841</span></a>            <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Backup file saved to: </span><span class="si">{</span><span class="n">relative_path</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StackedApp.backup_to_csv-842"><a href="#StackedApp.backup_to_csv-842"><span class="linenos">842</span></a>            <span class="c1"># if user needs popup notification, do that</span>
</span><span id="StackedApp.backup_to_csv-843"><a href="#StackedApp.backup_to_csv-843"><span class="linenos">843</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">notification</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mute</span><span class="p">):</span>
</span><span id="StackedApp.backup_to_csv-844"><a href="#StackedApp.backup_to_csv-844"><span class="linenos">844</span></a>
</span><span id="StackedApp.backup_to_csv-845"><a href="#StackedApp.backup_to_csv-845"><span class="linenos">845</span></a>                <span class="c1"># make QMessageBox w/ok button</span>
</span><span id="StackedApp.backup_to_csv-846"><a href="#StackedApp.backup_to_csv-846"><span class="linenos">846</span></a>                <span class="n">popup</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
</span><span id="StackedApp.backup_to_csv-847"><a href="#StackedApp.backup_to_csv-847"><span class="linenos">847</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Backup Complete&quot;</span><span class="p">)</span>
</span><span id="StackedApp.backup_to_csv-848"><a href="#StackedApp.backup_to_csv-848"><span class="linenos">848</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="StackedApp.backup_to_csv-849"><a href="#StackedApp.backup_to_csv-849"><span class="linenos">849</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</span><span id="StackedApp.backup_to_csv-850"><a href="#StackedApp.backup_to_csv-850"><span class="linenos">850</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span><span id="StackedApp.backup_to_csv-851"><a href="#StackedApp.backup_to_csv-851"><span class="linenos">851</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
</span><span id="StackedApp.backup_to_csv-852"><a href="#StackedApp.backup_to_csv-852"><span class="linenos">852</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span><span class="o">.</span><span class="n">setCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">PointingHandCursor</span><span class="p">)</span>
</span><span id="StackedApp.backup_to_csv-853"><a href="#StackedApp.backup_to_csv-853"><span class="linenos">853</span></a>                <span class="n">popup</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span><span id="StackedApp.backup_to_csv-854"><a href="#StackedApp.backup_to_csv-854"><span class="linenos">854</span></a>                <span class="c1"># log it</span>
</span><span id="StackedApp.backup_to_csv-855"><a href="#StackedApp.backup_to_csv-855"><span class="linenos">855</span></a>                <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;BACKUP TO CSV&quot;</span><span class="p">,</span>
</span><span id="StackedApp.backup_to_csv-856"><a href="#StackedApp.backup_to_csv-856"><span class="linenos">856</span></a>                          <span class="n">comment</span><span class="o">=</span><span class="n">message</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>backup_to_csv first prompts the user with a yes/no popup asking if they'd like to backup the inventory table to a csv file. If yes, then the table is backed up to a csv file in the <b>output folder.</b></p>

<p>If the user hasn't muted the app's notifications, then a notification is sent to the system tray with the filename. CSV filenames are auto-generated with the date and time appended to the end.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>notification (bool, optional):</strong>  _description_. Defaults to True.</li>
</ul>
</div>


                            </div>
                            <div id="StackedApp.build_qcompleters" class="classattr">
                                        <input id="StackedApp.build_qcompleters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">build_qcompleters</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">tuple</span>:</span></span>

                <label class="view-source-button" for="StackedApp.build_qcompleters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.build_qcompleters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.build_qcompleters-860"><a href="#StackedApp.build_qcompleters-860"><span class="linenos">860</span></a>    <span class="k">def</span> <span class="nf">build_qcompleters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="StackedApp.build_qcompleters-861"><a href="#StackedApp.build_qcompleters-861"><span class="linenos">861</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.build_qcompleters-862"><a href="#StackedApp.build_qcompleters-862"><span class="linenos">862</span></a><span class="sd">        build_qcompleters builds the two QCompleters used by the app. As of 5/6/23, this version of the app only uses the models completer. The codes completer is not used.</span>
</span><span id="StackedApp.build_qcompleters-863"><a href="#StackedApp.build_qcompleters-863"><span class="linenos">863</span></a>
</span><span id="StackedApp.build_qcompleters-864"><a href="#StackedApp.build_qcompleters-864"><span class="linenos">864</span></a><span class="sd">        The codes completer could be used to add an extra way of searching to the home page. There could be a couple of buttons to the left of the textbox where the user can choose to search by model or by code. The code completer would be used if the user chooses to search by code.</span>
</span><span id="StackedApp.build_qcompleters-865"><a href="#StackedApp.build_qcompleters-865"><span class="linenos">865</span></a>
</span><span id="StackedApp.build_qcompleters-866"><a href="#StackedApp.build_qcompleters-866"><span class="linenos">866</span></a><span class="sd">        Returns:</span>
</span><span id="StackedApp.build_qcompleters-867"><a href="#StackedApp.build_qcompleters-867"><span class="linenos">867</span></a><span class="sd">            tuple: returns a tuple containing the two QCompleters</span>
</span><span id="StackedApp.build_qcompleters-868"><a href="#StackedApp.build_qcompleters-868"><span class="linenos">868</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.build_qcompleters-869"><a href="#StackedApp.build_qcompleters-869"><span class="linenos">869</span></a>        <span class="c1"># built the printer model qcompleter to be used in the search bar on home window (possibly other locations)</span>
</span><span id="StackedApp.build_qcompleters-870"><a href="#StackedApp.build_qcompleters-870"><span class="linenos">870</span></a>        <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="StackedApp.build_qcompleters-871"><a href="#StackedApp.build_qcompleters-871"><span class="linenos">871</span></a>            <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="StackedApp.build_qcompleters-872"><a href="#StackedApp.build_qcompleters-872"><span class="linenos">872</span></a>            <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="StackedApp.build_qcompleters-873"><a href="#StackedApp.build_qcompleters-873"><span class="linenos">873</span></a>            <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="StackedApp.build_qcompleters-874"><a href="#StackedApp.build_qcompleters-874"><span class="linenos">874</span></a>            <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="StackedApp.build_qcompleters-875"><a href="#StackedApp.build_qcompleters-875"><span class="linenos">875</span></a>            <span class="n">dicttrue</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="StackedApp.build_qcompleters-876"><a href="#StackedApp.build_qcompleters-876"><span class="linenos">876</span></a>        <span class="p">)</span>
</span><span id="StackedApp.build_qcompleters-877"><a href="#StackedApp.build_qcompleters-877"><span class="linenos">877</span></a>        <span class="c1"># -- LIST OF ALL PRINTER MODELS FROM THE &#39;PRINTERS&#39; COLUMN IN THE DATABASE --</span>
</span><span id="StackedApp.build_qcompleters-878"><a href="#StackedApp.build_qcompleters-878"><span class="linenos">878</span></a>        <span class="n">models_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StackedApp.build_qcompleters-879"><a href="#StackedApp.build_qcompleters-879"><span class="linenos">879</span></a>        <span class="c1"># -- LIST OF ALL TONER/ITEM CODES FROM THE &#39;CODE&#39; COLUMN IN THE DATABASE --</span>
</span><span id="StackedApp.build_qcompleters-880"><a href="#StackedApp.build_qcompleters-880"><span class="linenos">880</span></a>        <span class="n">codes_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StackedApp.build_qcompleters-881"><a href="#StackedApp.build_qcompleters-881"><span class="linenos">881</span></a>
</span><span id="StackedApp.build_qcompleters-882"><a href="#StackedApp.build_qcompleters-882"><span class="linenos">882</span></a>        <span class="c1"># dictionary to hold lists of each manufacturer&#39;s printer models (to be used in the suggestion listbox part of the autocomplete Entry)</span>
</span><span id="StackedApp.build_qcompleters-883"><a href="#StackedApp.build_qcompleters-883"><span class="linenos">883</span></a>        <span class="n">printer_models</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StackedApp.build_qcompleters-884"><a href="#StackedApp.build_qcompleters-884"><span class="linenos">884</span></a>            <span class="s2">&quot;dell&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="StackedApp.build_qcompleters-885"><a href="#StackedApp.build_qcompleters-885"><span class="linenos">885</span></a>            <span class="s2">&quot;hp&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="StackedApp.build_qcompleters-886"><a href="#StackedApp.build_qcompleters-886"><span class="linenos">886</span></a>            <span class="s2">&quot;lexmark&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="StackedApp.build_qcompleters-887"><a href="#StackedApp.build_qcompleters-887"><span class="linenos">887</span></a>            <span class="c1"># brother, canon, epson don&#39;t have enough printers to need a table to themselves so they&#39;re combined, might change the text on the actual button to say brother,canon,epson though</span>
</span><span id="StackedApp.build_qcompleters-888"><a href="#StackedApp.build_qcompleters-888"><span class="linenos">888</span></a>            <span class="s2">&quot;others&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="StackedApp.build_qcompleters-889"><a href="#StackedApp.build_qcompleters-889"><span class="linenos">889</span></a>        <span class="p">}</span>
</span><span id="StackedApp.build_qcompleters-890"><a href="#StackedApp.build_qcompleters-890"><span class="linenos">890</span></a>        <span class="n">prevlist</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="StackedApp.build_qcompleters-891"><a href="#StackedApp.build_qcompleters-891"><span class="linenos">891</span></a>        <span class="c1"># cycle thru each of the keys in the above dictionary</span>
</span><span id="StackedApp.build_qcompleters-892"><a href="#StackedApp.build_qcompleters-892"><span class="linenos">892</span></a>        <span class="k">for</span> <span class="n">brand</span> <span class="ow">in</span> <span class="n">printer_models</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="StackedApp.build_qcompleters-893"><a href="#StackedApp.build_qcompleters-893"><span class="linenos">893</span></a>            <span class="k">if</span> <span class="n">brand</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;dell&quot;</span><span class="p">,</span> <span class="s2">&quot;hp&quot;</span><span class="p">,</span> <span class="s2">&quot;lexmark&quot;</span><span class="p">]:</span>
</span><span id="StackedApp.build_qcompleters-894"><a href="#StackedApp.build_qcompleters-894"><span class="linenos">894</span></a>                <span class="c1"># set query to select the &#39;printers&#39; column from each brand&#39;s table (there are three brand tables in the database - dell, hp, lexmark)</span>
</span><span id="StackedApp.build_qcompleters-895"><a href="#StackedApp.build_qcompleters-895"><span class="linenos">895</span></a>                <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT printers, code, brand FROM inventory WHERE brand=</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">brand</span><span class="si">}</span><span class="se">\&#39;</span><span class="s2">&quot;</span>
</span><span id="StackedApp.build_qcompleters-896"><a href="#StackedApp.build_qcompleters-896"><span class="linenos">896</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.build_qcompleters-897"><a href="#StackedApp.build_qcompleters-897"><span class="linenos">897</span></a>                <span class="c1"># set query to select the &#39;printers&#39; column from each brand&#39;s table (there are three brand tables in the database - dell, hp, lexmark)</span>
</span><span id="StackedApp.build_qcompleters-898"><a href="#StackedApp.build_qcompleters-898"><span class="linenos">898</span></a>                <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT printers, code, brand FROM inventory WHERE brand NOT IN (&#39;dell&#39;, &#39;lexmark&#39;, &#39;hp&#39;)&quot;</span>
</span><span id="StackedApp.build_qcompleters-899"><a href="#StackedApp.build_qcompleters-899"><span class="linenos">899</span></a>
</span><span id="StackedApp.build_qcompleters-900"><a href="#StackedApp.build_qcompleters-900"><span class="linenos">900</span></a>            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="StackedApp.build_qcompleters-901"><a href="#StackedApp.build_qcompleters-901"><span class="linenos">901</span></a>            <span class="c1"># temp_list will be all resulting rows from the query</span>
</span><span id="StackedApp.build_qcompleters-902"><a href="#StackedApp.build_qcompleters-902"><span class="linenos">902</span></a>            <span class="n">temp_list</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span><span id="StackedApp.build_qcompleters-903"><a href="#StackedApp.build_qcompleters-903"><span class="linenos">903</span></a>
</span><span id="StackedApp.build_qcompleters-904"><a href="#StackedApp.build_qcompleters-904"><span class="linenos">904</span></a>            <span class="c1"># keys will be the  upc, with lists containing code and stock as values</span>
</span><span id="StackedApp.build_qcompleters-905"><a href="#StackedApp.build_qcompleters-905"><span class="linenos">905</span></a>
</span><span id="StackedApp.build_qcompleters-906"><a href="#StackedApp.build_qcompleters-906"><span class="linenos">906</span></a>            <span class="c1"># start cycling through each of the rows in the result, each row is a row of the &#39;printers&#39; column from the database tables</span>
</span><span id="StackedApp.build_qcompleters-907"><a href="#StackedApp.build_qcompleters-907"><span class="linenos">907</span></a>            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">temp_list</span><span class="p">:</span>
</span><span id="StackedApp.build_qcompleters-908"><a href="#StackedApp.build_qcompleters-908"><span class="linenos">908</span></a>                <span class="n">manufacturer</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="StackedApp.build_qcompleters-909"><a href="#StackedApp.build_qcompleters-909"><span class="linenos">909</span></a>                <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StackedApp.build_qcompleters-910"><a href="#StackedApp.build_qcompleters-910"><span class="linenos">910</span></a>                    <span class="n">sublist</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="StackedApp.build_qcompleters-911"><a href="#StackedApp.build_qcompleters-911"><span class="linenos">911</span></a>                    <span class="k">if</span> <span class="n">sublist</span> <span class="o">==</span> <span class="n">prevlist</span><span class="p">:</span>
</span><span id="StackedApp.build_qcompleters-912"><a href="#StackedApp.build_qcompleters-912"><span class="linenos">912</span></a>                        <span class="k">pass</span>
</span><span id="StackedApp.build_qcompleters-913"><a href="#StackedApp.build_qcompleters-913"><span class="linenos">913</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.build_qcompleters-914"><a href="#StackedApp.build_qcompleters-914"><span class="linenos">914</span></a>                        <span class="c1"># for each printer model in this list that we just created (sublist)</span>
</span><span id="StackedApp.build_qcompleters-915"><a href="#StackedApp.build_qcompleters-915"><span class="linenos">915</span></a>                        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">:</span>
</span><span id="StackedApp.build_qcompleters-916"><a href="#StackedApp.build_qcompleters-916"><span class="linenos">916</span></a>                            <span class="c1"># strip any whitespace</span>
</span><span id="StackedApp.build_qcompleters-917"><a href="#StackedApp.build_qcompleters-917"><span class="linenos">917</span></a>                            <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="StackedApp.build_qcompleters-918"><a href="#StackedApp.build_qcompleters-918"><span class="linenos">918</span></a>                            <span class="c1"># check if the model is already in the list and append it if it isn&#39;t</span>
</span><span id="StackedApp.build_qcompleters-919"><a href="#StackedApp.build_qcompleters-919"><span class="linenos">919</span></a>                            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">printer_models</span><span class="p">[</span><span class="n">brand</span><span class="p">]:</span>
</span><span id="StackedApp.build_qcompleters-920"><a href="#StackedApp.build_qcompleters-920"><span class="linenos">920</span></a>                                <span class="n">printer_models</span><span class="p">[</span><span class="n">brand</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="StackedApp.build_qcompleters-921"><a href="#StackedApp.build_qcompleters-921"><span class="linenos">921</span></a>                                    <span class="n">model</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="StackedApp.build_qcompleters-922"><a href="#StackedApp.build_qcompleters-922"><span class="linenos">922</span></a>
</span><span id="StackedApp.build_qcompleters-923"><a href="#StackedApp.build_qcompleters-923"><span class="linenos">923</span></a>                        <span class="c1"># for key in self.manufacturer_btns.keys():</span>
</span><span id="StackedApp.build_qcompleters-924"><a href="#StackedApp.build_qcompleters-924"><span class="linenos">924</span></a>                        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">printer_models</span><span class="p">[</span><span class="n">brand</span><span class="p">]:</span>
</span><span id="StackedApp.build_qcompleters-925"><a href="#StackedApp.build_qcompleters-925"><span class="linenos">925</span></a>                            <span class="c1"># key is the manufacturer name, model is the printer model</span>
</span><span id="StackedApp.build_qcompleters-926"><a href="#StackedApp.build_qcompleters-926"><span class="linenos">926</span></a>                            <span class="n">models_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">manufacturer</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="StackedApp.build_qcompleters-927"><a href="#StackedApp.build_qcompleters-927"><span class="linenos">927</span></a>                <span class="c1"># code gets here if the query returns no results / rows</span>
</span><span id="StackedApp.build_qcompleters-928"><a href="#StackedApp.build_qcompleters-928"><span class="linenos">928</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.build_qcompleters-929"><a href="#StackedApp.build_qcompleters-929"><span class="linenos">929</span></a>                    <span class="k">pass</span>
</span><span id="StackedApp.build_qcompleters-930"><a href="#StackedApp.build_qcompleters-930"><span class="linenos">930</span></a>                <span class="n">codes_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">temp_list</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="StackedApp.build_qcompleters-931"><a href="#StackedApp.build_qcompleters-931"><span class="linenos">931</span></a>        <span class="n">codes_list</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">codes_list</span><span class="p">)</span>
</span><span id="StackedApp.build_qcompleters-932"><a href="#StackedApp.build_qcompleters-932"><span class="linenos">932</span></a>        <span class="c1"># if the above loops are fixed - wont have to use this way to get unique values in list</span>
</span><span id="StackedApp.build_qcompleters-933"><a href="#StackedApp.build_qcompleters-933"><span class="linenos">933</span></a>        <span class="n">models_list</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">models_list</span><span class="p">)</span>
</span><span id="StackedApp.build_qcompleters-934"><a href="#StackedApp.build_qcompleters-934"><span class="linenos">934</span></a>        <span class="n">models_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">models_list</span><span class="p">)</span>
</span><span id="StackedApp.build_qcompleters-935"><a href="#StackedApp.build_qcompleters-935"><span class="linenos">935</span></a>        <span class="c1"># close connection to database</span>
</span><span id="StackedApp.build_qcompleters-936"><a href="#StackedApp.build_qcompleters-936"><span class="linenos">936</span></a>        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp.build_qcompleters-937"><a href="#StackedApp.build_qcompleters-937"><span class="linenos">937</span></a>        <span class="c1"># make a QCompleter for the auto-suggestion textbox so it will suggest printer model names as you type</span>
</span><span id="StackedApp.build_qcompleters-938"><a href="#StackedApp.build_qcompleters-938"><span class="linenos">938</span></a>        <span class="n">models_completer</span> <span class="o">=</span> <span class="n">QCompleter</span><span class="p">(</span><span class="n">models_list</span><span class="p">)</span>
</span><span id="StackedApp.build_qcompleters-939"><a href="#StackedApp.build_qcompleters-939"><span class="linenos">939</span></a>        <span class="n">codes_completer</span> <span class="o">=</span> <span class="n">QCompleter</span><span class="p">(</span><span class="n">codes_list</span><span class="p">)</span>
</span><span id="StackedApp.build_qcompleters-940"><a href="#StackedApp.build_qcompleters-940"><span class="linenos">940</span></a>        <span class="c1"># make it case insensitive</span>
</span><span id="StackedApp.build_qcompleters-941"><a href="#StackedApp.build_qcompleters-941"><span class="linenos">941</span></a>        <span class="n">models_completer</span><span class="o">.</span><span class="n">setCaseSensitivity</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">CaseInsensitive</span><span class="p">)</span>
</span><span id="StackedApp.build_qcompleters-942"><a href="#StackedApp.build_qcompleters-942"><span class="linenos">942</span></a>        <span class="n">codes_completer</span><span class="o">.</span><span class="n">setCaseSensitivity</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">CaseInsensitive</span><span class="p">)</span>
</span><span id="StackedApp.build_qcompleters-943"><a href="#StackedApp.build_qcompleters-943"><span class="linenos">943</span></a>
</span><span id="StackedApp.build_qcompleters-944"><a href="#StackedApp.build_qcompleters-944"><span class="linenos">944</span></a>        <span class="k">return</span> <span class="n">models_completer</span><span class="p">,</span> <span class="n">codes_completer</span>
</span></pre></div>


            <div class="docstring"><p>build_qcompleters builds the two QCompleters used by the app. As of 5/6/23, this version of the app only uses the models completer. The codes completer is not used.</p>

<p>The codes completer could be used to add an extra way of searching to the home page. There could be a couple of buttons to the left of the textbox where the user can choose to search by model or by code. The code completer would be used if the user chooses to search by code.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>tuple: returns a tuple containing the two QCompleters</p>
</blockquote>
</div>


                            </div>
                            <div id="StackedApp.build_tray" class="classattr">
                                        <input id="StackedApp.build_tray-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">build_tray</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">tuple</span>:</span></span>

                <label class="view-source-button" for="StackedApp.build_tray-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.build_tray"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.build_tray-946"><a href="#StackedApp.build_tray-946"><span class="linenos">946</span></a>    <span class="k">def</span> <span class="nf">build_tray</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="StackedApp.build_tray-947"><a href="#StackedApp.build_tray-947"><span class="linenos">947</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.build_tray-948"><a href="#StackedApp.build_tray-948"><span class="linenos">948</span></a><span class="sd">        build_tray build_tray_menu builds the tray menu and adds the context menu and actions to it. It uses the icon from config.yaml, like alot of the popups and other things in the app.</span>
</span><span id="StackedApp.build_tray-949"><a href="#StackedApp.build_tray-949"><span class="linenos">949</span></a>
</span><span id="StackedApp.build_tray-950"><a href="#StackedApp.build_tray-950"><span class="linenos">950</span></a><span class="sd">        Clicking on the tray icon doesn&#39;t seem to work in Windows 11, and the tray icon exhibits other wierd behaviors. Note --&gt; try it out in Windows 10 to get confirmation that it works there.</span>
</span><span id="StackedApp.build_tray-951"><a href="#StackedApp.build_tray-951"><span class="linenos">951</span></a>
</span><span id="StackedApp.build_tray-952"><a href="#StackedApp.build_tray-952"><span class="linenos">952</span></a><span class="sd">        Returns:</span>
</span><span id="StackedApp.build_tray-953"><a href="#StackedApp.build_tray-953"><span class="linenos">953</span></a><span class="sd">            tuple: returns a tuple containg the QSystemTrayIcon and the QMenu that&#39;s attached to it.</span>
</span><span id="StackedApp.build_tray-954"><a href="#StackedApp.build_tray-954"><span class="linenos">954</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.build_tray-955"><a href="#StackedApp.build_tray-955"><span class="linenos">955</span></a>        <span class="n">tray_icon</span> <span class="o">=</span> <span class="n">QSystemTrayIcon</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.build_tray-956"><a href="#StackedApp.build_tray-956"><span class="linenos">956</span></a>        <span class="n">tray_icon</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="StackedApp.build_tray-957"><a href="#StackedApp.build_tray-957"><span class="linenos">957</span></a>        <span class="n">tray_icon</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">app_name</span><span class="p">)</span>
</span><span id="StackedApp.build_tray-958"><a href="#StackedApp.build_tray-958"><span class="linenos">958</span></a>
</span><span id="StackedApp.build_tray-959"><a href="#StackedApp.build_tray-959"><span class="linenos">959</span></a>        <span class="c1"># create the tray menu</span>
</span><span id="StackedApp.build_tray-960"><a href="#StackedApp.build_tray-960"><span class="linenos">960</span></a>        <span class="n">tray_menu</span> <span class="o">=</span> <span class="n">QMenu</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.build_tray-961"><a href="#StackedApp.build_tray-961"><span class="linenos">961</span></a>        <span class="n">tray_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s2">&quot;About&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_help_dialog</span><span class="p">)</span>
</span><span id="StackedApp.build_tray-962"><a href="#StackedApp.build_tray-962"><span class="linenos">962</span></a>        <span class="n">tray_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s2">&quot;Exit&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
</span><span id="StackedApp.build_tray-963"><a href="#StackedApp.build_tray-963"><span class="linenos">963</span></a>        <span class="n">tray_icon</span><span class="o">.</span><span class="n">setContextMenu</span><span class="p">(</span><span class="n">tray_menu</span><span class="p">)</span>
</span><span id="StackedApp.build_tray-964"><a href="#StackedApp.build_tray-964"><span class="linenos">964</span></a>        <span class="k">return</span> <span class="n">tray_icon</span><span class="p">,</span> <span class="n">tray_menu</span>
</span></pre></div>


            <div class="docstring"><p>build_tray build_tray_menu builds the tray menu and adds the context menu and actions to it. It uses the icon from config.yaml, like alot of the popups and other things in the app.</p>

<p>Clicking on the tray icon doesn't seem to work in Windows 11, and the tray icon exhibits other wierd behaviors. Note --> try it out in Windows 10 to get confirmation that it works there.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>tuple: returns a tuple containg the QSystemTrayIcon and the QMenu that's attached to it.</p>
</blockquote>
</div>


                            </div>
                            <div id="StackedApp.gen_notification" class="classattr">
                                        <input id="StackedApp.gen_notification-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">gen_notification</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">title</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">message</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">notif_type</span><span class="p">:</span> <span class="n">PyQt5</span><span class="o">.</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSystemTrayIcon</span> <span class="o">=</span> <span class="mi">1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.gen_notification-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.gen_notification"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.gen_notification-966"><a href="#StackedApp.gen_notification-966"><span class="linenos">966</span></a>    <span class="k">def</span> <span class="nf">gen_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">notif_type</span><span class="p">:</span> <span class="n">QSystemTrayIcon</span> <span class="o">=</span> <span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">):</span>
</span><span id="StackedApp.gen_notification-967"><a href="#StackedApp.gen_notification-967"><span class="linenos">967</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.gen_notification-968"><a href="#StackedApp.gen_notification-968"><span class="linenos">968</span></a><span class="sd">        gen_notification generates a notification using the title and message provided. Notif_type is set to Information by default, but can be changed to Warning or Critical to change the icon that is displayed with the notification.</span>
</span><span id="StackedApp.gen_notification-969"><a href="#StackedApp.gen_notification-969"><span class="linenos">969</span></a>
</span><span id="StackedApp.gen_notification-970"><a href="#StackedApp.gen_notification-970"><span class="linenos">970</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp.gen_notification-971"><a href="#StackedApp.gen_notification-971"><span class="linenos">971</span></a><span class="sd">            title (str): the title of the system tray notification.</span>
</span><span id="StackedApp.gen_notification-972"><a href="#StackedApp.gen_notification-972"><span class="linenos">972</span></a><span class="sd">            message (str): the message body of the system tray notification.</span>
</span><span id="StackedApp.gen_notification-973"><a href="#StackedApp.gen_notification-973"><span class="linenos">973</span></a><span class="sd">            notif_type (QSystemTrayIcon, optional): the type of icon to be displayed with the system tray icon. Defaults to QSystemTrayIcon.Information.</span>
</span><span id="StackedApp.gen_notification-974"><a href="#StackedApp.gen_notification-974"><span class="linenos">974</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.gen_notification-975"><a href="#StackedApp.gen_notification-975"><span class="linenos">975</span></a>        <span class="c1"># if user has muted notifications, don&#39;t notify them</span>
</span><span id="StackedApp.gen_notification-976"><a href="#StackedApp.gen_notification-976"><span class="linenos">976</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mute</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="StackedApp.gen_notification-977"><a href="#StackedApp.gen_notification-977"><span class="linenos">977</span></a>            <span class="k">return</span>
</span><span id="StackedApp.gen_notification-978"><a href="#StackedApp.gen_notification-978"><span class="linenos">978</span></a>        <span class="c1"># create a notification</span>
</span><span id="StackedApp.gen_notification-979"><a href="#StackedApp.gen_notification-979"><span class="linenos">979</span></a>        <span class="n">notification</span> <span class="o">=</span> <span class="n">QSystemTrayIcon</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.gen_notification-980"><a href="#StackedApp.gen_notification-980"><span class="linenos">980</span></a>        <span class="n">notification</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="StackedApp.gen_notification-981"><a href="#StackedApp.gen_notification-981"><span class="linenos">981</span></a>        <span class="n">notification</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="StackedApp.gen_notification-982"><a href="#StackedApp.gen_notification-982"><span class="linenos">982</span></a>        <span class="n">notification</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">notif_type</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>gen_notification generates a notification using the title and message provided. Notif_type is set to Information by default, but can be changed to Warning or Critical to change the icon that is displayed with the notification.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>title (str):</strong>  the title of the system tray notification.</li>
<li><strong>message (str):</strong>  the message body of the system tray notification.</li>
<li><strong>notif_type (QSystemTrayIcon, optional):</strong>  the type of icon to be displayed with the system tray icon. Defaults to QSystemTrayIcon.Information.</li>
</ul>
</div>


                            </div>
                            <div id="StackedApp.change_table_columns" class="classattr">
                                        <input id="StackedApp.change_table_columns-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">change_table_columns</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.change_table_columns-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.change_table_columns"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.change_table_columns-984"><a href="#StackedApp.change_table_columns-984"><span class="linenos"> 984</span></a>    <span class="k">def</span> <span class="nf">change_table_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp.change_table_columns-985"><a href="#StackedApp.change_table_columns-985"><span class="linenos"> 985</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.change_table_columns-986"><a href="#StackedApp.change_table_columns-986"><span class="linenos"> 986</span></a><span class="sd">        change_table_columns user can add or remove columns from the table that is currently being shown, using a popup that appears.</span>
</span><span id="StackedApp.change_table_columns-987"><a href="#StackedApp.change_table_columns-987"><span class="linenos"> 987</span></a>
</span><span id="StackedApp.change_table_columns-988"><a href="#StackedApp.change_table_columns-988"><span class="linenos"> 988</span></a><span class="sd">        If a table isn&#39;t currently being shown, nothing will happen.</span>
</span><span id="StackedApp.change_table_columns-989"><a href="#StackedApp.change_table_columns-989"><span class="linenos"> 989</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.change_table_columns-990"><a href="#StackedApp.change_table_columns-990"><span class="linenos"> 990</span></a>        <span class="c1"># the model attribute is created when a spreadsheet is shown</span>
</span><span id="StackedApp.change_table_columns-991"><a href="#StackedApp.change_table_columns-991"><span class="linenos"> 991</span></a>        <span class="n">initialize_config</span><span class="p">(</span>
</span><span id="StackedApp.change_table_columns-992"><a href="#StackedApp.change_table_columns-992"><span class="linenos"> 992</span></a>            <span class="bp">self</span>
</span><span id="StackedApp.change_table_columns-993"><a href="#StackedApp.change_table_columns-993"><span class="linenos"> 993</span></a>        <span class="p">)</span>  <span class="c1"># reread the config to get the selected column names, they might be new since start of app</span>
</span><span id="StackedApp.change_table_columns-994"><a href="#StackedApp.change_table_columns-994"><span class="linenos"> 994</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="StackedApp.change_table_columns-995"><a href="#StackedApp.change_table_columns-995"><span class="linenos"> 995</span></a>            <span class="c1"># get used columns from the config</span>
</span><span id="StackedApp.change_table_columns-996"><a href="#StackedApp.change_table_columns-996"><span class="linenos"> 996</span></a>            <span class="n">selected_columns</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StackedApp.change_table_columns-997"><a href="#StackedApp.change_table_columns-997"><span class="linenos"> 997</span></a>            <span class="c1"># self.selected_columns is set in initialize_config</span>
</span><span id="StackedApp.change_table_columns-998"><a href="#StackedApp.change_table_columns-998"><span class="linenos"> 998</span></a>            <span class="n">used_column_names</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="StackedApp.change_table_columns-999"><a href="#StackedApp.change_table_columns-999"><span class="linenos"> 999</span></a>                <span class="n">column_name</span> <span class="k">for</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_columns</span><span class="p">]</span>
</span><span id="StackedApp.change_table_columns-1000"><a href="#StackedApp.change_table_columns-1000"><span class="linenos">1000</span></a>            <span class="n">unused_columms</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="StackedApp.change_table_columns-1001"><a href="#StackedApp.change_table_columns-1001"><span class="linenos">1001</span></a>            <span class="c1"># get indices of columns</span>
</span><span id="StackedApp.change_table_columns-1002"><a href="#StackedApp.change_table_columns-1002"><span class="linenos">1002</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StackedApp.change_table_columns-1003"><a href="#StackedApp.change_table_columns-1003"><span class="linenos">1003</span></a>                <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">used_column_names</span><span class="p">:</span>
</span><span id="StackedApp.change_table_columns-1004"><a href="#StackedApp.change_table_columns-1004"><span class="linenos">1004</span></a>                    <span class="c1"># selected_columns[selected_columns.index(value)] = index</span>
</span><span id="StackedApp.change_table_columns-1005"><a href="#StackedApp.change_table_columns-1005"><span class="linenos">1005</span></a>                    <span class="n">selected_columns</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)])</span>
</span><span id="StackedApp.change_table_columns-1006"><a href="#StackedApp.change_table_columns-1006"><span class="linenos">1006</span></a>                    <span class="c1"># selected_columns.replace(value[0], index)</span>
</span><span id="StackedApp.change_table_columns-1007"><a href="#StackedApp.change_table_columns-1007"><span class="linenos">1007</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.change_table_columns-1008"><a href="#StackedApp.change_table_columns-1008"><span class="linenos">1008</span></a>                    <span class="n">unused_columms</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)])</span>
</span><span id="StackedApp.change_table_columns-1009"><a href="#StackedApp.change_table_columns-1009"><span class="linenos">1009</span></a>
</span><span id="StackedApp.change_table_columns-1010"><a href="#StackedApp.change_table_columns-1010"><span class="linenos">1010</span></a>            <span class="n">header_list</span> <span class="o">=</span> <span class="n">selected_columns</span>
</span><span id="StackedApp.change_table_columns-1011"><a href="#StackedApp.change_table_columns-1011"><span class="linenos">1011</span></a>            <span class="n">unused_header_list</span> <span class="o">=</span> <span class="n">unused_columms</span>
</span><span id="StackedApp.change_table_columns-1012"><a href="#StackedApp.change_table_columns-1012"><span class="linenos">1012</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="StackedApp.change_table_columns-1013"><a href="#StackedApp.change_table_columns-1013"><span class="linenos">1013</span></a>                <span class="n">dialog</span> <span class="o">=</span> <span class="n">ColumnEdit</span><span class="p">(</span>
</span><span id="StackedApp.change_table_columns-1014"><a href="#StackedApp.change_table_columns-1014"><span class="linenos">1014</span></a>                    <span class="n">header_list</span><span class="p">,</span> <span class="n">unused_header_list</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.change_table_columns-1015"><a href="#StackedApp.change_table_columns-1015"><span class="linenos">1015</span></a>
</span><span id="StackedApp.change_table_columns-1016"><a href="#StackedApp.change_table_columns-1016"><span class="linenos">1016</span></a>                <span class="k">if</span> <span class="n">dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
</span><span id="StackedApp.change_table_columns-1017"><a href="#StackedApp.change_table_columns-1017"><span class="linenos">1017</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">table_columns</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">get_values</span><span class="p">()</span>
</span><span id="StackedApp.change_table_columns-1018"><a href="#StackedApp.change_table_columns-1018"><span class="linenos">1018</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">table_layout</span><span class="o">.</span><span class="n">set_table_model</span><span class="p">()</span>
</span><span id="StackedApp.change_table_columns-1019"><a href="#StackedApp.change_table_columns-1019"><span class="linenos">1019</span></a>                    <span class="n">dialog</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp.change_table_columns-1020"><a href="#StackedApp.change_table_columns-1020"><span class="linenos">1020</span></a>            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="StackedApp.change_table_columns-1021"><a href="#StackedApp.change_table_columns-1021"><span class="linenos">1021</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp.change_table_columns-1022"><a href="#StackedApp.change_table_columns-1022"><span class="linenos">1022</span></a>                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Wasn&#39;t able to open the column choices dialog.&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
</span><span id="StackedApp.change_table_columns-1023"><a href="#StackedApp.change_table_columns-1023"><span class="linenos">1023</span></a>
</span><span id="StackedApp.change_table_columns-1024"><a href="#StackedApp.change_table_columns-1024"><span class="linenos">1024</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.change_table_columns-1025"><a href="#StackedApp.change_table_columns-1025"><span class="linenos">1025</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp.change_table_columns-1026"><a href="#StackedApp.change_table_columns-1026"><span class="linenos">1026</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Cannot open dialog:&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No table is currently visible.&quot;</span><span class="p">,</span> <span class="n">notif_type</span><span class="o">=</span><span class="n">QSystemTrayIcon</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>change_table_columns user can add or remove columns from the table that is currently being shown, using a popup that appears.</p>

<p>If a table isn't currently being shown, nothing will happen.</p>
</div>


                            </div>
                            <div id="StackedApp.change_icon_colors" class="classattr">
                                        <input id="StackedApp.change_icon_colors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">change_icon_colors</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.change_icon_colors-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.change_icon_colors"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.change_icon_colors-1028"><a href="#StackedApp.change_icon_colors-1028"><span class="linenos">1028</span></a>    <span class="k">def</span> <span class="nf">change_icon_colors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp.change_icon_colors-1029"><a href="#StackedApp.change_icon_colors-1029"><span class="linenos">1029</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.change_icon_colors-1030"><a href="#StackedApp.change_icon_colors-1030"><span class="linenos">1030</span></a><span class="sd">        change_icon_colors cycles through the qtawesome icons used in the app (like the ones used in the main menubar) and changes their color to white or black, depending on the theme that is currently being used.</span>
</span><span id="StackedApp.change_icon_colors-1031"><a href="#StackedApp.change_icon_colors-1031"><span class="linenos">1031</span></a>
</span><span id="StackedApp.change_icon_colors-1032"><a href="#StackedApp.change_icon_colors-1032"><span class="linenos">1032</span></a><span class="sd">        &lt;b&gt;Themes are divided into dark and light theme groups in the utils.toner_utils initialize_config module&lt;/b&gt;.</span>
</span><span id="StackedApp.change_icon_colors-1033"><a href="#StackedApp.change_icon_colors-1033"><span class="linenos">1033</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.change_icon_colors-1034"><a href="#StackedApp.change_icon_colors-1034"><span class="linenos">1034</span></a>        <span class="c1"># check the main application window&#39;s background color and see if  its dark or light</span>
</span><span id="StackedApp.change_icon_colors-1035"><a href="#StackedApp.change_icon_colors-1035"><span class="linenos">1035</span></a>        <span class="c1"># then  so set icon colors to near white</span>
</span><span id="StackedApp.change_icon_colors-1036"><a href="#StackedApp.change_icon_colors-1036"><span class="linenos">1036</span></a>        <span class="c1"># cycle through the main menubar actions and reset their icons</span>
</span><span id="StackedApp.change_icon_colors-1037"><a href="#StackedApp.change_icon_colors-1037"><span class="linenos">1037</span></a>        <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
</span><span id="StackedApp.change_icon_colors-1038"><a href="#StackedApp.change_icon_colors-1038"><span class="linenos">1038</span></a>            <span class="c1"># for each menu, iterate through its actions</span>
</span><span id="StackedApp.change_icon_colors-1039"><a href="#StackedApp.change_icon_colors-1039"><span class="linenos">1039</span></a>            <span class="k">for</span> <span class="n">subaction</span> <span class="ow">in</span> <span class="n">action</span><span class="o">.</span><span class="n">menu</span><span class="p">()</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
</span><span id="StackedApp.change_icon_colors-1040"><a href="#StackedApp.change_icon_colors-1040"><span class="linenos">1040</span></a>                <span class="c1"># get the text from the action</span>
</span><span id="StackedApp.change_icon_colors-1041"><a href="#StackedApp.change_icon_colors-1041"><span class="linenos">1041</span></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">subaction</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span><span id="StackedApp.change_icon_colors-1042"><a href="#StackedApp.change_icon_colors-1042"><span class="linenos">1042</span></a>                <span class="c1"># check if any of the icon string keys are in the text from the action (for example, the key &quot;import&quot; will be in the action text &quot;Import UPC File&quot;)</span>
</span><span id="StackedApp.change_icon_colors-1043"><a href="#StackedApp.change_icon_colors-1043"><span class="linenos">1043</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">icon_strings</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="StackedApp.change_icon_colors-1044"><a href="#StackedApp.change_icon_colors-1044"><span class="linenos">1044</span></a>                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
</span><span id="StackedApp.change_icon_colors-1045"><a href="#StackedApp.change_icon_colors-1045"><span class="linenos">1045</span></a>                        <span class="c1"># check if its a dark or light theme</span>
</span><span id="StackedApp.change_icon_colors-1046"><a href="#StackedApp.change_icon_colors-1046"><span class="linenos">1046</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theme</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dark_themes</span><span class="p">:</span>
</span><span id="StackedApp.change_icon_colors-1047"><a href="#StackedApp.change_icon_colors-1047"><span class="linenos">1047</span></a>                            <span class="c1"># create qtawesome icon</span>
</span><span id="StackedApp.change_icon_colors-1048"><a href="#StackedApp.change_icon_colors-1048"><span class="linenos">1048</span></a>                            <span class="n">icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="StackedApp.change_icon_colors-1049"><a href="#StackedApp.change_icon_colors-1049"><span class="linenos">1049</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">icon_strings</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
</span><span id="StackedApp.change_icon_colors-1050"><a href="#StackedApp.change_icon_colors-1050"><span class="linenos">1050</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StackedApp.change_icon_colors-1051"><a href="#StackedApp.change_icon_colors-1051"><span class="linenos">1051</span></a>                            <span class="n">icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="StackedApp.change_icon_colors-1052"><a href="#StackedApp.change_icon_colors-1052"><span class="linenos">1052</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">icon_strings</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="StackedApp.change_icon_colors-1053"><a href="#StackedApp.change_icon_colors-1053"><span class="linenos">1053</span></a>                        <span class="c1"># set the icon</span>
</span><span id="StackedApp.change_icon_colors-1054"><a href="#StackedApp.change_icon_colors-1054"><span class="linenos">1054</span></a>                        <span class="n">subaction</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>change_icon_colors cycles through the qtawesome icons used in the app (like the ones used in the main menubar) and changes their color to white or black, depending on the theme that is currently being used.</p>

<p><b>Themes are divided into dark and light theme groups in the <a href="utils/toner_utils.html">utils.toner_utils</a> initialize_config module</b>.</p>
</div>


                            </div>
                            <div id="StackedApp.reset_database" class="classattr">
                                        <input id="StackedApp.reset_database-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">reset_database</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.reset_database-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.reset_database"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.reset_database-1056"><a href="#StackedApp.reset_database-1056"><span class="linenos">1056</span></a>    <span class="k">def</span> <span class="nf">reset_database</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp.reset_database-1057"><a href="#StackedApp.reset_database-1057"><span class="linenos">1057</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.reset_database-1058"><a href="#StackedApp.reset_database-1058"><span class="linenos">1058</span></a><span class="sd">        reset_database resets all stock values in the inventory table to 0 after double-checking with the user.</span>
</span><span id="StackedApp.reset_database-1059"><a href="#StackedApp.reset_database-1059"><span class="linenos">1059</span></a>
</span><span id="StackedApp.reset_database-1060"><a href="#StackedApp.reset_database-1060"><span class="linenos">1060</span></a><span class="sd">        The app will also perform a silent backup to csv before resetting the database.</span>
</span><span id="StackedApp.reset_database-1061"><a href="#StackedApp.reset_database-1061"><span class="linenos">1061</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.reset_database-1062"><a href="#StackedApp.reset_database-1062"><span class="linenos">1062</span></a>        <span class="c1"># check if the user is sure they want to reset the database</span>
</span><span id="StackedApp.reset_database-1063"><a href="#StackedApp.reset_database-1063"><span class="linenos">1063</span></a>        <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
</span><span id="StackedApp.reset_database-1064"><a href="#StackedApp.reset_database-1064"><span class="linenos">1064</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
</span><span id="StackedApp.reset_database-1065"><a href="#StackedApp.reset_database-1065"><span class="linenos">1065</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Are you sure you want to reset the database?&quot;</span><span class="p">)</span>
</span><span id="StackedApp.reset_database-1066"><a href="#StackedApp.reset_database-1066"><span class="linenos">1066</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Reset Database&quot;</span><span class="p">)</span>
</span><span id="StackedApp.reset_database-1067"><a href="#StackedApp.reset_database-1067"><span class="linenos">1067</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>
</span><span id="StackedApp.reset_database-1068"><a href="#StackedApp.reset_database-1068"><span class="linenos">1068</span></a>        <span class="n">msg</span><span class="o">.</span><span class="n">setDefaultButton</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>
</span><span id="StackedApp.reset_database-1069"><a href="#StackedApp.reset_database-1069"><span class="linenos">1069</span></a>        <span class="c1"># if the user clicks yes, reset the database</span>
</span><span id="StackedApp.reset_database-1070"><a href="#StackedApp.reset_database-1070"><span class="linenos">1070</span></a>        <span class="k">if</span> <span class="n">msg</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
</span><span id="StackedApp.reset_database-1071"><a href="#StackedApp.reset_database-1071"><span class="linenos">1071</span></a>
</span><span id="StackedApp.reset_database-1072"><a href="#StackedApp.reset_database-1072"><span class="linenos">1072</span></a>            <span class="c1"># update all stock in database to 0 after running backup.</span>
</span><span id="StackedApp.reset_database-1073"><a href="#StackedApp.reset_database-1073"><span class="linenos">1073</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">backup_to_csv</span><span class="p">(</span><span class="n">notification</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="StackedApp.reset_database-1074"><a href="#StackedApp.reset_database-1074"><span class="linenos">1074</span></a>            <span class="c1"># connect to database</span>
</span><span id="StackedApp.reset_database-1075"><a href="#StackedApp.reset_database-1075"><span class="linenos">1075</span></a>            <span class="n">db</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">connect_to_db</span><span class="p">(</span>
</span><span id="StackedApp.reset_database-1076"><a href="#StackedApp.reset_database-1076"><span class="linenos">1076</span></a>                <span class="n">db_host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbhost</span><span class="p">,</span>
</span><span id="StackedApp.reset_database-1077"><a href="#StackedApp.reset_database-1077"><span class="linenos">1077</span></a>                <span class="n">db_user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbuser</span><span class="p">,</span>
</span><span id="StackedApp.reset_database-1078"><a href="#StackedApp.reset_database-1078"><span class="linenos">1078</span></a>                <span class="n">db_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbname</span><span class="p">,</span>
</span><span id="StackedApp.reset_database-1079"><a href="#StackedApp.reset_database-1079"><span class="linenos">1079</span></a>                <span class="n">db_pass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbpass</span><span class="p">,</span>
</span><span id="StackedApp.reset_database-1080"><a href="#StackedApp.reset_database-1080"><span class="linenos">1080</span></a>                <span class="n">dicttrue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="StackedApp.reset_database-1081"><a href="#StackedApp.reset_database-1081"><span class="linenos">1081</span></a>            <span class="p">)</span>
</span><span id="StackedApp.reset_database-1082"><a href="#StackedApp.reset_database-1082"><span class="linenos">1082</span></a>            <span class="c1"># had to disable SAFE UPDATES in MySQL database to be able to do this query</span>
</span><span id="StackedApp.reset_database-1083"><a href="#StackedApp.reset_database-1083"><span class="linenos">1083</span></a>            <span class="n">update_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET stock = 0 WHERE 1=1&quot;</span>
</span><span id="StackedApp.reset_database-1084"><a href="#StackedApp.reset_database-1084"><span class="linenos">1084</span></a>            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">update_query</span><span class="p">)</span>
</span><span id="StackedApp.reset_database-1085"><a href="#StackedApp.reset_database-1085"><span class="linenos">1085</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="StackedApp.reset_database-1086"><a href="#StackedApp.reset_database-1086"><span class="linenos">1086</span></a>            <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp.reset_database-1087"><a href="#StackedApp.reset_database-1087"><span class="linenos">1087</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gen_notification</span><span class="p">(</span>
</span><span id="StackedApp.reset_database-1088"><a href="#StackedApp.reset_database-1088"><span class="linenos">1088</span></a>                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Database Reset&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Database has been reset.&quot;</span>
</span><span id="StackedApp.reset_database-1089"><a href="#StackedApp.reset_database-1089"><span class="linenos">1089</span></a>            <span class="p">)</span>
</span><span id="StackedApp.reset_database-1090"><a href="#StackedApp.reset_database-1090"><span class="linenos">1090</span></a>            <span class="c1"># log the reset</span>
</span><span id="StackedApp.reset_database-1091"><a href="#StackedApp.reset_database-1091"><span class="linenos">1091</span></a>            <span class="n">write_log</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;RESET DB&quot;</span><span class="p">,</span>
</span><span id="StackedApp.reset_database-1092"><a href="#StackedApp.reset_database-1092"><span class="linenos">1092</span></a>                      <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;Database was reset, all stock values set to 0.&quot;</span><span class="p">,</span> <span class="n">prt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>reset_database resets all stock values in the inventory table to 0 after double-checking with the user.</p>

<p>The app will also perform a silent backup to csv before resetting the database.</p>
</div>


                            </div>
                            <div id="StackedApp.check_for_duplicates_popup" class="classattr">
                                        <input id="StackedApp.check_for_duplicates_popup-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_for_duplicates_popup</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.check_for_duplicates_popup-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.check_for_duplicates_popup"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.check_for_duplicates_popup-1094"><a href="#StackedApp.check_for_duplicates_popup-1094"><span class="linenos">1094</span></a>    <span class="k">def</span> <span class="nf">check_for_duplicates_popup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StackedApp.check_for_duplicates_popup-1095"><a href="#StackedApp.check_for_duplicates_popup-1095"><span class="linenos">1095</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.check_for_duplicates_popup-1096"><a href="#StackedApp.check_for_duplicates_popup-1096"><span class="linenos">1096</span></a><span class="sd">        check_for_duplicates generate popup window that shows a combo box with all table columns in it and an ok button</span>
</span><span id="StackedApp.check_for_duplicates_popup-1097"><a href="#StackedApp.check_for_duplicates_popup-1097"><span class="linenos">1097</span></a>
</span><span id="StackedApp.check_for_duplicates_popup-1098"><a href="#StackedApp.check_for_duplicates_popup-1098"><span class="linenos">1098</span></a><span class="sd">        Oftentimes, items that have duplicate values will be ones that can be linked. For example, two separate toner items that amount to the same part number (same yield value, same color, etc.) but they have different UPCs. By default, the app will separate these items into two different ones, but through the use of this function and &#39;linking the items&#39;, the user can choose to have the two items show up as one.</span>
</span><span id="StackedApp.check_for_duplicates_popup-1099"><a href="#StackedApp.check_for_duplicates_popup-1099"><span class="linenos">1099</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.check_for_duplicates_popup-1100"><a href="#StackedApp.check_for_duplicates_popup-1100"><span class="linenos">1100</span></a>        <span class="c1"># get the column names from the config</span>
</span><span id="StackedApp.check_for_duplicates_popup-1101"><a href="#StackedApp.check_for_duplicates_popup-1101"><span class="linenos">1101</span></a>        <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="StackedApp.check_for_duplicates_popup-1102"><a href="#StackedApp.check_for_duplicates_popup-1102"><span class="linenos">1102</span></a>        <span class="c1"># create a dialog</span>
</span><span id="StackedApp.check_for_duplicates_popup-1103"><a href="#StackedApp.check_for_duplicates_popup-1103"><span class="linenos">1103</span></a>        <span class="n">dialog</span> <span class="o">=</span> <span class="n">QDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="StackedApp.check_for_duplicates_popup-1104"><a href="#StackedApp.check_for_duplicates_popup-1104"><span class="linenos">1104</span></a>        <span class="n">dialog</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Check for Duplicates&quot;</span><span class="p">)</span>
</span><span id="StackedApp.check_for_duplicates_popup-1105"><a href="#StackedApp.check_for_duplicates_popup-1105"><span class="linenos">1105</span></a>        <span class="n">dialog</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="StackedApp.check_for_duplicates_popup-1106"><a href="#StackedApp.check_for_duplicates_popup-1106"><span class="linenos">1106</span></a>        <span class="c1"># create a layout</span>
</span><span id="StackedApp.check_for_duplicates_popup-1107"><a href="#StackedApp.check_for_duplicates_popup-1107"><span class="linenos">1107</span></a>        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
</span><span id="StackedApp.check_for_duplicates_popup-1108"><a href="#StackedApp.check_for_duplicates_popup-1108"><span class="linenos">1108</span></a>        <span class="c1"># create a combo box</span>
</span><span id="StackedApp.check_for_duplicates_popup-1109"><a href="#StackedApp.check_for_duplicates_popup-1109"><span class="linenos">1109</span></a>        <span class="n">combo_box</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
</span><span id="StackedApp.check_for_duplicates_popup-1110"><a href="#StackedApp.check_for_duplicates_popup-1110"><span class="linenos">1110</span></a>        <span class="n">combo_box</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span>
</span><span id="StackedApp.check_for_duplicates_popup-1111"><a href="#StackedApp.check_for_duplicates_popup-1111"><span class="linenos">1111</span></a>        <span class="c1"># create a button</span>
</span><span id="StackedApp.check_for_duplicates_popup-1112"><a href="#StackedApp.check_for_duplicates_popup-1112"><span class="linenos">1112</span></a>        <span class="n">button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="n">dialog</span><span class="p">)</span>
</span><span id="StackedApp.check_for_duplicates_popup-1113"><a href="#StackedApp.check_for_duplicates_popup-1113"><span class="linenos">1113</span></a>        <span class="c1"># add the combo box and button to the layout</span>
</span><span id="StackedApp.check_for_duplicates_popup-1114"><a href="#StackedApp.check_for_duplicates_popup-1114"><span class="linenos">1114</span></a>        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">combo_box</span><span class="p">)</span>
</span><span id="StackedApp.check_for_duplicates_popup-1115"><a href="#StackedApp.check_for_duplicates_popup-1115"><span class="linenos">1115</span></a>        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>
</span><span id="StackedApp.check_for_duplicates_popup-1116"><a href="#StackedApp.check_for_duplicates_popup-1116"><span class="linenos">1116</span></a>        <span class="c1"># set the layout</span>
</span><span id="StackedApp.check_for_duplicates_popup-1117"><a href="#StackedApp.check_for_duplicates_popup-1117"><span class="linenos">1117</span></a>        <span class="n">dialog</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
</span><span id="StackedApp.check_for_duplicates_popup-1118"><a href="#StackedApp.check_for_duplicates_popup-1118"><span class="linenos">1118</span></a>        <span class="c1"># connect the button to a function</span>
</span><span id="StackedApp.check_for_duplicates_popup-1119"><a href="#StackedApp.check_for_duplicates_popup-1119"><span class="linenos">1119</span></a>        <span class="n">button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="StackedApp.check_for_duplicates_popup-1120"><a href="#StackedApp.check_for_duplicates_popup-1120"><span class="linenos">1120</span></a>            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_for_duplicates_action</span><span class="p">(</span><span class="n">combo_box</span><span class="p">,</span> <span class="n">dialog</span><span class="p">))</span>
</span><span id="StackedApp.check_for_duplicates_popup-1121"><a href="#StackedApp.check_for_duplicates_popup-1121"><span class="linenos">1121</span></a>        <span class="c1"># show the dialog</span>
</span><span id="StackedApp.check_for_duplicates_popup-1122"><a href="#StackedApp.check_for_duplicates_popup-1122"><span class="linenos">1122</span></a>        <span class="n">dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>check_for_duplicates generate popup window that shows a combo box with all table columns in it and an ok button</p>

<p>Oftentimes, items that have duplicate values will be ones that can be linked. For example, two separate toner items that amount to the same part number (same yield value, same color, etc.) but they have different UPCs. By default, the app will separate these items into two different ones, but through the use of this function and 'linking the items', the user can choose to have the two items show up as one.</p>
</div>


                            </div>
                            <div id="StackedApp.check_for_duplicates_action" class="classattr">
                                        <input id="StackedApp.check_for_duplicates_action-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_for_duplicates_action</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">combo_box</span>, </span><span class="param"><span class="n">dialog</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="StackedApp.check_for_duplicates_action-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StackedApp.check_for_duplicates_action"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StackedApp.check_for_duplicates_action-1124"><a href="#StackedApp.check_for_duplicates_action-1124"><span class="linenos">1124</span></a>    <span class="k">def</span> <span class="nf">check_for_duplicates_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combo_box</span><span class="p">,</span> <span class="n">dialog</span><span class="p">):</span>
</span><span id="StackedApp.check_for_duplicates_action-1125"><a href="#StackedApp.check_for_duplicates_action-1125"><span class="linenos">1125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StackedApp.check_for_duplicates_action-1126"><a href="#StackedApp.check_for_duplicates_action-1126"><span class="linenos">1126</span></a><span class="sd">        check_for_duplicates_action the action of checking for duplicates.</span>
</span><span id="StackedApp.check_for_duplicates_action-1127"><a href="#StackedApp.check_for_duplicates_action-1127"><span class="linenos">1127</span></a>
</span><span id="StackedApp.check_for_duplicates_action-1128"><a href="#StackedApp.check_for_duplicates_action-1128"><span class="linenos">1128</span></a><span class="sd">        &lt;b&gt;Read description of check_for_duplicates_popup for more information.&lt;/b&gt;</span>
</span><span id="StackedApp.check_for_duplicates_action-1129"><a href="#StackedApp.check_for_duplicates_action-1129"><span class="linenos">1129</span></a>
</span><span id="StackedApp.check_for_duplicates_action-1130"><a href="#StackedApp.check_for_duplicates_action-1130"><span class="linenos">1130</span></a><span class="sd">        Args:</span>
</span><span id="StackedApp.check_for_duplicates_action-1131"><a href="#StackedApp.check_for_duplicates_action-1131"><span class="linenos">1131</span></a><span class="sd">            combo_box (QComboBox): necessary so that the function can get the text from the combo box (the column that will be searched for duplicates)</span>
</span><span id="StackedApp.check_for_duplicates_action-1132"><a href="#StackedApp.check_for_duplicates_action-1132"><span class="linenos">1132</span></a><span class="sd">            dialog (QDialog): so the app can close the QDialog.</span>
</span><span id="StackedApp.check_for_duplicates_action-1133"><a href="#StackedApp.check_for_duplicates_action-1133"><span class="linenos">1133</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StackedApp.check_for_duplicates_action-1134"><a href="#StackedApp.check_for_duplicates_action-1134"><span class="linenos">1134</span></a>        <span class="c1"># get text from combobox</span>
</span><span id="StackedApp.check_for_duplicates_action-1135"><a href="#StackedApp.check_for_duplicates_action-1135"><span class="linenos">1135</span></a>        <span class="n">column_name</span> <span class="o">=</span> <span class="n">combo_box</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
</span><span id="StackedApp.check_for_duplicates_action-1136"><a href="#StackedApp.check_for_duplicates_action-1136"><span class="linenos">1136</span></a>        <span class="c1"># close the dialog</span>
</span><span id="StackedApp.check_for_duplicates_action-1137"><a href="#StackedApp.check_for_duplicates_action-1137"><span class="linenos">1137</span></a>        <span class="n">dialog</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="StackedApp.check_for_duplicates_action-1138"><a href="#StackedApp.check_for_duplicates_action-1138"><span class="linenos">1138</span></a>        <span class="c1"># get query ready for table</span>
</span><span id="StackedApp.check_for_duplicates_action-1139"><a href="#StackedApp.check_for_duplicates_action-1139"><span class="linenos">1139</span></a>        <span class="n">column_str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
</span><span id="StackedApp.check_for_duplicates_action-1140"><a href="#StackedApp.check_for_duplicates_action-1140"><span class="linenos">1140</span></a>
</span><span id="StackedApp.check_for_duplicates_action-1141"><a href="#StackedApp.check_for_duplicates_action-1141"><span class="linenos">1141</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT </span><span class="si">{</span><span class="n">column_str</span><span class="si">}</span><span class="s2"> FROM </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> WHERE </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> IN (SELECT </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> FROM </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> GROUP BY </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> HAVING COUNT(*) &gt; 1)&quot;</span>
</span><span id="StackedApp.check_for_duplicates_action-1142"><a href="#StackedApp.check_for_duplicates_action-1142"><span class="linenos">1142</span></a>        <span class="c1"># display table with the data</span>
</span><span id="StackedApp.check_for_duplicates_action-1143"><a href="#StackedApp.check_for_duplicates_action-1143"><span class="linenos">1143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_table_page</span><span class="p">(</span><span class="n">table_query</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>check_for_duplicates_action the action of checking for duplicates.</p>

<p><b>Read description of check_for_duplicates_popup for more information.</b></p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>combo_box (QComboBox):</strong>  necessary so that the function can get the text from the combo box (the column that will be searched for duplicates)</li>
<li><strong>dialog (QDialog):</strong>  so the app can close the QDialog.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>PyQt5.QtWidgets.QWidget</dt>
                                <dd id="StackedApp.RenderFlag" class="class">RenderFlag</dd>
                <dd id="StackedApp.RenderFlags" class="class">RenderFlags</dd>
                <dd id="StackedApp.acceptDrops" class="function">acceptDrops</dd>
                <dd id="StackedApp.accessibleDescription" class="function">accessibleDescription</dd>
                <dd id="StackedApp.accessibleName" class="function">accessibleName</dd>
                <dd id="StackedApp.actionEvent" class="function">actionEvent</dd>
                <dd id="StackedApp.actions" class="function">actions</dd>
                <dd id="StackedApp.activateWindow" class="function">activateWindow</dd>
                <dd id="StackedApp.addAction" class="function">addAction</dd>
                <dd id="StackedApp.addActions" class="function">addActions</dd>
                <dd id="StackedApp.adjustSize" class="function">adjustSize</dd>
                <dd id="StackedApp.autoFillBackground" class="function">autoFillBackground</dd>
                <dd id="StackedApp.backgroundRole" class="function">backgroundRole</dd>
                <dd id="StackedApp.baseSize" class="function">baseSize</dd>
                <dd id="StackedApp.changeEvent" class="function">changeEvent</dd>
                <dd id="StackedApp.childAt" class="function">childAt</dd>
                <dd id="StackedApp.childEvent" class="function">childEvent</dd>
                <dd id="StackedApp.childrenRect" class="function">childrenRect</dd>
                <dd id="StackedApp.childrenRegion" class="function">childrenRegion</dd>
                <dd id="StackedApp.clearFocus" class="function">clearFocus</dd>
                <dd id="StackedApp.clearMask" class="function">clearMask</dd>
                <dd id="StackedApp.close" class="function">close</dd>
                <dd id="StackedApp.closeEvent" class="function">closeEvent</dd>
                <dd id="StackedApp.connectNotify" class="function">connectNotify</dd>
                <dd id="StackedApp.contentsMargins" class="function">contentsMargins</dd>
                <dd id="StackedApp.contentsRect" class="function">contentsRect</dd>
                <dd id="StackedApp.contextMenuEvent" class="function">contextMenuEvent</dd>
                <dd id="StackedApp.contextMenuPolicy" class="function">contextMenuPolicy</dd>
                <dd id="StackedApp.create" class="function">create</dd>
                <dd id="StackedApp.createWindowContainer" class="function">createWindowContainer</dd>
                <dd id="StackedApp.cursor" class="function">cursor</dd>
                <dd id="StackedApp.customEvent" class="function">customEvent</dd>
                <dd id="StackedApp.destroy" class="function">destroy</dd>
                <dd id="StackedApp.devType" class="function">devType</dd>
                <dd id="StackedApp.disconnectNotify" class="function">disconnectNotify</dd>
                <dd id="StackedApp.dragEnterEvent" class="function">dragEnterEvent</dd>
                <dd id="StackedApp.dragLeaveEvent" class="function">dragLeaveEvent</dd>
                <dd id="StackedApp.dragMoveEvent" class="function">dragMoveEvent</dd>
                <dd id="StackedApp.dropEvent" class="function">dropEvent</dd>
                <dd id="StackedApp.effectiveWinId" class="function">effectiveWinId</dd>
                <dd id="StackedApp.ensurePolished" class="function">ensurePolished</dd>
                <dd id="StackedApp.enterEvent" class="function">enterEvent</dd>
                <dd id="StackedApp.event" class="function">event</dd>
                <dd id="StackedApp.find" class="function">find</dd>
                <dd id="StackedApp.focusInEvent" class="function">focusInEvent</dd>
                <dd id="StackedApp.focusNextChild" class="function">focusNextChild</dd>
                <dd id="StackedApp.focusNextPrevChild" class="function">focusNextPrevChild</dd>
                <dd id="StackedApp.focusOutEvent" class="function">focusOutEvent</dd>
                <dd id="StackedApp.focusPolicy" class="function">focusPolicy</dd>
                <dd id="StackedApp.focusPreviousChild" class="function">focusPreviousChild</dd>
                <dd id="StackedApp.focusProxy" class="function">focusProxy</dd>
                <dd id="StackedApp.focusWidget" class="function">focusWidget</dd>
                <dd id="StackedApp.font" class="function">font</dd>
                <dd id="StackedApp.fontInfo" class="function">fontInfo</dd>
                <dd id="StackedApp.fontMetrics" class="function">fontMetrics</dd>
                <dd id="StackedApp.foregroundRole" class="function">foregroundRole</dd>
                <dd id="StackedApp.frameGeometry" class="function">frameGeometry</dd>
                <dd id="StackedApp.frameSize" class="function">frameSize</dd>
                <dd id="StackedApp.geometry" class="function">geometry</dd>
                <dd id="StackedApp.getContentsMargins" class="function">getContentsMargins</dd>
                <dd id="StackedApp.grab" class="function">grab</dd>
                <dd id="StackedApp.grabGesture" class="function">grabGesture</dd>
                <dd id="StackedApp.grabKeyboard" class="function">grabKeyboard</dd>
                <dd id="StackedApp.grabMouse" class="function">grabMouse</dd>
                <dd id="StackedApp.grabShortcut" class="function">grabShortcut</dd>
                <dd id="StackedApp.graphicsEffect" class="function">graphicsEffect</dd>
                <dd id="StackedApp.graphicsProxyWidget" class="function">graphicsProxyWidget</dd>
                <dd id="StackedApp.hasFocus" class="function">hasFocus</dd>
                <dd id="StackedApp.hasHeightForWidth" class="function">hasHeightForWidth</dd>
                <dd id="StackedApp.hasMouseTracking" class="function">hasMouseTracking</dd>
                <dd id="StackedApp.hasTabletTracking" class="function">hasTabletTracking</dd>
                <dd id="StackedApp.height" class="function">height</dd>
                <dd id="StackedApp.heightForWidth" class="function">heightForWidth</dd>
                <dd id="StackedApp.hide" class="function">hide</dd>
                <dd id="StackedApp.hideEvent" class="function">hideEvent</dd>
                <dd id="StackedApp.initPainter" class="function">initPainter</dd>
                <dd id="StackedApp.inputMethodEvent" class="function">inputMethodEvent</dd>
                <dd id="StackedApp.inputMethodHints" class="function">inputMethodHints</dd>
                <dd id="StackedApp.inputMethodQuery" class="function">inputMethodQuery</dd>
                <dd id="StackedApp.insertAction" class="function">insertAction</dd>
                <dd id="StackedApp.insertActions" class="function">insertActions</dd>
                <dd id="StackedApp.isActiveWindow" class="function">isActiveWindow</dd>
                <dd id="StackedApp.isAncestorOf" class="function">isAncestorOf</dd>
                <dd id="StackedApp.isEnabled" class="function">isEnabled</dd>
                <dd id="StackedApp.isEnabledTo" class="function">isEnabledTo</dd>
                <dd id="StackedApp.isFullScreen" class="function">isFullScreen</dd>
                <dd id="StackedApp.isHidden" class="function">isHidden</dd>
                <dd id="StackedApp.isLeftToRight" class="function">isLeftToRight</dd>
                <dd id="StackedApp.isMaximized" class="function">isMaximized</dd>
                <dd id="StackedApp.isMinimized" class="function">isMinimized</dd>
                <dd id="StackedApp.isModal" class="function">isModal</dd>
                <dd id="StackedApp.isRightToLeft" class="function">isRightToLeft</dd>
                <dd id="StackedApp.isSignalConnected" class="function">isSignalConnected</dd>
                <dd id="StackedApp.isVisible" class="function">isVisible</dd>
                <dd id="StackedApp.isVisibleTo" class="function">isVisibleTo</dd>
                <dd id="StackedApp.isWindow" class="function">isWindow</dd>
                <dd id="StackedApp.isWindowModified" class="function">isWindowModified</dd>
                <dd id="StackedApp.keyPressEvent" class="function">keyPressEvent</dd>
                <dd id="StackedApp.keyReleaseEvent" class="function">keyReleaseEvent</dd>
                <dd id="StackedApp.keyboardGrabber" class="function">keyboardGrabber</dd>
                <dd id="StackedApp.layout" class="function">layout</dd>
                <dd id="StackedApp.layoutDirection" class="function">layoutDirection</dd>
                <dd id="StackedApp.leaveEvent" class="function">leaveEvent</dd>
                <dd id="StackedApp.locale" class="function">locale</dd>
                <dd id="StackedApp.lower" class="function">lower</dd>
                <dd id="StackedApp.mapFrom" class="function">mapFrom</dd>
                <dd id="StackedApp.mapFromGlobal" class="function">mapFromGlobal</dd>
                <dd id="StackedApp.mapFromParent" class="function">mapFromParent</dd>
                <dd id="StackedApp.mapTo" class="function">mapTo</dd>
                <dd id="StackedApp.mapToGlobal" class="function">mapToGlobal</dd>
                <dd id="StackedApp.mapToParent" class="function">mapToParent</dd>
                <dd id="StackedApp.mask" class="function">mask</dd>
                <dd id="StackedApp.maximumHeight" class="function">maximumHeight</dd>
                <dd id="StackedApp.maximumSize" class="function">maximumSize</dd>
                <dd id="StackedApp.maximumWidth" class="function">maximumWidth</dd>
                <dd id="StackedApp.metric" class="function">metric</dd>
                <dd id="StackedApp.minimumHeight" class="function">minimumHeight</dd>
                <dd id="StackedApp.minimumSize" class="function">minimumSize</dd>
                <dd id="StackedApp.minimumSizeHint" class="function">minimumSizeHint</dd>
                <dd id="StackedApp.minimumWidth" class="function">minimumWidth</dd>
                <dd id="StackedApp.mouseDoubleClickEvent" class="function">mouseDoubleClickEvent</dd>
                <dd id="StackedApp.mouseGrabber" class="function">mouseGrabber</dd>
                <dd id="StackedApp.mouseMoveEvent" class="function">mouseMoveEvent</dd>
                <dd id="StackedApp.mousePressEvent" class="function">mousePressEvent</dd>
                <dd id="StackedApp.mouseReleaseEvent" class="function">mouseReleaseEvent</dd>
                <dd id="StackedApp.move" class="function">move</dd>
                <dd id="StackedApp.moveEvent" class="function">moveEvent</dd>
                <dd id="StackedApp.nativeEvent" class="function">nativeEvent</dd>
                <dd id="StackedApp.nativeParentWidget" class="function">nativeParentWidget</dd>
                <dd id="StackedApp.nextInFocusChain" class="function">nextInFocusChain</dd>
                <dd id="StackedApp.normalGeometry" class="function">normalGeometry</dd>
                <dd id="StackedApp.overrideWindowFlags" class="function">overrideWindowFlags</dd>
                <dd id="StackedApp.overrideWindowState" class="function">overrideWindowState</dd>
                <dd id="StackedApp.paintEngine" class="function">paintEngine</dd>
                <dd id="StackedApp.paintEvent" class="function">paintEvent</dd>
                <dd id="StackedApp.palette" class="function">palette</dd>
                <dd id="StackedApp.parentWidget" class="function">parentWidget</dd>
                <dd id="StackedApp.pos" class="function">pos</dd>
                <dd id="StackedApp.previousInFocusChain" class="function">previousInFocusChain</dd>
                <dd id="StackedApp.raise_" class="function">raise_</dd>
                <dd id="StackedApp.receivers" class="function">receivers</dd>
                <dd id="StackedApp.rect" class="function">rect</dd>
                <dd id="StackedApp.releaseKeyboard" class="function">releaseKeyboard</dd>
                <dd id="StackedApp.releaseMouse" class="function">releaseMouse</dd>
                <dd id="StackedApp.releaseShortcut" class="function">releaseShortcut</dd>
                <dd id="StackedApp.removeAction" class="function">removeAction</dd>
                <dd id="StackedApp.render" class="function">render</dd>
                <dd id="StackedApp.repaint" class="function">repaint</dd>
                <dd id="StackedApp.resize" class="function">resize</dd>
                <dd id="StackedApp.resizeEvent" class="function">resizeEvent</dd>
                <dd id="StackedApp.restoreGeometry" class="function">restoreGeometry</dd>
                <dd id="StackedApp.saveGeometry" class="function">saveGeometry</dd>
                <dd id="StackedApp.screen" class="function">screen</dd>
                <dd id="StackedApp.scroll" class="function">scroll</dd>
                <dd id="StackedApp.sender" class="function">sender</dd>
                <dd id="StackedApp.senderSignalIndex" class="function">senderSignalIndex</dd>
                <dd id="StackedApp.setAcceptDrops" class="function">setAcceptDrops</dd>
                <dd id="StackedApp.setAccessibleDescription" class="function">setAccessibleDescription</dd>
                <dd id="StackedApp.setAccessibleName" class="function">setAccessibleName</dd>
                <dd id="StackedApp.setAttribute" class="function">setAttribute</dd>
                <dd id="StackedApp.setAutoFillBackground" class="function">setAutoFillBackground</dd>
                <dd id="StackedApp.setBackgroundRole" class="function">setBackgroundRole</dd>
                <dd id="StackedApp.setBaseSize" class="function">setBaseSize</dd>
                <dd id="StackedApp.setContentsMargins" class="function">setContentsMargins</dd>
                <dd id="StackedApp.setContextMenuPolicy" class="function">setContextMenuPolicy</dd>
                <dd id="StackedApp.setCursor" class="function">setCursor</dd>
                <dd id="StackedApp.setDisabled" class="function">setDisabled</dd>
                <dd id="StackedApp.setEnabled" class="function">setEnabled</dd>
                <dd id="StackedApp.setFixedHeight" class="function">setFixedHeight</dd>
                <dd id="StackedApp.setFixedSize" class="function">setFixedSize</dd>
                <dd id="StackedApp.setFixedWidth" class="function">setFixedWidth</dd>
                <dd id="StackedApp.setFocus" class="function">setFocus</dd>
                <dd id="StackedApp.setFocusPolicy" class="function">setFocusPolicy</dd>
                <dd id="StackedApp.setFocusProxy" class="function">setFocusProxy</dd>
                <dd id="StackedApp.setFont" class="function">setFont</dd>
                <dd id="StackedApp.setForegroundRole" class="function">setForegroundRole</dd>
                <dd id="StackedApp.setGeometry" class="function">setGeometry</dd>
                <dd id="StackedApp.setGraphicsEffect" class="function">setGraphicsEffect</dd>
                <dd id="StackedApp.setHidden" class="function">setHidden</dd>
                <dd id="StackedApp.setInputMethodHints" class="function">setInputMethodHints</dd>
                <dd id="StackedApp.setLayout" class="function">setLayout</dd>
                <dd id="StackedApp.setLayoutDirection" class="function">setLayoutDirection</dd>
                <dd id="StackedApp.setLocale" class="function">setLocale</dd>
                <dd id="StackedApp.setMask" class="function">setMask</dd>
                <dd id="StackedApp.setMaximumHeight" class="function">setMaximumHeight</dd>
                <dd id="StackedApp.setMaximumSize" class="function">setMaximumSize</dd>
                <dd id="StackedApp.setMaximumWidth" class="function">setMaximumWidth</dd>
                <dd id="StackedApp.setMinimumHeight" class="function">setMinimumHeight</dd>
                <dd id="StackedApp.setMinimumSize" class="function">setMinimumSize</dd>
                <dd id="StackedApp.setMinimumWidth" class="function">setMinimumWidth</dd>
                <dd id="StackedApp.setMouseTracking" class="function">setMouseTracking</dd>
                <dd id="StackedApp.setPalette" class="function">setPalette</dd>
                <dd id="StackedApp.setParent" class="function">setParent</dd>
                <dd id="StackedApp.setShortcutAutoRepeat" class="function">setShortcutAutoRepeat</dd>
                <dd id="StackedApp.setShortcutEnabled" class="function">setShortcutEnabled</dd>
                <dd id="StackedApp.setSizeIncrement" class="function">setSizeIncrement</dd>
                <dd id="StackedApp.setSizePolicy" class="function">setSizePolicy</dd>
                <dd id="StackedApp.setStatusTip" class="function">setStatusTip</dd>
                <dd id="StackedApp.setStyle" class="function">setStyle</dd>
                <dd id="StackedApp.setStyleSheet" class="function">setStyleSheet</dd>
                <dd id="StackedApp.setTabOrder" class="function">setTabOrder</dd>
                <dd id="StackedApp.setTabletTracking" class="function">setTabletTracking</dd>
                <dd id="StackedApp.setToolTip" class="function">setToolTip</dd>
                <dd id="StackedApp.setToolTipDuration" class="function">setToolTipDuration</dd>
                <dd id="StackedApp.setUpdatesEnabled" class="function">setUpdatesEnabled</dd>
                <dd id="StackedApp.setVisible" class="function">setVisible</dd>
                <dd id="StackedApp.setWhatsThis" class="function">setWhatsThis</dd>
                <dd id="StackedApp.setWindowFilePath" class="function">setWindowFilePath</dd>
                <dd id="StackedApp.setWindowFlag" class="function">setWindowFlag</dd>
                <dd id="StackedApp.setWindowFlags" class="function">setWindowFlags</dd>
                <dd id="StackedApp.setWindowIcon" class="function">setWindowIcon</dd>
                <dd id="StackedApp.setWindowIconText" class="function">setWindowIconText</dd>
                <dd id="StackedApp.setWindowModality" class="function">setWindowModality</dd>
                <dd id="StackedApp.setWindowModified" class="function">setWindowModified</dd>
                <dd id="StackedApp.setWindowOpacity" class="function">setWindowOpacity</dd>
                <dd id="StackedApp.setWindowRole" class="function">setWindowRole</dd>
                <dd id="StackedApp.setWindowState" class="function">setWindowState</dd>
                <dd id="StackedApp.setWindowTitle" class="function">setWindowTitle</dd>
                <dd id="StackedApp.sharedPainter" class="function">sharedPainter</dd>
                <dd id="StackedApp.show" class="function">show</dd>
                <dd id="StackedApp.showEvent" class="function">showEvent</dd>
                <dd id="StackedApp.showFullScreen" class="function">showFullScreen</dd>
                <dd id="StackedApp.showMaximized" class="function">showMaximized</dd>
                <dd id="StackedApp.showMinimized" class="function">showMinimized</dd>
                <dd id="StackedApp.showNormal" class="function">showNormal</dd>
                <dd id="StackedApp.size" class="function">size</dd>
                <dd id="StackedApp.sizeHint" class="function">sizeHint</dd>
                <dd id="StackedApp.sizeIncrement" class="function">sizeIncrement</dd>
                <dd id="StackedApp.sizePolicy" class="function">sizePolicy</dd>
                <dd id="StackedApp.stackUnder" class="function">stackUnder</dd>
                <dd id="StackedApp.statusTip" class="function">statusTip</dd>
                <dd id="StackedApp.style" class="function">style</dd>
                <dd id="StackedApp.styleSheet" class="function">styleSheet</dd>
                <dd id="StackedApp.tabletEvent" class="function">tabletEvent</dd>
                <dd id="StackedApp.testAttribute" class="function">testAttribute</dd>
                <dd id="StackedApp.timerEvent" class="function">timerEvent</dd>
                <dd id="StackedApp.toolTip" class="function">toolTip</dd>
                <dd id="StackedApp.toolTipDuration" class="function">toolTipDuration</dd>
                <dd id="StackedApp.underMouse" class="function">underMouse</dd>
                <dd id="StackedApp.ungrabGesture" class="function">ungrabGesture</dd>
                <dd id="StackedApp.unsetCursor" class="function">unsetCursor</dd>
                <dd id="StackedApp.unsetLayoutDirection" class="function">unsetLayoutDirection</dd>
                <dd id="StackedApp.unsetLocale" class="function">unsetLocale</dd>
                <dd id="StackedApp.update" class="function">update</dd>
                <dd id="StackedApp.updateGeometry" class="function">updateGeometry</dd>
                <dd id="StackedApp.updateMicroFocus" class="function">updateMicroFocus</dd>
                <dd id="StackedApp.updatesEnabled" class="function">updatesEnabled</dd>
                <dd id="StackedApp.visibleRegion" class="function">visibleRegion</dd>
                <dd id="StackedApp.whatsThis" class="function">whatsThis</dd>
                <dd id="StackedApp.wheelEvent" class="function">wheelEvent</dd>
                <dd id="StackedApp.width" class="function">width</dd>
                <dd id="StackedApp.winId" class="function">winId</dd>
                <dd id="StackedApp.window" class="function">window</dd>
                <dd id="StackedApp.windowFilePath" class="function">windowFilePath</dd>
                <dd id="StackedApp.windowFlags" class="function">windowFlags</dd>
                <dd id="StackedApp.windowHandle" class="function">windowHandle</dd>
                <dd id="StackedApp.windowIcon" class="function">windowIcon</dd>
                <dd id="StackedApp.windowIconText" class="function">windowIconText</dd>
                <dd id="StackedApp.windowModality" class="function">windowModality</dd>
                <dd id="StackedApp.windowOpacity" class="function">windowOpacity</dd>
                <dd id="StackedApp.windowRole" class="function">windowRole</dd>
                <dd id="StackedApp.windowState" class="function">windowState</dd>
                <dd id="StackedApp.windowTitle" class="function">windowTitle</dd>
                <dd id="StackedApp.windowType" class="function">windowType</dd>
                <dd id="StackedApp.x" class="function">x</dd>
                <dd id="StackedApp.y" class="function">y</dd>
                <dd id="StackedApp.windowIconTextChanged" class="function">windowIconTextChanged</dd>
                <dd id="StackedApp.windowIconChanged" class="function">windowIconChanged</dd>
                <dd id="StackedApp.windowTitleChanged" class="function">windowTitleChanged</dd>
                <dd id="StackedApp.customContextMenuRequested" class="function">customContextMenuRequested</dd>

            </div>
            <div><dt>PyQt5.QtCore.QObject</dt>
                                <dd id="StackedApp.blockSignals" class="function">blockSignals</dd>
                <dd id="StackedApp.children" class="function">children</dd>
                <dd id="StackedApp.deleteLater" class="function">deleteLater</dd>
                <dd id="StackedApp.disconnect" class="function">disconnect</dd>
                <dd id="StackedApp.dumpObjectInfo" class="function">dumpObjectInfo</dd>
                <dd id="StackedApp.dumpObjectTree" class="function">dumpObjectTree</dd>
                <dd id="StackedApp.dynamicPropertyNames" class="function">dynamicPropertyNames</dd>
                <dd id="StackedApp.eventFilter" class="function">eventFilter</dd>
                <dd id="StackedApp.findChild" class="function">findChild</dd>
                <dd id="StackedApp.findChildren" class="function">findChildren</dd>
                <dd id="StackedApp.inherits" class="function">inherits</dd>
                <dd id="StackedApp.installEventFilter" class="function">installEventFilter</dd>
                <dd id="StackedApp.isWidgetType" class="function">isWidgetType</dd>
                <dd id="StackedApp.isWindowType" class="function">isWindowType</dd>
                <dd id="StackedApp.killTimer" class="function">killTimer</dd>
                <dd id="StackedApp.metaObject" class="function">metaObject</dd>
                <dd id="StackedApp.moveToThread" class="function">moveToThread</dd>
                <dd id="StackedApp.objectName" class="function">objectName</dd>
                <dd id="StackedApp.parent" class="function">parent</dd>
                <dd id="StackedApp.property" class="function">property</dd>
                <dd id="StackedApp.pyqtConfigure" class="function">pyqtConfigure</dd>
                <dd id="StackedApp.removeEventFilter" class="function">removeEventFilter</dd>
                <dd id="StackedApp.setObjectName" class="function">setObjectName</dd>
                <dd id="StackedApp.setProperty" class="function">setProperty</dd>
                <dd id="StackedApp.signalsBlocked" class="function">signalsBlocked</dd>
                <dd id="StackedApp.startTimer" class="function">startTimer</dd>
                <dd id="StackedApp.thread" class="function">thread</dd>
                <dd id="StackedApp.tr" class="function">tr</dd>
                <dd id="StackedApp.objectNameChanged" class="function">objectNameChanged</dd>
                <dd id="StackedApp.destroyed" class="function">destroyed</dd>

            </div>
            <div><dt>PyQt5.QtGui.QPaintDevice</dt>
                                <dd id="StackedApp.PaintDeviceMetric" class="class">PaintDeviceMetric</dd>
                <dd id="StackedApp.colorCount" class="function">colorCount</dd>
                <dd id="StackedApp.depth" class="function">depth</dd>
                <dd id="StackedApp.devicePixelRatio" class="function">devicePixelRatio</dd>
                <dd id="StackedApp.devicePixelRatioF" class="function">devicePixelRatioF</dd>
                <dd id="StackedApp.devicePixelRatioFScale" class="function">devicePixelRatioFScale</dd>
                <dd id="StackedApp.heightMM" class="function">heightMM</dd>
                <dd id="StackedApp.logicalDpiX" class="function">logicalDpiX</dd>
                <dd id="StackedApp.logicalDpiY" class="function">logicalDpiY</dd>
                <dd id="StackedApp.paintingActive" class="function">paintingActive</dd>
                <dd id="StackedApp.physicalDpiX" class="function">physicalDpiX</dd>
                <dd id="StackedApp.physicalDpiY" class="function">physicalDpiY</dd>
                <dd id="StackedApp.widthMM" class="function">widthMM</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MainWindowShell">
                            <input id="MainWindowShell-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MainWindowShell</span><wbr>(<span class="base">PyQt5.QtWidgets.QMainWindow</span>):

                <label class="view-source-button" for="MainWindowShell-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MainWindowShell"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MainWindowShell-1146"><a href="#MainWindowShell-1146"><span class="linenos">1146</span></a><span class="k">class</span> <span class="nc">MainWindowShell</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
</span><span id="MainWindowShell-1147"><a href="#MainWindowShell-1147"><span class="linenos">1147</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MainWindowShell-1148"><a href="#MainWindowShell-1148"><span class="linenos">1148</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MainWindowShell-1149"><a href="#MainWindowShell-1149"><span class="linenos">1149</span></a><span class="sd">        __init__ This QMainWindow holds the QStackedWidget which makes up the core of the application. The QStackedWidget stacks widgets on top of each other, and can switch between them.</span>
</span><span id="MainWindowShell-1150"><a href="#MainWindowShell-1150"><span class="linenos">1150</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MainWindowShell-1151"><a href="#MainWindowShell-1151"><span class="linenos">1151</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="MainWindowShell-1152"><a href="#MainWindowShell-1152"><span class="linenos">1152</span></a>        <span class="n">initialize_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1153"><a href="#MainWindowShell-1153"><span class="linenos">1153</span></a>
</span><span id="MainWindowShell-1154"><a href="#MainWindowShell-1154"><span class="linenos">1154</span></a>        <span class="c1"># set basic window details</span>
</span><span id="MainWindowShell-1155"><a href="#MainWindowShell-1155"><span class="linenos">1155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">app_name</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell-1156"><a href="#MainWindowShell-1156"><span class="linenos">1156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="MainWindowShell-1157"><a href="#MainWindowShell-1157"><span class="linenos">1157</span></a>
</span><span id="MainWindowShell-1158"><a href="#MainWindowShell-1158"><span class="linenos">1158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span> <span class="o">=</span> <span class="n">StackedApp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1159"><a href="#MainWindowShell-1159"><span class="linenos">1159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_menu</span><span class="p">()</span>
</span><span id="MainWindowShell-1160"><a href="#MainWindowShell-1160"><span class="linenos">1160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="p">)</span>
</span><span id="MainWindowShell-1161"><a href="#MainWindowShell-1161"><span class="linenos">1161</span></a>
</span><span id="MainWindowShell-1162"><a href="#MainWindowShell-1162"><span class="linenos">1162</span></a>    <span class="k">def</span> <span class="nf">build_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MainWindowShell-1163"><a href="#MainWindowShell-1163"><span class="linenos">1163</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MainWindowShell-1164"><a href="#MainWindowShell-1164"><span class="linenos">1164</span></a><span class="sd">        build_menu Creates the main MenuBar for the app, as well as the secondary toolbar which is directly underneath the main menubar. Adds icons and actions to the menubar and toolbar buttons.</span>
</span><span id="MainWindowShell-1165"><a href="#MainWindowShell-1165"><span class="linenos">1165</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MainWindowShell-1166"><a href="#MainWindowShell-1166"><span class="linenos">1166</span></a>        <span class="c1"># TODO: Look for more efficient way to build main menubar and secondary toolbar.</span>
</span><span id="MainWindowShell-1167"><a href="#MainWindowShell-1167"><span class="linenos">1167</span></a>        <span class="c1"># ------------------------------------</span>
</span><span id="MainWindowShell-1168"><a href="#MainWindowShell-1168"><span class="linenos">1168</span></a>        <span class="c1"># MAIN MENUBAR:</span>
</span><span id="MainWindowShell-1169"><a href="#MainWindowShell-1169"><span class="linenos">1169</span></a>        <span class="n">menubar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span>
</span><span id="MainWindowShell-1170"><a href="#MainWindowShell-1170"><span class="linenos">1170</span></a>        <span class="c1"># TOP/MAIN MENU OPTIONS:</span>
</span><span id="MainWindowShell-1171"><a href="#MainWindowShell-1171"><span class="linenos">1171</span></a>        <span class="n">menubar_option_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;Edit&quot;</span><span class="p">,</span> <span class="s2">&quot;View&quot;</span><span class="p">,</span> <span class="s2">&quot;Settings&quot;</span><span class="p">,</span> <span class="s2">&quot;Help&quot;</span><span class="p">]</span>
</span><span id="MainWindowShell-1172"><a href="#MainWindowShell-1172"><span class="linenos">1172</span></a>        <span class="c1"># create the top/main menu options</span>
</span><span id="MainWindowShell-1173"><a href="#MainWindowShell-1173"><span class="linenos">1173</span></a>        <span class="n">menubar_options</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MainWindowShell-1174"><a href="#MainWindowShell-1174"><span class="linenos">1174</span></a>        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">menubar_option_names</span><span class="p">:</span>
</span><span id="MainWindowShell-1175"><a href="#MainWindowShell-1175"><span class="linenos">1175</span></a>            <span class="n">menubar_options</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
</span><span id="MainWindowShell-1176"><a href="#MainWindowShell-1176"><span class="linenos">1176</span></a>
</span><span id="MainWindowShell-1177"><a href="#MainWindowShell-1177"><span class="linenos">1177</span></a>        <span class="c1"># -- File menu</span>
</span><span id="MainWindowShell-1178"><a href="#MainWindowShell-1178"><span class="linenos">1178</span></a>        <span class="c1">#  Search function : File &gt; Search</span>
</span><span id="MainWindowShell-1179"><a href="#MainWindowShell-1179"><span class="linenos">1179</span></a>        <span class="n">search_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s2">&quot;fa5s.search&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">))</span>
</span><span id="MainWindowShell-1180"><a href="#MainWindowShell-1180"><span class="linenos">1180</span></a>        <span class="n">search_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">search_icon</span><span class="p">,</span> <span class="s2">&quot;Search&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1181"><a href="#MainWindowShell-1181"><span class="linenos">1181</span></a>
</span><span id="MainWindowShell-1182"><a href="#MainWindowShell-1182"><span class="linenos">1182</span></a>        <span class="n">search_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+F&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell-1183"><a href="#MainWindowShell-1183"><span class="linenos">1183</span></a>        <span class="n">search_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_search_dialog</span><span class="p">)</span>
</span><span id="MainWindowShell-1184"><a href="#MainWindowShell-1184"><span class="linenos">1184</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">search_action</span><span class="p">)</span>
</span><span id="MainWindowShell-1185"><a href="#MainWindowShell-1185"><span class="linenos">1185</span></a>
</span><span id="MainWindowShell-1186"><a href="#MainWindowShell-1186"><span class="linenos">1186</span></a>        <span class="c1"># Import upcs option : File &gt; Import UPCs</span>
</span><span id="MainWindowShell-1187"><a href="#MainWindowShell-1187"><span class="linenos">1187</span></a>        <span class="n">qtimporticon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1188"><a href="#MainWindowShell-1188"><span class="linenos">1188</span></a>            <span class="s2">&quot;mdi.import&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="MainWindowShell-1189"><a href="#MainWindowShell-1189"><span class="linenos">1189</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1190"><a href="#MainWindowShell-1190"><span class="linenos">1190</span></a>        <span class="n">import_item_list_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span>
</span><span id="MainWindowShell-1191"><a href="#MainWindowShell-1191"><span class="linenos">1191</span></a>            <span class="n">qtimporticon</span><span class="p">,</span> <span class="s2">&quot;Import UPC File&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1192"><a href="#MainWindowShell-1192"><span class="linenos">1192</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">import_item_list_action</span><span class="p">)</span>
</span><span id="MainWindowShell-1193"><a href="#MainWindowShell-1193"><span class="linenos">1193</span></a>        <span class="n">import_item_list_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell-1194"><a href="#MainWindowShell-1194"><span class="linenos">1194</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">import_item_list</span><span class="p">)</span>
</span><span id="MainWindowShell-1195"><a href="#MainWindowShell-1195"><span class="linenos">1195</span></a>
</span><span id="MainWindowShell-1196"><a href="#MainWindowShell-1196"><span class="linenos">1196</span></a>        <span class="c1"># File &gt; Reset Database</span>
</span><span id="MainWindowShell-1197"><a href="#MainWindowShell-1197"><span class="linenos">1197</span></a>        <span class="n">reset_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1198"><a href="#MainWindowShell-1198"><span class="linenos">1198</span></a>            <span class="s2">&quot;mdi6.database-refresh&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">))</span>
</span><span id="MainWindowShell-1199"><a href="#MainWindowShell-1199"><span class="linenos">1199</span></a>        <span class="n">reset_database_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">reset_icon</span><span class="p">,</span> <span class="s2">&quot;Reset Database&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1200"><a href="#MainWindowShell-1200"><span class="linenos">1200</span></a>        <span class="n">reset_database_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell-1201"><a href="#MainWindowShell-1201"><span class="linenos">1201</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">reset_database</span><span class="p">)</span>
</span><span id="MainWindowShell-1202"><a href="#MainWindowShell-1202"><span class="linenos">1202</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">reset_database_action</span><span class="p">)</span>
</span><span id="MainWindowShell-1203"><a href="#MainWindowShell-1203"><span class="linenos">1203</span></a>
</span><span id="MainWindowShell-1204"><a href="#MainWindowShell-1204"><span class="linenos">1204</span></a>        <span class="c1"># File &gt; Normalize database</span>
</span><span id="MainWindowShell-1205"><a href="#MainWindowShell-1205"><span class="linenos">1205</span></a>        <span class="n">normalize_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1206"><a href="#MainWindowShell-1206"><span class="linenos">1206</span></a>            <span class="s2">&quot;fa.bar-chart-o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">))</span>
</span><span id="MainWindowShell-1207"><a href="#MainWindowShell-1207"><span class="linenos">1207</span></a>        <span class="n">normalize_database_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span>
</span><span id="MainWindowShell-1208"><a href="#MainWindowShell-1208"><span class="linenos">1208</span></a>            <span class="n">normalize_icon</span><span class="p">,</span> <span class="s2">&quot;Fill in columns&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1209"><a href="#MainWindowShell-1209"><span class="linenos">1209</span></a>        <span class="n">normalize_database_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell-1210"><a href="#MainWindowShell-1210"><span class="linenos">1210</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">fill_columns</span><span class="p">)</span>
</span><span id="MainWindowShell-1211"><a href="#MainWindowShell-1211"><span class="linenos">1211</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">normalize_database_action</span><span class="p">)</span>
</span><span id="MainWindowShell-1212"><a href="#MainWindowShell-1212"><span class="linenos">1212</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
</span><span id="MainWindowShell-1213"><a href="#MainWindowShell-1213"><span class="linenos">1213</span></a>
</span><span id="MainWindowShell-1214"><a href="#MainWindowShell-1214"><span class="linenos">1214</span></a>        <span class="c1"># Return Home option : File &gt; Return Home</span>
</span><span id="MainWindowShell-1215"><a href="#MainWindowShell-1215"><span class="linenos">1215</span></a>        <span class="n">home_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1216"><a href="#MainWindowShell-1216"><span class="linenos">1216</span></a>            <span class="s2">&quot;mdi.home&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span><span class="p">)</span>
</span><span id="MainWindowShell-1217"><a href="#MainWindowShell-1217"><span class="linenos">1217</span></a>        <span class="n">return_home_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">home_icon</span><span class="p">,</span> <span class="s2">&quot;Return Home&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1218"><a href="#MainWindowShell-1218"><span class="linenos">1218</span></a>
</span><span id="MainWindowShell-1219"><a href="#MainWindowShell-1219"><span class="linenos">1219</span></a>        <span class="n">return_home_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">show_home_page</span><span class="p">)</span>
</span><span id="MainWindowShell-1220"><a href="#MainWindowShell-1220"><span class="linenos">1220</span></a>        <span class="n">return_home_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+H&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell-1221"><a href="#MainWindowShell-1221"><span class="linenos">1221</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">return_home_action</span><span class="p">)</span>
</span><span id="MainWindowShell-1222"><a href="#MainWindowShell-1222"><span class="linenos">1222</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
</span><span id="MainWindowShell-1223"><a href="#MainWindowShell-1223"><span class="linenos">1223</span></a>
</span><span id="MainWindowShell-1224"><a href="#MainWindowShell-1224"><span class="linenos">1224</span></a>        <span class="c1"># Exit option : File &gt; Exit</span>
</span><span id="MainWindowShell-1225"><a href="#MainWindowShell-1225"><span class="linenos">1225</span></a>        <span class="n">exit_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Exit&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1226"><a href="#MainWindowShell-1226"><span class="linenos">1226</span></a>        <span class="n">exit_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+Q&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell-1227"><a href="#MainWindowShell-1227"><span class="linenos">1227</span></a>        <span class="n">exit_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
</span><span id="MainWindowShell-1228"><a href="#MainWindowShell-1228"><span class="linenos">1228</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">exit_action</span><span class="p">)</span>
</span><span id="MainWindowShell-1229"><a href="#MainWindowShell-1229"><span class="linenos">1229</span></a>
</span><span id="MainWindowShell-1230"><a href="#MainWindowShell-1230"><span class="linenos">1230</span></a>        <span class="c1"># -- Edit menu</span>
</span><span id="MainWindowShell-1231"><a href="#MainWindowShell-1231"><span class="linenos">1231</span></a>        <span class="n">duplicates_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1232"><a href="#MainWindowShell-1232"><span class="linenos">1232</span></a>            <span class="s2">&quot;mdi6.content-duplicate&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="MainWindowShell-1233"><a href="#MainWindowShell-1233"><span class="linenos">1233</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1234"><a href="#MainWindowShell-1234"><span class="linenos">1234</span></a>        <span class="c1"># Remove Duplicates option : Edit &gt; Check for duplicates</span>
</span><span id="MainWindowShell-1235"><a href="#MainWindowShell-1235"><span class="linenos">1235</span></a>        <span class="n">check_for_duplicates_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span>
</span><span id="MainWindowShell-1236"><a href="#MainWindowShell-1236"><span class="linenos">1236</span></a>            <span class="n">duplicates_icon</span><span class="p">,</span> <span class="s2">&quot;Check for duplicates&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1237"><a href="#MainWindowShell-1237"><span class="linenos">1237</span></a>        <span class="n">check_for_duplicates_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+D&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell-1238"><a href="#MainWindowShell-1238"><span class="linenos">1238</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Edit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">check_for_duplicates_action</span><span class="p">)</span>
</span><span id="MainWindowShell-1239"><a href="#MainWindowShell-1239"><span class="linenos">1239</span></a>        <span class="n">check_for_duplicates_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell-1240"><a href="#MainWindowShell-1240"><span class="linenos">1240</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">check_for_duplicates_popup</span><span class="p">)</span>
</span><span id="MainWindowShell-1241"><a href="#MainWindowShell-1241"><span class="linenos">1241</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Edit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
</span><span id="MainWindowShell-1242"><a href="#MainWindowShell-1242"><span class="linenos">1242</span></a>        <span class="c1"># Insert Item option : Edit &gt; Insert Item</span>
</span><span id="MainWindowShell-1243"><a href="#MainWindowShell-1243"><span class="linenos">1243</span></a>        <span class="n">insert_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1244"><a href="#MainWindowShell-1244"><span class="linenos">1244</span></a>            <span class="s2">&quot;mdi.plus-box-outline&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="MainWindowShell-1245"><a href="#MainWindowShell-1245"><span class="linenos">1245</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1246"><a href="#MainWindowShell-1246"><span class="linenos">1246</span></a>        <span class="n">insert_item_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">insert_icon</span><span class="p">,</span> <span class="s2">&quot;Insert Item&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1247"><a href="#MainWindowShell-1247"><span class="linenos">1247</span></a>        <span class="n">insert_item_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+I&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell-1248"><a href="#MainWindowShell-1248"><span class="linenos">1248</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Edit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">insert_item_action</span><span class="p">)</span>
</span><span id="MainWindowShell-1249"><a href="#MainWindowShell-1249"><span class="linenos">1249</span></a>        <span class="n">insert_item_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">insert_item</span><span class="p">)</span>
</span><span id="MainWindowShell-1250"><a href="#MainWindowShell-1250"><span class="linenos">1250</span></a>        <span class="c1"># Edit Item option : Edit &gt; Edit Item</span>
</span><span id="MainWindowShell-1251"><a href="#MainWindowShell-1251"><span class="linenos">1251</span></a>        <span class="n">edit_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1252"><a href="#MainWindowShell-1252"><span class="linenos">1252</span></a>            <span class="s2">&quot;mdi6.database-edit-outline&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span><span class="p">)</span>
</span><span id="MainWindowShell-1253"><a href="#MainWindowShell-1253"><span class="linenos">1253</span></a>        <span class="n">edit_item_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">edit_icon</span><span class="p">,</span> <span class="s2">&quot;Edit Item&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1254"><a href="#MainWindowShell-1254"><span class="linenos">1254</span></a>        <span class="c1"># edit_item_action.triggered.connect(</span>
</span><span id="MainWindowShell-1255"><a href="#MainWindowShell-1255"><span class="linenos">1255</span></a>        <span class="c1">#     partial(self.stackedwidget.edit_item, item=None))</span>
</span><span id="MainWindowShell-1256"><a href="#MainWindowShell-1256"><span class="linenos">1256</span></a>        <span class="n">edit_item_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell-1257"><a href="#MainWindowShell-1257"><span class="linenos">1257</span></a>            <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">edit_app_item</span><span class="p">,</span> <span class="n">input_arg</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
</span><span id="MainWindowShell-1258"><a href="#MainWindowShell-1258"><span class="linenos">1258</span></a>        <span class="n">edit_item_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+E&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell-1259"><a href="#MainWindowShell-1259"><span class="linenos">1259</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Edit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">edit_item_action</span><span class="p">)</span>
</span><span id="MainWindowShell-1260"><a href="#MainWindowShell-1260"><span class="linenos">1260</span></a>
</span><span id="MainWindowShell-1261"><a href="#MainWindowShell-1261"><span class="linenos">1261</span></a>        <span class="c1"># -- View menu</span>
</span><span id="MainWindowShell-1262"><a href="#MainWindowShell-1262"><span class="linenos">1262</span></a>        <span class="c1"># Options to view each manufacturer spreadsheet</span>
</span><span id="MainWindowShell-1263"><a href="#MainWindowShell-1263"><span class="linenos">1263</span></a>        <span class="n">actions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MainWindowShell-1264"><a href="#MainWindowShell-1264"><span class="linenos">1264</span></a>        <span class="k">for</span> <span class="n">mfr</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;dell&quot;</span><span class="p">,</span> <span class="s2">&quot;hp&quot;</span><span class="p">,</span> <span class="s2">&quot;lexmark&quot;</span><span class="p">,</span> <span class="s2">&quot;others&quot;</span><span class="p">]:</span>
</span><span id="MainWindowShell-1265"><a href="#MainWindowShell-1265"><span class="linenos">1265</span></a>            <span class="n">actions</span><span class="p">[</span><span class="n">mfr</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mfr</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> spreadsheet&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1266"><a href="#MainWindowShell-1266"><span class="linenos">1266</span></a>            <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;View&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">mfr</span><span class="p">])</span>
</span><span id="MainWindowShell-1267"><a href="#MainWindowShell-1267"><span class="linenos">1267</span></a>            <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;View&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
</span><span id="MainWindowShell-1268"><a href="#MainWindowShell-1268"><span class="linenos">1268</span></a>            <span class="c1"># connect to show table</span>
</span><span id="MainWindowShell-1269"><a href="#MainWindowShell-1269"><span class="linenos">1269</span></a>            <span class="n">actions</span><span class="p">[</span><span class="n">mfr</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell-1270"><a href="#MainWindowShell-1270"><span class="linenos">1270</span></a>                <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">show_table_page</span><span class="p">,</span> <span class="n">manufacturer</span><span class="o">=</span><span class="n">mfr</span><span class="p">))</span>
</span><span id="MainWindowShell-1271"><a href="#MainWindowShell-1271"><span class="linenos">1271</span></a>
</span><span id="MainWindowShell-1272"><a href="#MainWindowShell-1272"><span class="linenos">1272</span></a>        <span class="c1"># -- Settings menu</span>
</span><span id="MainWindowShell-1273"><a href="#MainWindowShell-1273"><span class="linenos">1273</span></a>        <span class="c1"># Display theme toggle : Settings &gt; Dark/Light mode</span>
</span><span id="MainWindowShell-1274"><a href="#MainWindowShell-1274"><span class="linenos">1274</span></a>        <span class="n">theme_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1275"><a href="#MainWindowShell-1275"><span class="linenos">1275</span></a>            <span class="s2">&quot;mdi6.monitor-eye&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="MainWindowShell-1276"><a href="#MainWindowShell-1276"><span class="linenos">1276</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1277"><a href="#MainWindowShell-1277"><span class="linenos">1277</span></a>        <span class="n">change_display_mode</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">theme_icon</span><span class="p">,</span> <span class="s2">&quot;Change theme&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1278"><a href="#MainWindowShell-1278"><span class="linenos">1278</span></a>        <span class="n">change_display_mode</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="MainWindowShell-1279"><a href="#MainWindowShell-1279"><span class="linenos">1279</span></a>            <span class="s2">&quot;Change the QSS stylesheet (theme) for the application.&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell-1280"><a href="#MainWindowShell-1280"><span class="linenos">1280</span></a>        <span class="n">change_display_mode</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell-1281"><a href="#MainWindowShell-1281"><span class="linenos">1281</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_theme_dialog</span><span class="p">)</span>
</span><span id="MainWindowShell-1282"><a href="#MainWindowShell-1282"><span class="linenos">1282</span></a>
</span><span id="MainWindowShell-1283"><a href="#MainWindowShell-1283"><span class="linenos">1283</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Settings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">change_display_mode</span><span class="p">)</span>
</span><span id="MainWindowShell-1284"><a href="#MainWindowShell-1284"><span class="linenos">1284</span></a>        <span class="c1"># change table columns</span>
</span><span id="MainWindowShell-1285"><a href="#MainWindowShell-1285"><span class="linenos">1285</span></a>        <span class="n">change_table_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1286"><a href="#MainWindowShell-1286"><span class="linenos">1286</span></a>            <span class="s2">&quot;ri.insert-column-left&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="MainWindowShell-1287"><a href="#MainWindowShell-1287"><span class="linenos">1287</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1288"><a href="#MainWindowShell-1288"><span class="linenos">1288</span></a>        <span class="n">change_table_columns</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span>
</span><span id="MainWindowShell-1289"><a href="#MainWindowShell-1289"><span class="linenos">1289</span></a>            <span class="n">change_table_icon</span><span class="p">,</span> <span class="s2">&quot;Choose columns&quot;</span><span class="p">,</span> <span class="bp">self</span>
</span><span id="MainWindowShell-1290"><a href="#MainWindowShell-1290"><span class="linenos">1290</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1291"><a href="#MainWindowShell-1291"><span class="linenos">1291</span></a>        <span class="n">change_table_columns</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="MainWindowShell-1292"><a href="#MainWindowShell-1292"><span class="linenos">1292</span></a>            <span class="s2">&quot;Add or substract from current columns being shown on a table.&quot;</span>
</span><span id="MainWindowShell-1293"><a href="#MainWindowShell-1293"><span class="linenos">1293</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1294"><a href="#MainWindowShell-1294"><span class="linenos">1294</span></a>        <span class="n">change_table_columns</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell-1295"><a href="#MainWindowShell-1295"><span class="linenos">1295</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_column_dialog</span><span class="p">)</span>
</span><span id="MainWindowShell-1296"><a href="#MainWindowShell-1296"><span class="linenos">1296</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Settings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">change_table_columns</span><span class="p">)</span>
</span><span id="MainWindowShell-1297"><a href="#MainWindowShell-1297"><span class="linenos">1297</span></a>
</span><span id="MainWindowShell-1298"><a href="#MainWindowShell-1298"><span class="linenos">1298</span></a>        <span class="c1"># View ALL SETTINGS option : Settings &gt; View all settings</span>
</span><span id="MainWindowShell-1299"><a href="#MainWindowShell-1299"><span class="linenos">1299</span></a>        <span class="n">view_settings_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1300"><a href="#MainWindowShell-1300"><span class="linenos">1300</span></a>            <span class="s1">&#39;mdi6.cog&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span><span class="p">)</span>
</span><span id="MainWindowShell-1301"><a href="#MainWindowShell-1301"><span class="linenos">1301</span></a>        <span class="n">view_settings_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span>
</span><span id="MainWindowShell-1302"><a href="#MainWindowShell-1302"><span class="linenos">1302</span></a>            <span class="n">view_settings_icon</span><span class="p">,</span> <span class="s2">&quot;View all settings&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1303"><a href="#MainWindowShell-1303"><span class="linenos">1303</span></a>        <span class="n">view_settings_action</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;View all settings in the app.&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell-1304"><a href="#MainWindowShell-1304"><span class="linenos">1304</span></a>        <span class="n">view_settings_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell-1305"><a href="#MainWindowShell-1305"><span class="linenos">1305</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_settings_dialog</span><span class="p">)</span>
</span><span id="MainWindowShell-1306"><a href="#MainWindowShell-1306"><span class="linenos">1306</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Settings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">view_settings_action</span><span class="p">)</span>
</span><span id="MainWindowShell-1307"><a href="#MainWindowShell-1307"><span class="linenos">1307</span></a>
</span><span id="MainWindowShell-1308"><a href="#MainWindowShell-1308"><span class="linenos">1308</span></a>        <span class="c1"># -- Help menu</span>
</span><span id="MainWindowShell-1309"><a href="#MainWindowShell-1309"><span class="linenos">1309</span></a>        <span class="c1"># About option : Help &gt; About</span>
</span><span id="MainWindowShell-1310"><a href="#MainWindowShell-1310"><span class="linenos">1310</span></a>        <span class="n">about_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1311"><a href="#MainWindowShell-1311"><span class="linenos">1311</span></a>            <span class="s2">&quot;mdi.information-outline&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="MainWindowShell-1312"><a href="#MainWindowShell-1312"><span class="linenos">1312</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1313"><a href="#MainWindowShell-1313"><span class="linenos">1313</span></a>        <span class="n">about_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">about_icon</span><span class="p">,</span> <span class="s2">&quot;About&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1314"><a href="#MainWindowShell-1314"><span class="linenos">1314</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Help&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">about_action</span><span class="p">)</span>
</span><span id="MainWindowShell-1315"><a href="#MainWindowShell-1315"><span class="linenos">1315</span></a>        <span class="n">about_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_help_dialog</span><span class="p">)</span>
</span><span id="MainWindowShell-1316"><a href="#MainWindowShell-1316"><span class="linenos">1316</span></a>
</span><span id="MainWindowShell-1317"><a href="#MainWindowShell-1317"><span class="linenos">1317</span></a>        <span class="c1"># ------------------------------------</span>
</span><span id="MainWindowShell-1318"><a href="#MainWindowShell-1318"><span class="linenos">1318</span></a>        <span class="c1"># TOOLBAR UNDERNEATH MAIN MENU (self.secondary_toolbar)</span>
</span><span id="MainWindowShell-1319"><a href="#MainWindowShell-1319"><span class="linenos">1319</span></a>        <span class="n">secondary_toolbar</span> <span class="o">=</span> <span class="n">TonerToolbar</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1320"><a href="#MainWindowShell-1320"><span class="linenos">1320</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addToolBar</span><span class="p">(</span><span class="n">secondary_toolbar</span><span class="p">)</span>
</span><span id="MainWindowShell-1321"><a href="#MainWindowShell-1321"><span class="linenos">1321</span></a>        <span class="n">toolbaricons</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MainWindowShell-1322"><a href="#MainWindowShell-1322"><span class="linenos">1322</span></a>        <span class="n">toolbaractions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MainWindowShell-1323"><a href="#MainWindowShell-1323"><span class="linenos">1323</span></a>        <span class="c1"># return home button</span>
</span><span id="MainWindowShell-1324"><a href="#MainWindowShell-1324"><span class="linenos">1324</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;home&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1325"><a href="#MainWindowShell-1325"><span class="linenos">1325</span></a>            <span class="s2">&quot;mdi6.home&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span>
</span><span id="MainWindowShell-1326"><a href="#MainWindowShell-1326"><span class="linenos">1326</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1327"><a href="#MainWindowShell-1327"><span class="linenos">1327</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;home&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1328"><a href="#MainWindowShell-1328"><span class="linenos">1328</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Return to home page.&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell-1329"><a href="#MainWindowShell-1329"><span class="linenos">1329</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell-1330"><a href="#MainWindowShell-1330"><span class="linenos">1330</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">show_home_page</span><span class="p">)</span>
</span><span id="MainWindowShell-1331"><a href="#MainWindowShell-1331"><span class="linenos">1331</span></a>        <span class="c1"># settings button</span>
</span><span id="MainWindowShell-1332"><a href="#MainWindowShell-1332"><span class="linenos">1332</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1333"><a href="#MainWindowShell-1333"><span class="linenos">1333</span></a>            <span class="s1">&#39;ei.cogs&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
</span><span id="MainWindowShell-1334"><a href="#MainWindowShell-1334"><span class="linenos">1334</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1335"><a href="#MainWindowShell-1335"><span class="linenos">1335</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Open settings dialog.&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell-1336"><a href="#MainWindowShell-1336"><span class="linenos">1336</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell-1337"><a href="#MainWindowShell-1337"><span class="linenos">1337</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_settings_dialog</span><span class="p">)</span>
</span><span id="MainWindowShell-1338"><a href="#MainWindowShell-1338"><span class="linenos">1338</span></a>        <span class="c1"># database backup</span>
</span><span id="MainWindowShell-1339"><a href="#MainWindowShell-1339"><span class="linenos">1339</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;backup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s1">&#39;mdi.database-arrow-down&#39;</span><span class="p">,</span>
</span><span id="MainWindowShell-1340"><a href="#MainWindowShell-1340"><span class="linenos">1340</span></a>                                                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
</span><span id="MainWindowShell-1341"><a href="#MainWindowShell-1341"><span class="linenos">1341</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;backup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1342"><a href="#MainWindowShell-1342"><span class="linenos">1342</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;backup&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="MainWindowShell-1343"><a href="#MainWindowShell-1343"><span class="linenos">1343</span></a>            <span class="s2">&quot;Backup the database to a file on your computer.&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell-1344"><a href="#MainWindowShell-1344"><span class="linenos">1344</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;backup&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell-1345"><a href="#MainWindowShell-1345"><span class="linenos">1345</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">backup_to_csv</span><span class="p">)</span>
</span><span id="MainWindowShell-1346"><a href="#MainWindowShell-1346"><span class="linenos">1346</span></a>        <span class="c1"># search button</span>
</span><span id="MainWindowShell-1347"><a href="#MainWindowShell-1347"><span class="linenos">1347</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;search&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1348"><a href="#MainWindowShell-1348"><span class="linenos">1348</span></a>            <span class="s2">&quot;mdi6.printer-search&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span>
</span><span id="MainWindowShell-1349"><a href="#MainWindowShell-1349"><span class="linenos">1349</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1350"><a href="#MainWindowShell-1350"><span class="linenos">1350</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;search&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1351"><a href="#MainWindowShell-1351"><span class="linenos">1351</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;search&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="MainWindowShell-1352"><a href="#MainWindowShell-1352"><span class="linenos">1352</span></a>            <span class="s2">&quot;Search the database by any of it&#39;s existing columns.&quot;</span>
</span><span id="MainWindowShell-1353"><a href="#MainWindowShell-1353"><span class="linenos">1353</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1354"><a href="#MainWindowShell-1354"><span class="linenos">1354</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;search&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell-1355"><a href="#MainWindowShell-1355"><span class="linenos">1355</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_search_dialog</span><span class="p">)</span>
</span><span id="MainWindowShell-1356"><a href="#MainWindowShell-1356"><span class="linenos">1356</span></a>
</span><span id="MainWindowShell-1357"><a href="#MainWindowShell-1357"><span class="linenos">1357</span></a>        <span class="c1"># open scan input window</span>
</span><span id="MainWindowShell-1358"><a href="#MainWindowShell-1358"><span class="linenos">1358</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;barcode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1359"><a href="#MainWindowShell-1359"><span class="linenos">1359</span></a>            <span class="s2">&quot;mdi6.barcode-scan&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span>
</span><span id="MainWindowShell-1360"><a href="#MainWindowShell-1360"><span class="linenos">1360</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1361"><a href="#MainWindowShell-1361"><span class="linenos">1361</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;barcode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1362"><a href="#MainWindowShell-1362"><span class="linenos">1362</span></a>        <span class="n">secondary_toolbar</span><span class="o">.</span><span class="n">setIconSize</span><span class="p">(</span><span class="n">QSize</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
</span><span id="MainWindowShell-1363"><a href="#MainWindowShell-1363"><span class="linenos">1363</span></a>        <span class="c1"># toolbaractions[&quot;barcode&quot;].setIcon(toolbaricons[&quot;barcode&quot;])</span>
</span><span id="MainWindowShell-1364"><a href="#MainWindowShell-1364"><span class="linenos">1364</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;barcode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="MainWindowShell-1365"><a href="#MainWindowShell-1365"><span class="linenos">1365</span></a>            <span class="s2">&quot;Place cursor inside the textbox that opens and begin scanning items, turn up volume please.&quot;</span>
</span><span id="MainWindowShell-1366"><a href="#MainWindowShell-1366"><span class="linenos">1366</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1367"><a href="#MainWindowShell-1367"><span class="linenos">1367</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;barcode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+B&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell-1368"><a href="#MainWindowShell-1368"><span class="linenos">1368</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;barcode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell-1369"><a href="#MainWindowShell-1369"><span class="linenos">1369</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_scan_dialog</span><span class="p">)</span>
</span><span id="MainWindowShell-1370"><a href="#MainWindowShell-1370"><span class="linenos">1370</span></a>
</span><span id="MainWindowShell-1371"><a href="#MainWindowShell-1371"><span class="linenos">1371</span></a>        <span class="c1"># -- Import UPC FILE option : on the secondary toolbar</span>
</span><span id="MainWindowShell-1372"><a href="#MainWindowShell-1372"><span class="linenos">1372</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;import&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1373"><a href="#MainWindowShell-1373"><span class="linenos">1373</span></a>            <span class="s2">&quot;fa5s.file-import&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.60</span>
</span><span id="MainWindowShell-1374"><a href="#MainWindowShell-1374"><span class="linenos">1374</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1375"><a href="#MainWindowShell-1375"><span class="linenos">1375</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;import&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1376"><a href="#MainWindowShell-1376"><span class="linenos">1376</span></a>        <span class="c1"># toolbaractions[&quot;import&quot;].setIcon(toolbaricons[&quot;import&quot;])</span>
</span><span id="MainWindowShell-1377"><a href="#MainWindowShell-1377"><span class="linenos">1377</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;import&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="MainWindowShell-1378"><a href="#MainWindowShell-1378"><span class="linenos">1378</span></a>            <span class="s2">&quot;Import .txt File containing 1 UPC code per line&quot;</span>
</span><span id="MainWindowShell-1379"><a href="#MainWindowShell-1379"><span class="linenos">1379</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1380"><a href="#MainWindowShell-1380"><span class="linenos">1380</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;import&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+I&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell-1381"><a href="#MainWindowShell-1381"><span class="linenos">1381</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;import&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell-1382"><a href="#MainWindowShell-1382"><span class="linenos">1382</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">import_item_list</span><span class="p">)</span>
</span><span id="MainWindowShell-1383"><a href="#MainWindowShell-1383"><span class="linenos">1383</span></a>
</span><span id="MainWindowShell-1384"><a href="#MainWindowShell-1384"><span class="linenos">1384</span></a>        <span class="c1"># -- Export to Excel button</span>
</span><span id="MainWindowShell-1385"><a href="#MainWindowShell-1385"><span class="linenos">1385</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;export&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell-1386"><a href="#MainWindowShell-1386"><span class="linenos">1386</span></a>            <span class="s2">&quot;mdi6.microsoft-excel&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span>
</span><span id="MainWindowShell-1387"><a href="#MainWindowShell-1387"><span class="linenos">1387</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1388"><a href="#MainWindowShell-1388"><span class="linenos">1388</span></a>
</span><span id="MainWindowShell-1389"><a href="#MainWindowShell-1389"><span class="linenos">1389</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;export&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell-1390"><a href="#MainWindowShell-1390"><span class="linenos">1390</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;export&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="MainWindowShell-1391"><a href="#MainWindowShell-1391"><span class="linenos">1391</span></a>            <span class="s2">&quot;Export the current inventory to .xlsx spreadsheet&quot;</span>
</span><span id="MainWindowShell-1392"><a href="#MainWindowShell-1392"><span class="linenos">1392</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell-1393"><a href="#MainWindowShell-1393"><span class="linenos">1393</span></a>        <span class="n">secondary_toolbar</span><span class="o">.</span><span class="n">setIconSize</span><span class="p">(</span><span class="n">QSize</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
</span><span id="MainWindowShell-1394"><a href="#MainWindowShell-1394"><span class="linenos">1394</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;export&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+E&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell-1395"><a href="#MainWindowShell-1395"><span class="linenos">1395</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;export&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell-1396"><a href="#MainWindowShell-1396"><span class="linenos">1396</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">export_to_excel</span><span class="p">)</span>
</span><span id="MainWindowShell-1397"><a href="#MainWindowShell-1397"><span class="linenos">1397</span></a>
</span><span id="MainWindowShell-1398"><a href="#MainWindowShell-1398"><span class="linenos">1398</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">qaction</span> <span class="ow">in</span> <span class="n">toolbaractions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="MainWindowShell-1399"><a href="#MainWindowShell-1399"><span class="linenos">1399</span></a>            <span class="n">qaction</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">toolbaricons</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="MainWindowShell-1400"><a href="#MainWindowShell-1400"><span class="linenos">1400</span></a>            <span class="n">secondary_toolbar</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">qaction</span><span class="p">)</span>
</span><span id="MainWindowShell-1401"><a href="#MainWindowShell-1401"><span class="linenos">1401</span></a>            <span class="c1"># self.stackedwidget.secondary_toolbar.addSeparator()</span>
</span><span id="MainWindowShell-1402"><a href="#MainWindowShell-1402"><span class="linenos">1402</span></a>
</span><span id="MainWindowShell-1403"><a href="#MainWindowShell-1403"><span class="linenos">1403</span></a>    <span class="k">def</span> <span class="nf">closeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="MainWindowShell-1404"><a href="#MainWindowShell-1404"><span class="linenos">1404</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;closeEvent Overrides the default closeEvent to prompt user to confirm they want to close the application.&quot;&quot;&quot;</span>
</span><span id="MainWindowShell-1405"><a href="#MainWindowShell-1405"><span class="linenos">1405</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">safety_net</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MainWindowShell-1406"><a href="#MainWindowShell-1406"><span class="linenos">1406</span></a>            <span class="n">close_warning</span> <span class="o">=</span> <span class="n">WarningPopup</span><span class="p">(</span>
</span><span id="MainWindowShell-1407"><a href="#MainWindowShell-1407"><span class="linenos">1407</span></a>                <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Exit&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Are you sure you want to exit?&quot;</span>
</span><span id="MainWindowShell-1408"><a href="#MainWindowShell-1408"><span class="linenos">1408</span></a>            <span class="p">)</span>
</span><span id="MainWindowShell-1409"><a href="#MainWindowShell-1409"><span class="linenos">1409</span></a>            <span class="c1"># close_warning.setStyleSheet(self.current_style)</span>
</span><span id="MainWindowShell-1410"><a href="#MainWindowShell-1410"><span class="linenos">1410</span></a>            <span class="k">if</span> <span class="n">close_warning</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span> <span class="o">==</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
</span><span id="MainWindowShell-1411"><a href="#MainWindowShell-1411"><span class="linenos">1411</span></a>                <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
</span><span id="MainWindowShell-1412"><a href="#MainWindowShell-1412"><span class="linenos">1412</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="MainWindowShell-1413"><a href="#MainWindowShell-1413"><span class="linenos">1413</span></a>                <span class="n">event</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
</span><span id="MainWindowShell-1414"><a href="#MainWindowShell-1414"><span class="linenos">1414</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MainWindowShell-1415"><a href="#MainWindowShell-1415"><span class="linenos">1415</span></a>            <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>QMainWindow(parent: typing.Optional[QWidget] = None, flags: Union[Qt.WindowFlags, Qt.WindowType] = Qt.WindowFlags())</p>
</div>


                            <div id="MainWindowShell.__init__" class="classattr">
                                        <input id="MainWindowShell.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">MainWindowShell</span><span class="signature pdoc-code condensed">()</span>

                <label class="view-source-button" for="MainWindowShell.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MainWindowShell.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MainWindowShell.__init__-1147"><a href="#MainWindowShell.__init__-1147"><span class="linenos">1147</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MainWindowShell.__init__-1148"><a href="#MainWindowShell.__init__-1148"><span class="linenos">1148</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MainWindowShell.__init__-1149"><a href="#MainWindowShell.__init__-1149"><span class="linenos">1149</span></a><span class="sd">        __init__ This QMainWindow holds the QStackedWidget which makes up the core of the application. The QStackedWidget stacks widgets on top of each other, and can switch between them.</span>
</span><span id="MainWindowShell.__init__-1150"><a href="#MainWindowShell.__init__-1150"><span class="linenos">1150</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MainWindowShell.__init__-1151"><a href="#MainWindowShell.__init__-1151"><span class="linenos">1151</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="MainWindowShell.__init__-1152"><a href="#MainWindowShell.__init__-1152"><span class="linenos">1152</span></a>        <span class="n">initialize_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.__init__-1153"><a href="#MainWindowShell.__init__-1153"><span class="linenos">1153</span></a>
</span><span id="MainWindowShell.__init__-1154"><a href="#MainWindowShell.__init__-1154"><span class="linenos">1154</span></a>        <span class="c1"># set basic window details</span>
</span><span id="MainWindowShell.__init__-1155"><a href="#MainWindowShell.__init__-1155"><span class="linenos">1155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">app_name</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell.__init__-1156"><a href="#MainWindowShell.__init__-1156"><span class="linenos">1156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">))</span>
</span><span id="MainWindowShell.__init__-1157"><a href="#MainWindowShell.__init__-1157"><span class="linenos">1157</span></a>
</span><span id="MainWindowShell.__init__-1158"><a href="#MainWindowShell.__init__-1158"><span class="linenos">1158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span> <span class="o">=</span> <span class="n">StackedApp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.__init__-1159"><a href="#MainWindowShell.__init__-1159"><span class="linenos">1159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_menu</span><span class="p">()</span>
</span><span id="MainWindowShell.__init__-1160"><a href="#MainWindowShell.__init__-1160"><span class="linenos">1160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>__init__ This QMainWindow holds the QStackedWidget which makes up the core of the application. The QStackedWidget stacks widgets on top of each other, and can switch between them.</p>
</div>


                            </div>
                            <div id="MainWindowShell.build_menu" class="classattr">
                                        <input id="MainWindowShell.build_menu-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">build_menu</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MainWindowShell.build_menu-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MainWindowShell.build_menu"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MainWindowShell.build_menu-1162"><a href="#MainWindowShell.build_menu-1162"><span class="linenos">1162</span></a>    <span class="k">def</span> <span class="nf">build_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MainWindowShell.build_menu-1163"><a href="#MainWindowShell.build_menu-1163"><span class="linenos">1163</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MainWindowShell.build_menu-1164"><a href="#MainWindowShell.build_menu-1164"><span class="linenos">1164</span></a><span class="sd">        build_menu Creates the main MenuBar for the app, as well as the secondary toolbar which is directly underneath the main menubar. Adds icons and actions to the menubar and toolbar buttons.</span>
</span><span id="MainWindowShell.build_menu-1165"><a href="#MainWindowShell.build_menu-1165"><span class="linenos">1165</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MainWindowShell.build_menu-1166"><a href="#MainWindowShell.build_menu-1166"><span class="linenos">1166</span></a>        <span class="c1"># TODO: Look for more efficient way to build main menubar and secondary toolbar.</span>
</span><span id="MainWindowShell.build_menu-1167"><a href="#MainWindowShell.build_menu-1167"><span class="linenos">1167</span></a>        <span class="c1"># ------------------------------------</span>
</span><span id="MainWindowShell.build_menu-1168"><a href="#MainWindowShell.build_menu-1168"><span class="linenos">1168</span></a>        <span class="c1"># MAIN MENUBAR:</span>
</span><span id="MainWindowShell.build_menu-1169"><a href="#MainWindowShell.build_menu-1169"><span class="linenos">1169</span></a>        <span class="n">menubar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span>
</span><span id="MainWindowShell.build_menu-1170"><a href="#MainWindowShell.build_menu-1170"><span class="linenos">1170</span></a>        <span class="c1"># TOP/MAIN MENU OPTIONS:</span>
</span><span id="MainWindowShell.build_menu-1171"><a href="#MainWindowShell.build_menu-1171"><span class="linenos">1171</span></a>        <span class="n">menubar_option_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;Edit&quot;</span><span class="p">,</span> <span class="s2">&quot;View&quot;</span><span class="p">,</span> <span class="s2">&quot;Settings&quot;</span><span class="p">,</span> <span class="s2">&quot;Help&quot;</span><span class="p">]</span>
</span><span id="MainWindowShell.build_menu-1172"><a href="#MainWindowShell.build_menu-1172"><span class="linenos">1172</span></a>        <span class="c1"># create the top/main menu options</span>
</span><span id="MainWindowShell.build_menu-1173"><a href="#MainWindowShell.build_menu-1173"><span class="linenos">1173</span></a>        <span class="n">menubar_options</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MainWindowShell.build_menu-1174"><a href="#MainWindowShell.build_menu-1174"><span class="linenos">1174</span></a>        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">menubar_option_names</span><span class="p">:</span>
</span><span id="MainWindowShell.build_menu-1175"><a href="#MainWindowShell.build_menu-1175"><span class="linenos">1175</span></a>            <span class="n">menubar_options</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1176"><a href="#MainWindowShell.build_menu-1176"><span class="linenos">1176</span></a>
</span><span id="MainWindowShell.build_menu-1177"><a href="#MainWindowShell.build_menu-1177"><span class="linenos">1177</span></a>        <span class="c1"># -- File menu</span>
</span><span id="MainWindowShell.build_menu-1178"><a href="#MainWindowShell.build_menu-1178"><span class="linenos">1178</span></a>        <span class="c1">#  Search function : File &gt; Search</span>
</span><span id="MainWindowShell.build_menu-1179"><a href="#MainWindowShell.build_menu-1179"><span class="linenos">1179</span></a>        <span class="n">search_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s2">&quot;fa5s.search&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">))</span>
</span><span id="MainWindowShell.build_menu-1180"><a href="#MainWindowShell.build_menu-1180"><span class="linenos">1180</span></a>        <span class="n">search_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">search_icon</span><span class="p">,</span> <span class="s2">&quot;Search&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1181"><a href="#MainWindowShell.build_menu-1181"><span class="linenos">1181</span></a>
</span><span id="MainWindowShell.build_menu-1182"><a href="#MainWindowShell.build_menu-1182"><span class="linenos">1182</span></a>        <span class="n">search_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+F&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1183"><a href="#MainWindowShell.build_menu-1183"><span class="linenos">1183</span></a>        <span class="n">search_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_search_dialog</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1184"><a href="#MainWindowShell.build_menu-1184"><span class="linenos">1184</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">search_action</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1185"><a href="#MainWindowShell.build_menu-1185"><span class="linenos">1185</span></a>
</span><span id="MainWindowShell.build_menu-1186"><a href="#MainWindowShell.build_menu-1186"><span class="linenos">1186</span></a>        <span class="c1"># Import upcs option : File &gt; Import UPCs</span>
</span><span id="MainWindowShell.build_menu-1187"><a href="#MainWindowShell.build_menu-1187"><span class="linenos">1187</span></a>        <span class="n">qtimporticon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1188"><a href="#MainWindowShell.build_menu-1188"><span class="linenos">1188</span></a>            <span class="s2">&quot;mdi.import&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="MainWindowShell.build_menu-1189"><a href="#MainWindowShell.build_menu-1189"><span class="linenos">1189</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1190"><a href="#MainWindowShell.build_menu-1190"><span class="linenos">1190</span></a>        <span class="n">import_item_list_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1191"><a href="#MainWindowShell.build_menu-1191"><span class="linenos">1191</span></a>            <span class="n">qtimporticon</span><span class="p">,</span> <span class="s2">&quot;Import UPC File&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1192"><a href="#MainWindowShell.build_menu-1192"><span class="linenos">1192</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">import_item_list_action</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1193"><a href="#MainWindowShell.build_menu-1193"><span class="linenos">1193</span></a>        <span class="n">import_item_list_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1194"><a href="#MainWindowShell.build_menu-1194"><span class="linenos">1194</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">import_item_list</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1195"><a href="#MainWindowShell.build_menu-1195"><span class="linenos">1195</span></a>
</span><span id="MainWindowShell.build_menu-1196"><a href="#MainWindowShell.build_menu-1196"><span class="linenos">1196</span></a>        <span class="c1"># File &gt; Reset Database</span>
</span><span id="MainWindowShell.build_menu-1197"><a href="#MainWindowShell.build_menu-1197"><span class="linenos">1197</span></a>        <span class="n">reset_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1198"><a href="#MainWindowShell.build_menu-1198"><span class="linenos">1198</span></a>            <span class="s2">&quot;mdi6.database-refresh&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">))</span>
</span><span id="MainWindowShell.build_menu-1199"><a href="#MainWindowShell.build_menu-1199"><span class="linenos">1199</span></a>        <span class="n">reset_database_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">reset_icon</span><span class="p">,</span> <span class="s2">&quot;Reset Database&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1200"><a href="#MainWindowShell.build_menu-1200"><span class="linenos">1200</span></a>        <span class="n">reset_database_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1201"><a href="#MainWindowShell.build_menu-1201"><span class="linenos">1201</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">reset_database</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1202"><a href="#MainWindowShell.build_menu-1202"><span class="linenos">1202</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">reset_database_action</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1203"><a href="#MainWindowShell.build_menu-1203"><span class="linenos">1203</span></a>
</span><span id="MainWindowShell.build_menu-1204"><a href="#MainWindowShell.build_menu-1204"><span class="linenos">1204</span></a>        <span class="c1"># File &gt; Normalize database</span>
</span><span id="MainWindowShell.build_menu-1205"><a href="#MainWindowShell.build_menu-1205"><span class="linenos">1205</span></a>        <span class="n">normalize_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1206"><a href="#MainWindowShell.build_menu-1206"><span class="linenos">1206</span></a>            <span class="s2">&quot;fa.bar-chart-o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">))</span>
</span><span id="MainWindowShell.build_menu-1207"><a href="#MainWindowShell.build_menu-1207"><span class="linenos">1207</span></a>        <span class="n">normalize_database_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1208"><a href="#MainWindowShell.build_menu-1208"><span class="linenos">1208</span></a>            <span class="n">normalize_icon</span><span class="p">,</span> <span class="s2">&quot;Fill in columns&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1209"><a href="#MainWindowShell.build_menu-1209"><span class="linenos">1209</span></a>        <span class="n">normalize_database_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1210"><a href="#MainWindowShell.build_menu-1210"><span class="linenos">1210</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">fill_columns</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1211"><a href="#MainWindowShell.build_menu-1211"><span class="linenos">1211</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">normalize_database_action</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1212"><a href="#MainWindowShell.build_menu-1212"><span class="linenos">1212</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
</span><span id="MainWindowShell.build_menu-1213"><a href="#MainWindowShell.build_menu-1213"><span class="linenos">1213</span></a>
</span><span id="MainWindowShell.build_menu-1214"><a href="#MainWindowShell.build_menu-1214"><span class="linenos">1214</span></a>        <span class="c1"># Return Home option : File &gt; Return Home</span>
</span><span id="MainWindowShell.build_menu-1215"><a href="#MainWindowShell.build_menu-1215"><span class="linenos">1215</span></a>        <span class="n">home_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1216"><a href="#MainWindowShell.build_menu-1216"><span class="linenos">1216</span></a>            <span class="s2">&quot;mdi.home&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1217"><a href="#MainWindowShell.build_menu-1217"><span class="linenos">1217</span></a>        <span class="n">return_home_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">home_icon</span><span class="p">,</span> <span class="s2">&quot;Return Home&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1218"><a href="#MainWindowShell.build_menu-1218"><span class="linenos">1218</span></a>
</span><span id="MainWindowShell.build_menu-1219"><a href="#MainWindowShell.build_menu-1219"><span class="linenos">1219</span></a>        <span class="n">return_home_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">show_home_page</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1220"><a href="#MainWindowShell.build_menu-1220"><span class="linenos">1220</span></a>        <span class="n">return_home_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+H&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1221"><a href="#MainWindowShell.build_menu-1221"><span class="linenos">1221</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">return_home_action</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1222"><a href="#MainWindowShell.build_menu-1222"><span class="linenos">1222</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
</span><span id="MainWindowShell.build_menu-1223"><a href="#MainWindowShell.build_menu-1223"><span class="linenos">1223</span></a>
</span><span id="MainWindowShell.build_menu-1224"><a href="#MainWindowShell.build_menu-1224"><span class="linenos">1224</span></a>        <span class="c1"># Exit option : File &gt; Exit</span>
</span><span id="MainWindowShell.build_menu-1225"><a href="#MainWindowShell.build_menu-1225"><span class="linenos">1225</span></a>        <span class="n">exit_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Exit&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1226"><a href="#MainWindowShell.build_menu-1226"><span class="linenos">1226</span></a>        <span class="n">exit_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+Q&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1227"><a href="#MainWindowShell.build_menu-1227"><span class="linenos">1227</span></a>        <span class="n">exit_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1228"><a href="#MainWindowShell.build_menu-1228"><span class="linenos">1228</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">exit_action</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1229"><a href="#MainWindowShell.build_menu-1229"><span class="linenos">1229</span></a>
</span><span id="MainWindowShell.build_menu-1230"><a href="#MainWindowShell.build_menu-1230"><span class="linenos">1230</span></a>        <span class="c1"># -- Edit menu</span>
</span><span id="MainWindowShell.build_menu-1231"><a href="#MainWindowShell.build_menu-1231"><span class="linenos">1231</span></a>        <span class="n">duplicates_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1232"><a href="#MainWindowShell.build_menu-1232"><span class="linenos">1232</span></a>            <span class="s2">&quot;mdi6.content-duplicate&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="MainWindowShell.build_menu-1233"><a href="#MainWindowShell.build_menu-1233"><span class="linenos">1233</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1234"><a href="#MainWindowShell.build_menu-1234"><span class="linenos">1234</span></a>        <span class="c1"># Remove Duplicates option : Edit &gt; Check for duplicates</span>
</span><span id="MainWindowShell.build_menu-1235"><a href="#MainWindowShell.build_menu-1235"><span class="linenos">1235</span></a>        <span class="n">check_for_duplicates_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1236"><a href="#MainWindowShell.build_menu-1236"><span class="linenos">1236</span></a>            <span class="n">duplicates_icon</span><span class="p">,</span> <span class="s2">&quot;Check for duplicates&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1237"><a href="#MainWindowShell.build_menu-1237"><span class="linenos">1237</span></a>        <span class="n">check_for_duplicates_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+D&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1238"><a href="#MainWindowShell.build_menu-1238"><span class="linenos">1238</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Edit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">check_for_duplicates_action</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1239"><a href="#MainWindowShell.build_menu-1239"><span class="linenos">1239</span></a>        <span class="n">check_for_duplicates_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1240"><a href="#MainWindowShell.build_menu-1240"><span class="linenos">1240</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">check_for_duplicates_popup</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1241"><a href="#MainWindowShell.build_menu-1241"><span class="linenos">1241</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Edit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
</span><span id="MainWindowShell.build_menu-1242"><a href="#MainWindowShell.build_menu-1242"><span class="linenos">1242</span></a>        <span class="c1"># Insert Item option : Edit &gt; Insert Item</span>
</span><span id="MainWindowShell.build_menu-1243"><a href="#MainWindowShell.build_menu-1243"><span class="linenos">1243</span></a>        <span class="n">insert_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1244"><a href="#MainWindowShell.build_menu-1244"><span class="linenos">1244</span></a>            <span class="s2">&quot;mdi.plus-box-outline&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="MainWindowShell.build_menu-1245"><a href="#MainWindowShell.build_menu-1245"><span class="linenos">1245</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1246"><a href="#MainWindowShell.build_menu-1246"><span class="linenos">1246</span></a>        <span class="n">insert_item_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">insert_icon</span><span class="p">,</span> <span class="s2">&quot;Insert Item&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1247"><a href="#MainWindowShell.build_menu-1247"><span class="linenos">1247</span></a>        <span class="n">insert_item_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+I&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1248"><a href="#MainWindowShell.build_menu-1248"><span class="linenos">1248</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Edit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">insert_item_action</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1249"><a href="#MainWindowShell.build_menu-1249"><span class="linenos">1249</span></a>        <span class="n">insert_item_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">insert_item</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1250"><a href="#MainWindowShell.build_menu-1250"><span class="linenos">1250</span></a>        <span class="c1"># Edit Item option : Edit &gt; Edit Item</span>
</span><span id="MainWindowShell.build_menu-1251"><a href="#MainWindowShell.build_menu-1251"><span class="linenos">1251</span></a>        <span class="n">edit_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1252"><a href="#MainWindowShell.build_menu-1252"><span class="linenos">1252</span></a>            <span class="s2">&quot;mdi6.database-edit-outline&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1253"><a href="#MainWindowShell.build_menu-1253"><span class="linenos">1253</span></a>        <span class="n">edit_item_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">edit_icon</span><span class="p">,</span> <span class="s2">&quot;Edit Item&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1254"><a href="#MainWindowShell.build_menu-1254"><span class="linenos">1254</span></a>        <span class="c1"># edit_item_action.triggered.connect(</span>
</span><span id="MainWindowShell.build_menu-1255"><a href="#MainWindowShell.build_menu-1255"><span class="linenos">1255</span></a>        <span class="c1">#     partial(self.stackedwidget.edit_item, item=None))</span>
</span><span id="MainWindowShell.build_menu-1256"><a href="#MainWindowShell.build_menu-1256"><span class="linenos">1256</span></a>        <span class="n">edit_item_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1257"><a href="#MainWindowShell.build_menu-1257"><span class="linenos">1257</span></a>            <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">edit_app_item</span><span class="p">,</span> <span class="n">input_arg</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
</span><span id="MainWindowShell.build_menu-1258"><a href="#MainWindowShell.build_menu-1258"><span class="linenos">1258</span></a>        <span class="n">edit_item_action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+E&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1259"><a href="#MainWindowShell.build_menu-1259"><span class="linenos">1259</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Edit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">edit_item_action</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1260"><a href="#MainWindowShell.build_menu-1260"><span class="linenos">1260</span></a>
</span><span id="MainWindowShell.build_menu-1261"><a href="#MainWindowShell.build_menu-1261"><span class="linenos">1261</span></a>        <span class="c1"># -- View menu</span>
</span><span id="MainWindowShell.build_menu-1262"><a href="#MainWindowShell.build_menu-1262"><span class="linenos">1262</span></a>        <span class="c1"># Options to view each manufacturer spreadsheet</span>
</span><span id="MainWindowShell.build_menu-1263"><a href="#MainWindowShell.build_menu-1263"><span class="linenos">1263</span></a>        <span class="n">actions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MainWindowShell.build_menu-1264"><a href="#MainWindowShell.build_menu-1264"><span class="linenos">1264</span></a>        <span class="k">for</span> <span class="n">mfr</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;dell&quot;</span><span class="p">,</span> <span class="s2">&quot;hp&quot;</span><span class="p">,</span> <span class="s2">&quot;lexmark&quot;</span><span class="p">,</span> <span class="s2">&quot;others&quot;</span><span class="p">]:</span>
</span><span id="MainWindowShell.build_menu-1265"><a href="#MainWindowShell.build_menu-1265"><span class="linenos">1265</span></a>            <span class="n">actions</span><span class="p">[</span><span class="n">mfr</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mfr</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> spreadsheet&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1266"><a href="#MainWindowShell.build_menu-1266"><span class="linenos">1266</span></a>            <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;View&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">mfr</span><span class="p">])</span>
</span><span id="MainWindowShell.build_menu-1267"><a href="#MainWindowShell.build_menu-1267"><span class="linenos">1267</span></a>            <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;View&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
</span><span id="MainWindowShell.build_menu-1268"><a href="#MainWindowShell.build_menu-1268"><span class="linenos">1268</span></a>            <span class="c1"># connect to show table</span>
</span><span id="MainWindowShell.build_menu-1269"><a href="#MainWindowShell.build_menu-1269"><span class="linenos">1269</span></a>            <span class="n">actions</span><span class="p">[</span><span class="n">mfr</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1270"><a href="#MainWindowShell.build_menu-1270"><span class="linenos">1270</span></a>                <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">show_table_page</span><span class="p">,</span> <span class="n">manufacturer</span><span class="o">=</span><span class="n">mfr</span><span class="p">))</span>
</span><span id="MainWindowShell.build_menu-1271"><a href="#MainWindowShell.build_menu-1271"><span class="linenos">1271</span></a>
</span><span id="MainWindowShell.build_menu-1272"><a href="#MainWindowShell.build_menu-1272"><span class="linenos">1272</span></a>        <span class="c1"># -- Settings menu</span>
</span><span id="MainWindowShell.build_menu-1273"><a href="#MainWindowShell.build_menu-1273"><span class="linenos">1273</span></a>        <span class="c1"># Display theme toggle : Settings &gt; Dark/Light mode</span>
</span><span id="MainWindowShell.build_menu-1274"><a href="#MainWindowShell.build_menu-1274"><span class="linenos">1274</span></a>        <span class="n">theme_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1275"><a href="#MainWindowShell.build_menu-1275"><span class="linenos">1275</span></a>            <span class="s2">&quot;mdi6.monitor-eye&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="MainWindowShell.build_menu-1276"><a href="#MainWindowShell.build_menu-1276"><span class="linenos">1276</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1277"><a href="#MainWindowShell.build_menu-1277"><span class="linenos">1277</span></a>        <span class="n">change_display_mode</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">theme_icon</span><span class="p">,</span> <span class="s2">&quot;Change theme&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1278"><a href="#MainWindowShell.build_menu-1278"><span class="linenos">1278</span></a>        <span class="n">change_display_mode</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1279"><a href="#MainWindowShell.build_menu-1279"><span class="linenos">1279</span></a>            <span class="s2">&quot;Change the QSS stylesheet (theme) for the application.&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1280"><a href="#MainWindowShell.build_menu-1280"><span class="linenos">1280</span></a>        <span class="n">change_display_mode</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1281"><a href="#MainWindowShell.build_menu-1281"><span class="linenos">1281</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_theme_dialog</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1282"><a href="#MainWindowShell.build_menu-1282"><span class="linenos">1282</span></a>
</span><span id="MainWindowShell.build_menu-1283"><a href="#MainWindowShell.build_menu-1283"><span class="linenos">1283</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Settings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">change_display_mode</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1284"><a href="#MainWindowShell.build_menu-1284"><span class="linenos">1284</span></a>        <span class="c1"># change table columns</span>
</span><span id="MainWindowShell.build_menu-1285"><a href="#MainWindowShell.build_menu-1285"><span class="linenos">1285</span></a>        <span class="n">change_table_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1286"><a href="#MainWindowShell.build_menu-1286"><span class="linenos">1286</span></a>            <span class="s2">&quot;ri.insert-column-left&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="MainWindowShell.build_menu-1287"><a href="#MainWindowShell.build_menu-1287"><span class="linenos">1287</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1288"><a href="#MainWindowShell.build_menu-1288"><span class="linenos">1288</span></a>        <span class="n">change_table_columns</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1289"><a href="#MainWindowShell.build_menu-1289"><span class="linenos">1289</span></a>            <span class="n">change_table_icon</span><span class="p">,</span> <span class="s2">&quot;Choose columns&quot;</span><span class="p">,</span> <span class="bp">self</span>
</span><span id="MainWindowShell.build_menu-1290"><a href="#MainWindowShell.build_menu-1290"><span class="linenos">1290</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1291"><a href="#MainWindowShell.build_menu-1291"><span class="linenos">1291</span></a>        <span class="n">change_table_columns</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1292"><a href="#MainWindowShell.build_menu-1292"><span class="linenos">1292</span></a>            <span class="s2">&quot;Add or substract from current columns being shown on a table.&quot;</span>
</span><span id="MainWindowShell.build_menu-1293"><a href="#MainWindowShell.build_menu-1293"><span class="linenos">1293</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1294"><a href="#MainWindowShell.build_menu-1294"><span class="linenos">1294</span></a>        <span class="n">change_table_columns</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1295"><a href="#MainWindowShell.build_menu-1295"><span class="linenos">1295</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_column_dialog</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1296"><a href="#MainWindowShell.build_menu-1296"><span class="linenos">1296</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Settings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">change_table_columns</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1297"><a href="#MainWindowShell.build_menu-1297"><span class="linenos">1297</span></a>
</span><span id="MainWindowShell.build_menu-1298"><a href="#MainWindowShell.build_menu-1298"><span class="linenos">1298</span></a>        <span class="c1"># View ALL SETTINGS option : Settings &gt; View all settings</span>
</span><span id="MainWindowShell.build_menu-1299"><a href="#MainWindowShell.build_menu-1299"><span class="linenos">1299</span></a>        <span class="n">view_settings_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1300"><a href="#MainWindowShell.build_menu-1300"><span class="linenos">1300</span></a>            <span class="s1">&#39;mdi6.cog&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1301"><a href="#MainWindowShell.build_menu-1301"><span class="linenos">1301</span></a>        <span class="n">view_settings_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1302"><a href="#MainWindowShell.build_menu-1302"><span class="linenos">1302</span></a>            <span class="n">view_settings_icon</span><span class="p">,</span> <span class="s2">&quot;View all settings&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1303"><a href="#MainWindowShell.build_menu-1303"><span class="linenos">1303</span></a>        <span class="n">view_settings_action</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;View all settings in the app.&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1304"><a href="#MainWindowShell.build_menu-1304"><span class="linenos">1304</span></a>        <span class="n">view_settings_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1305"><a href="#MainWindowShell.build_menu-1305"><span class="linenos">1305</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_settings_dialog</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1306"><a href="#MainWindowShell.build_menu-1306"><span class="linenos">1306</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Settings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">view_settings_action</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1307"><a href="#MainWindowShell.build_menu-1307"><span class="linenos">1307</span></a>
</span><span id="MainWindowShell.build_menu-1308"><a href="#MainWindowShell.build_menu-1308"><span class="linenos">1308</span></a>        <span class="c1"># -- Help menu</span>
</span><span id="MainWindowShell.build_menu-1309"><a href="#MainWindowShell.build_menu-1309"><span class="linenos">1309</span></a>        <span class="c1"># About option : Help &gt; About</span>
</span><span id="MainWindowShell.build_menu-1310"><a href="#MainWindowShell.build_menu-1310"><span class="linenos">1310</span></a>        <span class="n">about_icon</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1311"><a href="#MainWindowShell.build_menu-1311"><span class="linenos">1311</span></a>            <span class="s2">&quot;mdi.information-outline&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e7e7e7&quot;</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1.75</span>
</span><span id="MainWindowShell.build_menu-1312"><a href="#MainWindowShell.build_menu-1312"><span class="linenos">1312</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1313"><a href="#MainWindowShell.build_menu-1313"><span class="linenos">1313</span></a>        <span class="n">about_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">about_icon</span><span class="p">,</span> <span class="s2">&quot;About&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1314"><a href="#MainWindowShell.build_menu-1314"><span class="linenos">1314</span></a>        <span class="n">menubar_options</span><span class="p">[</span><span class="s2">&quot;Help&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">about_action</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1315"><a href="#MainWindowShell.build_menu-1315"><span class="linenos">1315</span></a>        <span class="n">about_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_help_dialog</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1316"><a href="#MainWindowShell.build_menu-1316"><span class="linenos">1316</span></a>
</span><span id="MainWindowShell.build_menu-1317"><a href="#MainWindowShell.build_menu-1317"><span class="linenos">1317</span></a>        <span class="c1"># ------------------------------------</span>
</span><span id="MainWindowShell.build_menu-1318"><a href="#MainWindowShell.build_menu-1318"><span class="linenos">1318</span></a>        <span class="c1"># TOOLBAR UNDERNEATH MAIN MENU (self.secondary_toolbar)</span>
</span><span id="MainWindowShell.build_menu-1319"><a href="#MainWindowShell.build_menu-1319"><span class="linenos">1319</span></a>        <span class="n">secondary_toolbar</span> <span class="o">=</span> <span class="n">TonerToolbar</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1320"><a href="#MainWindowShell.build_menu-1320"><span class="linenos">1320</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addToolBar</span><span class="p">(</span><span class="n">secondary_toolbar</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1321"><a href="#MainWindowShell.build_menu-1321"><span class="linenos">1321</span></a>        <span class="n">toolbaricons</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MainWindowShell.build_menu-1322"><a href="#MainWindowShell.build_menu-1322"><span class="linenos">1322</span></a>        <span class="n">toolbaractions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MainWindowShell.build_menu-1323"><a href="#MainWindowShell.build_menu-1323"><span class="linenos">1323</span></a>        <span class="c1"># return home button</span>
</span><span id="MainWindowShell.build_menu-1324"><a href="#MainWindowShell.build_menu-1324"><span class="linenos">1324</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;home&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1325"><a href="#MainWindowShell.build_menu-1325"><span class="linenos">1325</span></a>            <span class="s2">&quot;mdi6.home&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span>
</span><span id="MainWindowShell.build_menu-1326"><a href="#MainWindowShell.build_menu-1326"><span class="linenos">1326</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1327"><a href="#MainWindowShell.build_menu-1327"><span class="linenos">1327</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;home&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1328"><a href="#MainWindowShell.build_menu-1328"><span class="linenos">1328</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Return to home page.&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1329"><a href="#MainWindowShell.build_menu-1329"><span class="linenos">1329</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1330"><a href="#MainWindowShell.build_menu-1330"><span class="linenos">1330</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">show_home_page</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1331"><a href="#MainWindowShell.build_menu-1331"><span class="linenos">1331</span></a>        <span class="c1"># settings button</span>
</span><span id="MainWindowShell.build_menu-1332"><a href="#MainWindowShell.build_menu-1332"><span class="linenos">1332</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1333"><a href="#MainWindowShell.build_menu-1333"><span class="linenos">1333</span></a>            <span class="s1">&#39;ei.cogs&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1334"><a href="#MainWindowShell.build_menu-1334"><span class="linenos">1334</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1335"><a href="#MainWindowShell.build_menu-1335"><span class="linenos">1335</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Open settings dialog.&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1336"><a href="#MainWindowShell.build_menu-1336"><span class="linenos">1336</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1337"><a href="#MainWindowShell.build_menu-1337"><span class="linenos">1337</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_settings_dialog</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1338"><a href="#MainWindowShell.build_menu-1338"><span class="linenos">1338</span></a>        <span class="c1"># database backup</span>
</span><span id="MainWindowShell.build_menu-1339"><a href="#MainWindowShell.build_menu-1339"><span class="linenos">1339</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;backup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span><span class="s1">&#39;mdi.database-arrow-down&#39;</span><span class="p">,</span>
</span><span id="MainWindowShell.build_menu-1340"><a href="#MainWindowShell.build_menu-1340"><span class="linenos">1340</span></a>                                                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1341"><a href="#MainWindowShell.build_menu-1341"><span class="linenos">1341</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;backup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1342"><a href="#MainWindowShell.build_menu-1342"><span class="linenos">1342</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;backup&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1343"><a href="#MainWindowShell.build_menu-1343"><span class="linenos">1343</span></a>            <span class="s2">&quot;Backup the database to a file on your computer.&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1344"><a href="#MainWindowShell.build_menu-1344"><span class="linenos">1344</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;backup&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1345"><a href="#MainWindowShell.build_menu-1345"><span class="linenos">1345</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">backup_to_csv</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1346"><a href="#MainWindowShell.build_menu-1346"><span class="linenos">1346</span></a>        <span class="c1"># search button</span>
</span><span id="MainWindowShell.build_menu-1347"><a href="#MainWindowShell.build_menu-1347"><span class="linenos">1347</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;search&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1348"><a href="#MainWindowShell.build_menu-1348"><span class="linenos">1348</span></a>            <span class="s2">&quot;mdi6.printer-search&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span>
</span><span id="MainWindowShell.build_menu-1349"><a href="#MainWindowShell.build_menu-1349"><span class="linenos">1349</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1350"><a href="#MainWindowShell.build_menu-1350"><span class="linenos">1350</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;search&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1351"><a href="#MainWindowShell.build_menu-1351"><span class="linenos">1351</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;search&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1352"><a href="#MainWindowShell.build_menu-1352"><span class="linenos">1352</span></a>            <span class="s2">&quot;Search the database by any of it&#39;s existing columns.&quot;</span>
</span><span id="MainWindowShell.build_menu-1353"><a href="#MainWindowShell.build_menu-1353"><span class="linenos">1353</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1354"><a href="#MainWindowShell.build_menu-1354"><span class="linenos">1354</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;search&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1355"><a href="#MainWindowShell.build_menu-1355"><span class="linenos">1355</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_search_dialog</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1356"><a href="#MainWindowShell.build_menu-1356"><span class="linenos">1356</span></a>
</span><span id="MainWindowShell.build_menu-1357"><a href="#MainWindowShell.build_menu-1357"><span class="linenos">1357</span></a>        <span class="c1"># open scan input window</span>
</span><span id="MainWindowShell.build_menu-1358"><a href="#MainWindowShell.build_menu-1358"><span class="linenos">1358</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;barcode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1359"><a href="#MainWindowShell.build_menu-1359"><span class="linenos">1359</span></a>            <span class="s2">&quot;mdi6.barcode-scan&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span>
</span><span id="MainWindowShell.build_menu-1360"><a href="#MainWindowShell.build_menu-1360"><span class="linenos">1360</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1361"><a href="#MainWindowShell.build_menu-1361"><span class="linenos">1361</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;barcode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1362"><a href="#MainWindowShell.build_menu-1362"><span class="linenos">1362</span></a>        <span class="n">secondary_toolbar</span><span class="o">.</span><span class="n">setIconSize</span><span class="p">(</span><span class="n">QSize</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
</span><span id="MainWindowShell.build_menu-1363"><a href="#MainWindowShell.build_menu-1363"><span class="linenos">1363</span></a>        <span class="c1"># toolbaractions[&quot;barcode&quot;].setIcon(toolbaricons[&quot;barcode&quot;])</span>
</span><span id="MainWindowShell.build_menu-1364"><a href="#MainWindowShell.build_menu-1364"><span class="linenos">1364</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;barcode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1365"><a href="#MainWindowShell.build_menu-1365"><span class="linenos">1365</span></a>            <span class="s2">&quot;Place cursor inside the textbox that opens and begin scanning items, turn up volume please.&quot;</span>
</span><span id="MainWindowShell.build_menu-1366"><a href="#MainWindowShell.build_menu-1366"><span class="linenos">1366</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1367"><a href="#MainWindowShell.build_menu-1367"><span class="linenos">1367</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;barcode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+B&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1368"><a href="#MainWindowShell.build_menu-1368"><span class="linenos">1368</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;barcode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1369"><a href="#MainWindowShell.build_menu-1369"><span class="linenos">1369</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">open_scan_dialog</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1370"><a href="#MainWindowShell.build_menu-1370"><span class="linenos">1370</span></a>
</span><span id="MainWindowShell.build_menu-1371"><a href="#MainWindowShell.build_menu-1371"><span class="linenos">1371</span></a>        <span class="c1"># -- Import UPC FILE option : on the secondary toolbar</span>
</span><span id="MainWindowShell.build_menu-1372"><a href="#MainWindowShell.build_menu-1372"><span class="linenos">1372</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;import&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1373"><a href="#MainWindowShell.build_menu-1373"><span class="linenos">1373</span></a>            <span class="s2">&quot;fa5s.file-import&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.60</span>
</span><span id="MainWindowShell.build_menu-1374"><a href="#MainWindowShell.build_menu-1374"><span class="linenos">1374</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1375"><a href="#MainWindowShell.build_menu-1375"><span class="linenos">1375</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;import&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1376"><a href="#MainWindowShell.build_menu-1376"><span class="linenos">1376</span></a>        <span class="c1"># toolbaractions[&quot;import&quot;].setIcon(toolbaricons[&quot;import&quot;])</span>
</span><span id="MainWindowShell.build_menu-1377"><a href="#MainWindowShell.build_menu-1377"><span class="linenos">1377</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;import&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1378"><a href="#MainWindowShell.build_menu-1378"><span class="linenos">1378</span></a>            <span class="s2">&quot;Import .txt File containing 1 UPC code per line&quot;</span>
</span><span id="MainWindowShell.build_menu-1379"><a href="#MainWindowShell.build_menu-1379"><span class="linenos">1379</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1380"><a href="#MainWindowShell.build_menu-1380"><span class="linenos">1380</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;import&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+I&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1381"><a href="#MainWindowShell.build_menu-1381"><span class="linenos">1381</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;import&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1382"><a href="#MainWindowShell.build_menu-1382"><span class="linenos">1382</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">import_item_list</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1383"><a href="#MainWindowShell.build_menu-1383"><span class="linenos">1383</span></a>
</span><span id="MainWindowShell.build_menu-1384"><a href="#MainWindowShell.build_menu-1384"><span class="linenos">1384</span></a>        <span class="c1"># -- Export to Excel button</span>
</span><span id="MainWindowShell.build_menu-1385"><a href="#MainWindowShell.build_menu-1385"><span class="linenos">1385</span></a>        <span class="n">toolbaricons</span><span class="p">[</span><span class="s2">&quot;export&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtawesome</span><span class="o">.</span><span class="n">icon</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1386"><a href="#MainWindowShell.build_menu-1386"><span class="linenos">1386</span></a>            <span class="s2">&quot;mdi6.microsoft-excel&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.75</span>
</span><span id="MainWindowShell.build_menu-1387"><a href="#MainWindowShell.build_menu-1387"><span class="linenos">1387</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1388"><a href="#MainWindowShell.build_menu-1388"><span class="linenos">1388</span></a>
</span><span id="MainWindowShell.build_menu-1389"><a href="#MainWindowShell.build_menu-1389"><span class="linenos">1389</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;export&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1390"><a href="#MainWindowShell.build_menu-1390"><span class="linenos">1390</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;export&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1391"><a href="#MainWindowShell.build_menu-1391"><span class="linenos">1391</span></a>            <span class="s2">&quot;Export the current inventory to .xlsx spreadsheet&quot;</span>
</span><span id="MainWindowShell.build_menu-1392"><a href="#MainWindowShell.build_menu-1392"><span class="linenos">1392</span></a>        <span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1393"><a href="#MainWindowShell.build_menu-1393"><span class="linenos">1393</span></a>        <span class="n">secondary_toolbar</span><span class="o">.</span><span class="n">setIconSize</span><span class="p">(</span><span class="n">QSize</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
</span><span id="MainWindowShell.build_menu-1394"><a href="#MainWindowShell.build_menu-1394"><span class="linenos">1394</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;export&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s2">&quot;Ctrl+E&quot;</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1395"><a href="#MainWindowShell.build_menu-1395"><span class="linenos">1395</span></a>        <span class="n">toolbaractions</span><span class="p">[</span><span class="s2">&quot;export&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span id="MainWindowShell.build_menu-1396"><a href="#MainWindowShell.build_menu-1396"><span class="linenos">1396</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stackedwidget</span><span class="o">.</span><span class="n">export_to_excel</span><span class="p">)</span>
</span><span id="MainWindowShell.build_menu-1397"><a href="#MainWindowShell.build_menu-1397"><span class="linenos">1397</span></a>
</span><span id="MainWindowShell.build_menu-1398"><a href="#MainWindowShell.build_menu-1398"><span class="linenos">1398</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">qaction</span> <span class="ow">in</span> <span class="n">toolbaractions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="MainWindowShell.build_menu-1399"><a href="#MainWindowShell.build_menu-1399"><span class="linenos">1399</span></a>            <span class="n">qaction</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">toolbaricons</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="MainWindowShell.build_menu-1400"><a href="#MainWindowShell.build_menu-1400"><span class="linenos">1400</span></a>            <span class="n">secondary_toolbar</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">qaction</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>build_menu Creates the main MenuBar for the app, as well as the secondary toolbar which is directly underneath the main menubar. Adds icons and actions to the menubar and toolbar buttons.</p>
</div>


                            </div>
                            <div id="MainWindowShell.closeEvent" class="classattr">
                                        <input id="MainWindowShell.closeEvent-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">closeEvent</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MainWindowShell.closeEvent-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MainWindowShell.closeEvent"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MainWindowShell.closeEvent-1403"><a href="#MainWindowShell.closeEvent-1403"><span class="linenos">1403</span></a>    <span class="k">def</span> <span class="nf">closeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span><span id="MainWindowShell.closeEvent-1404"><a href="#MainWindowShell.closeEvent-1404"><span class="linenos">1404</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;closeEvent Overrides the default closeEvent to prompt user to confirm they want to close the application.&quot;&quot;&quot;</span>
</span><span id="MainWindowShell.closeEvent-1405"><a href="#MainWindowShell.closeEvent-1405"><span class="linenos">1405</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">safety_net</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MainWindowShell.closeEvent-1406"><a href="#MainWindowShell.closeEvent-1406"><span class="linenos">1406</span></a>            <span class="n">close_warning</span> <span class="o">=</span> <span class="n">WarningPopup</span><span class="p">(</span>
</span><span id="MainWindowShell.closeEvent-1407"><a href="#MainWindowShell.closeEvent-1407"><span class="linenos">1407</span></a>                <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Exit&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Are you sure you want to exit?&quot;</span>
</span><span id="MainWindowShell.closeEvent-1408"><a href="#MainWindowShell.closeEvent-1408"><span class="linenos">1408</span></a>            <span class="p">)</span>
</span><span id="MainWindowShell.closeEvent-1409"><a href="#MainWindowShell.closeEvent-1409"><span class="linenos">1409</span></a>            <span class="c1"># close_warning.setStyleSheet(self.current_style)</span>
</span><span id="MainWindowShell.closeEvent-1410"><a href="#MainWindowShell.closeEvent-1410"><span class="linenos">1410</span></a>            <span class="k">if</span> <span class="n">close_warning</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span> <span class="o">==</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
</span><span id="MainWindowShell.closeEvent-1411"><a href="#MainWindowShell.closeEvent-1411"><span class="linenos">1411</span></a>                <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
</span><span id="MainWindowShell.closeEvent-1412"><a href="#MainWindowShell.closeEvent-1412"><span class="linenos">1412</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="MainWindowShell.closeEvent-1413"><a href="#MainWindowShell.closeEvent-1413"><span class="linenos">1413</span></a>                <span class="n">event</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
</span><span id="MainWindowShell.closeEvent-1414"><a href="#MainWindowShell.closeEvent-1414"><span class="linenos">1414</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MainWindowShell.closeEvent-1415"><a href="#MainWindowShell.closeEvent-1415"><span class="linenos">1415</span></a>            <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>closeEvent Overrides the default closeEvent to prompt user to confirm they want to close the application.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>PyQt5.QtWidgets.QMainWindow</dt>
                                <dd id="MainWindowShell.DockOption" class="class">DockOption</dd>
                <dd id="MainWindowShell.DockOptions" class="class">DockOptions</dd>
                <dd id="MainWindowShell.actionEvent" class="function">actionEvent</dd>
                <dd id="MainWindowShell.addDockWidget" class="function">addDockWidget</dd>
                <dd id="MainWindowShell.addToolBar" class="function">addToolBar</dd>
                <dd id="MainWindowShell.addToolBarBreak" class="function">addToolBarBreak</dd>
                <dd id="MainWindowShell.centralWidget" class="function">centralWidget</dd>
                <dd id="MainWindowShell.changeEvent" class="function">changeEvent</dd>
                <dd id="MainWindowShell.childEvent" class="function">childEvent</dd>
                <dd id="MainWindowShell.connectNotify" class="function">connectNotify</dd>
                <dd id="MainWindowShell.contextMenuEvent" class="function">contextMenuEvent</dd>
                <dd id="MainWindowShell.corner" class="function">corner</dd>
                <dd id="MainWindowShell.create" class="function">create</dd>
                <dd id="MainWindowShell.createPopupMenu" class="function">createPopupMenu</dd>
                <dd id="MainWindowShell.customEvent" class="function">customEvent</dd>
                <dd id="MainWindowShell.destroy" class="function">destroy</dd>
                <dd id="MainWindowShell.disconnectNotify" class="function">disconnectNotify</dd>
                <dd id="MainWindowShell.dockOptions" class="function">dockOptions</dd>
                <dd id="MainWindowShell.dockWidgetArea" class="function">dockWidgetArea</dd>
                <dd id="MainWindowShell.documentMode" class="function">documentMode</dd>
                <dd id="MainWindowShell.dragEnterEvent" class="function">dragEnterEvent</dd>
                <dd id="MainWindowShell.dragLeaveEvent" class="function">dragLeaveEvent</dd>
                <dd id="MainWindowShell.dragMoveEvent" class="function">dragMoveEvent</dd>
                <dd id="MainWindowShell.dropEvent" class="function">dropEvent</dd>
                <dd id="MainWindowShell.enterEvent" class="function">enterEvent</dd>
                <dd id="MainWindowShell.event" class="function">event</dd>
                <dd id="MainWindowShell.focusInEvent" class="function">focusInEvent</dd>
                <dd id="MainWindowShell.focusNextChild" class="function">focusNextChild</dd>
                <dd id="MainWindowShell.focusNextPrevChild" class="function">focusNextPrevChild</dd>
                <dd id="MainWindowShell.focusOutEvent" class="function">focusOutEvent</dd>
                <dd id="MainWindowShell.focusPreviousChild" class="function">focusPreviousChild</dd>
                <dd id="MainWindowShell.hideEvent" class="function">hideEvent</dd>
                <dd id="MainWindowShell.iconSize" class="function">iconSize</dd>
                <dd id="MainWindowShell.initPainter" class="function">initPainter</dd>
                <dd id="MainWindowShell.inputMethodEvent" class="function">inputMethodEvent</dd>
                <dd id="MainWindowShell.insertToolBar" class="function">insertToolBar</dd>
                <dd id="MainWindowShell.insertToolBarBreak" class="function">insertToolBarBreak</dd>
                <dd id="MainWindowShell.isAnimated" class="function">isAnimated</dd>
                <dd id="MainWindowShell.isDockNestingEnabled" class="function">isDockNestingEnabled</dd>
                <dd id="MainWindowShell.isSeparator" class="function">isSeparator</dd>
                <dd id="MainWindowShell.isSignalConnected" class="function">isSignalConnected</dd>
                <dd id="MainWindowShell.keyPressEvent" class="function">keyPressEvent</dd>
                <dd id="MainWindowShell.keyReleaseEvent" class="function">keyReleaseEvent</dd>
                <dd id="MainWindowShell.leaveEvent" class="function">leaveEvent</dd>
                <dd id="MainWindowShell.menuBar" class="function">menuBar</dd>
                <dd id="MainWindowShell.menuWidget" class="function">menuWidget</dd>
                <dd id="MainWindowShell.metric" class="function">metric</dd>
                <dd id="MainWindowShell.mouseDoubleClickEvent" class="function">mouseDoubleClickEvent</dd>
                <dd id="MainWindowShell.mouseMoveEvent" class="function">mouseMoveEvent</dd>
                <dd id="MainWindowShell.mousePressEvent" class="function">mousePressEvent</dd>
                <dd id="MainWindowShell.mouseReleaseEvent" class="function">mouseReleaseEvent</dd>
                <dd id="MainWindowShell.moveEvent" class="function">moveEvent</dd>
                <dd id="MainWindowShell.nativeEvent" class="function">nativeEvent</dd>
                <dd id="MainWindowShell.paintEvent" class="function">paintEvent</dd>
                <dd id="MainWindowShell.receivers" class="function">receivers</dd>
                <dd id="MainWindowShell.removeDockWidget" class="function">removeDockWidget</dd>
                <dd id="MainWindowShell.removeToolBar" class="function">removeToolBar</dd>
                <dd id="MainWindowShell.removeToolBarBreak" class="function">removeToolBarBreak</dd>
                <dd id="MainWindowShell.resizeDocks" class="function">resizeDocks</dd>
                <dd id="MainWindowShell.resizeEvent" class="function">resizeEvent</dd>
                <dd id="MainWindowShell.restoreDockWidget" class="function">restoreDockWidget</dd>
                <dd id="MainWindowShell.restoreState" class="function">restoreState</dd>
                <dd id="MainWindowShell.saveState" class="function">saveState</dd>
                <dd id="MainWindowShell.sender" class="function">sender</dd>
                <dd id="MainWindowShell.senderSignalIndex" class="function">senderSignalIndex</dd>
                <dd id="MainWindowShell.setAnimated" class="function">setAnimated</dd>
                <dd id="MainWindowShell.setCentralWidget" class="function">setCentralWidget</dd>
                <dd id="MainWindowShell.setCorner" class="function">setCorner</dd>
                <dd id="MainWindowShell.setDockNestingEnabled" class="function">setDockNestingEnabled</dd>
                <dd id="MainWindowShell.setDockOptions" class="function">setDockOptions</dd>
                <dd id="MainWindowShell.setDocumentMode" class="function">setDocumentMode</dd>
                <dd id="MainWindowShell.setIconSize" class="function">setIconSize</dd>
                <dd id="MainWindowShell.setMenuBar" class="function">setMenuBar</dd>
                <dd id="MainWindowShell.setMenuWidget" class="function">setMenuWidget</dd>
                <dd id="MainWindowShell.setStatusBar" class="function">setStatusBar</dd>
                <dd id="MainWindowShell.setTabPosition" class="function">setTabPosition</dd>
                <dd id="MainWindowShell.setTabShape" class="function">setTabShape</dd>
                <dd id="MainWindowShell.setToolButtonStyle" class="function">setToolButtonStyle</dd>
                <dd id="MainWindowShell.setUnifiedTitleAndToolBarOnMac" class="function">setUnifiedTitleAndToolBarOnMac</dd>
                <dd id="MainWindowShell.sharedPainter" class="function">sharedPainter</dd>
                <dd id="MainWindowShell.showEvent" class="function">showEvent</dd>
                <dd id="MainWindowShell.splitDockWidget" class="function">splitDockWidget</dd>
                <dd id="MainWindowShell.statusBar" class="function">statusBar</dd>
                <dd id="MainWindowShell.tabPosition" class="function">tabPosition</dd>
                <dd id="MainWindowShell.tabShape" class="function">tabShape</dd>
                <dd id="MainWindowShell.tabifiedDockWidgets" class="function">tabifiedDockWidgets</dd>
                <dd id="MainWindowShell.tabifyDockWidget" class="function">tabifyDockWidget</dd>
                <dd id="MainWindowShell.tabletEvent" class="function">tabletEvent</dd>
                <dd id="MainWindowShell.takeCentralWidget" class="function">takeCentralWidget</dd>
                <dd id="MainWindowShell.timerEvent" class="function">timerEvent</dd>
                <dd id="MainWindowShell.toolBarArea" class="function">toolBarArea</dd>
                <dd id="MainWindowShell.toolBarBreak" class="function">toolBarBreak</dd>
                <dd id="MainWindowShell.toolButtonStyle" class="function">toolButtonStyle</dd>
                <dd id="MainWindowShell.unifiedTitleAndToolBarOnMac" class="function">unifiedTitleAndToolBarOnMac</dd>
                <dd id="MainWindowShell.updateMicroFocus" class="function">updateMicroFocus</dd>
                <dd id="MainWindowShell.wheelEvent" class="function">wheelEvent</dd>
                <dd id="MainWindowShell.tabifiedDockWidgetActivated" class="function">tabifiedDockWidgetActivated</dd>
                <dd id="MainWindowShell.toolButtonStyleChanged" class="function">toolButtonStyleChanged</dd>
                <dd id="MainWindowShell.iconSizeChanged" class="function">iconSizeChanged</dd>

            </div>
            <div><dt>PyQt5.QtWidgets.QWidget</dt>
                                <dd id="MainWindowShell.RenderFlag" class="class">RenderFlag</dd>
                <dd id="MainWindowShell.RenderFlags" class="class">RenderFlags</dd>
                <dd id="MainWindowShell.acceptDrops" class="function">acceptDrops</dd>
                <dd id="MainWindowShell.accessibleDescription" class="function">accessibleDescription</dd>
                <dd id="MainWindowShell.accessibleName" class="function">accessibleName</dd>
                <dd id="MainWindowShell.actions" class="function">actions</dd>
                <dd id="MainWindowShell.activateWindow" class="function">activateWindow</dd>
                <dd id="MainWindowShell.addAction" class="function">addAction</dd>
                <dd id="MainWindowShell.addActions" class="function">addActions</dd>
                <dd id="MainWindowShell.adjustSize" class="function">adjustSize</dd>
                <dd id="MainWindowShell.autoFillBackground" class="function">autoFillBackground</dd>
                <dd id="MainWindowShell.backgroundRole" class="function">backgroundRole</dd>
                <dd id="MainWindowShell.baseSize" class="function">baseSize</dd>
                <dd id="MainWindowShell.childAt" class="function">childAt</dd>
                <dd id="MainWindowShell.childrenRect" class="function">childrenRect</dd>
                <dd id="MainWindowShell.childrenRegion" class="function">childrenRegion</dd>
                <dd id="MainWindowShell.clearFocus" class="function">clearFocus</dd>
                <dd id="MainWindowShell.clearMask" class="function">clearMask</dd>
                <dd id="MainWindowShell.close" class="function">close</dd>
                <dd id="MainWindowShell.contentsMargins" class="function">contentsMargins</dd>
                <dd id="MainWindowShell.contentsRect" class="function">contentsRect</dd>
                <dd id="MainWindowShell.contextMenuPolicy" class="function">contextMenuPolicy</dd>
                <dd id="MainWindowShell.createWindowContainer" class="function">createWindowContainer</dd>
                <dd id="MainWindowShell.cursor" class="function">cursor</dd>
                <dd id="MainWindowShell.devType" class="function">devType</dd>
                <dd id="MainWindowShell.effectiveWinId" class="function">effectiveWinId</dd>
                <dd id="MainWindowShell.ensurePolished" class="function">ensurePolished</dd>
                <dd id="MainWindowShell.find" class="function">find</dd>
                <dd id="MainWindowShell.focusPolicy" class="function">focusPolicy</dd>
                <dd id="MainWindowShell.focusProxy" class="function">focusProxy</dd>
                <dd id="MainWindowShell.focusWidget" class="function">focusWidget</dd>
                <dd id="MainWindowShell.font" class="function">font</dd>
                <dd id="MainWindowShell.fontInfo" class="function">fontInfo</dd>
                <dd id="MainWindowShell.fontMetrics" class="function">fontMetrics</dd>
                <dd id="MainWindowShell.foregroundRole" class="function">foregroundRole</dd>
                <dd id="MainWindowShell.frameGeometry" class="function">frameGeometry</dd>
                <dd id="MainWindowShell.frameSize" class="function">frameSize</dd>
                <dd id="MainWindowShell.geometry" class="function">geometry</dd>
                <dd id="MainWindowShell.getContentsMargins" class="function">getContentsMargins</dd>
                <dd id="MainWindowShell.grab" class="function">grab</dd>
                <dd id="MainWindowShell.grabGesture" class="function">grabGesture</dd>
                <dd id="MainWindowShell.grabKeyboard" class="function">grabKeyboard</dd>
                <dd id="MainWindowShell.grabMouse" class="function">grabMouse</dd>
                <dd id="MainWindowShell.grabShortcut" class="function">grabShortcut</dd>
                <dd id="MainWindowShell.graphicsEffect" class="function">graphicsEffect</dd>
                <dd id="MainWindowShell.graphicsProxyWidget" class="function">graphicsProxyWidget</dd>
                <dd id="MainWindowShell.hasFocus" class="function">hasFocus</dd>
                <dd id="MainWindowShell.hasHeightForWidth" class="function">hasHeightForWidth</dd>
                <dd id="MainWindowShell.hasMouseTracking" class="function">hasMouseTracking</dd>
                <dd id="MainWindowShell.hasTabletTracking" class="function">hasTabletTracking</dd>
                <dd id="MainWindowShell.height" class="function">height</dd>
                <dd id="MainWindowShell.heightForWidth" class="function">heightForWidth</dd>
                <dd id="MainWindowShell.hide" class="function">hide</dd>
                <dd id="MainWindowShell.inputMethodHints" class="function">inputMethodHints</dd>
                <dd id="MainWindowShell.inputMethodQuery" class="function">inputMethodQuery</dd>
                <dd id="MainWindowShell.insertAction" class="function">insertAction</dd>
                <dd id="MainWindowShell.insertActions" class="function">insertActions</dd>
                <dd id="MainWindowShell.isActiveWindow" class="function">isActiveWindow</dd>
                <dd id="MainWindowShell.isAncestorOf" class="function">isAncestorOf</dd>
                <dd id="MainWindowShell.isEnabled" class="function">isEnabled</dd>
                <dd id="MainWindowShell.isEnabledTo" class="function">isEnabledTo</dd>
                <dd id="MainWindowShell.isFullScreen" class="function">isFullScreen</dd>
                <dd id="MainWindowShell.isHidden" class="function">isHidden</dd>
                <dd id="MainWindowShell.isLeftToRight" class="function">isLeftToRight</dd>
                <dd id="MainWindowShell.isMaximized" class="function">isMaximized</dd>
                <dd id="MainWindowShell.isMinimized" class="function">isMinimized</dd>
                <dd id="MainWindowShell.isModal" class="function">isModal</dd>
                <dd id="MainWindowShell.isRightToLeft" class="function">isRightToLeft</dd>
                <dd id="MainWindowShell.isVisible" class="function">isVisible</dd>
                <dd id="MainWindowShell.isVisibleTo" class="function">isVisibleTo</dd>
                <dd id="MainWindowShell.isWindow" class="function">isWindow</dd>
                <dd id="MainWindowShell.isWindowModified" class="function">isWindowModified</dd>
                <dd id="MainWindowShell.keyboardGrabber" class="function">keyboardGrabber</dd>
                <dd id="MainWindowShell.layout" class="function">layout</dd>
                <dd id="MainWindowShell.layoutDirection" class="function">layoutDirection</dd>
                <dd id="MainWindowShell.locale" class="function">locale</dd>
                <dd id="MainWindowShell.lower" class="function">lower</dd>
                <dd id="MainWindowShell.mapFrom" class="function">mapFrom</dd>
                <dd id="MainWindowShell.mapFromGlobal" class="function">mapFromGlobal</dd>
                <dd id="MainWindowShell.mapFromParent" class="function">mapFromParent</dd>
                <dd id="MainWindowShell.mapTo" class="function">mapTo</dd>
                <dd id="MainWindowShell.mapToGlobal" class="function">mapToGlobal</dd>
                <dd id="MainWindowShell.mapToParent" class="function">mapToParent</dd>
                <dd id="MainWindowShell.mask" class="function">mask</dd>
                <dd id="MainWindowShell.maximumHeight" class="function">maximumHeight</dd>
                <dd id="MainWindowShell.maximumSize" class="function">maximumSize</dd>
                <dd id="MainWindowShell.maximumWidth" class="function">maximumWidth</dd>
                <dd id="MainWindowShell.minimumHeight" class="function">minimumHeight</dd>
                <dd id="MainWindowShell.minimumSize" class="function">minimumSize</dd>
                <dd id="MainWindowShell.minimumSizeHint" class="function">minimumSizeHint</dd>
                <dd id="MainWindowShell.minimumWidth" class="function">minimumWidth</dd>
                <dd id="MainWindowShell.mouseGrabber" class="function">mouseGrabber</dd>
                <dd id="MainWindowShell.move" class="function">move</dd>
                <dd id="MainWindowShell.nativeParentWidget" class="function">nativeParentWidget</dd>
                <dd id="MainWindowShell.nextInFocusChain" class="function">nextInFocusChain</dd>
                <dd id="MainWindowShell.normalGeometry" class="function">normalGeometry</dd>
                <dd id="MainWindowShell.overrideWindowFlags" class="function">overrideWindowFlags</dd>
                <dd id="MainWindowShell.overrideWindowState" class="function">overrideWindowState</dd>
                <dd id="MainWindowShell.paintEngine" class="function">paintEngine</dd>
                <dd id="MainWindowShell.palette" class="function">palette</dd>
                <dd id="MainWindowShell.parentWidget" class="function">parentWidget</dd>
                <dd id="MainWindowShell.pos" class="function">pos</dd>
                <dd id="MainWindowShell.previousInFocusChain" class="function">previousInFocusChain</dd>
                <dd id="MainWindowShell.raise_" class="function">raise_</dd>
                <dd id="MainWindowShell.rect" class="function">rect</dd>
                <dd id="MainWindowShell.releaseKeyboard" class="function">releaseKeyboard</dd>
                <dd id="MainWindowShell.releaseMouse" class="function">releaseMouse</dd>
                <dd id="MainWindowShell.releaseShortcut" class="function">releaseShortcut</dd>
                <dd id="MainWindowShell.removeAction" class="function">removeAction</dd>
                <dd id="MainWindowShell.render" class="function">render</dd>
                <dd id="MainWindowShell.repaint" class="function">repaint</dd>
                <dd id="MainWindowShell.resize" class="function">resize</dd>
                <dd id="MainWindowShell.restoreGeometry" class="function">restoreGeometry</dd>
                <dd id="MainWindowShell.saveGeometry" class="function">saveGeometry</dd>
                <dd id="MainWindowShell.screen" class="function">screen</dd>
                <dd id="MainWindowShell.scroll" class="function">scroll</dd>
                <dd id="MainWindowShell.setAcceptDrops" class="function">setAcceptDrops</dd>
                <dd id="MainWindowShell.setAccessibleDescription" class="function">setAccessibleDescription</dd>
                <dd id="MainWindowShell.setAccessibleName" class="function">setAccessibleName</dd>
                <dd id="MainWindowShell.setAttribute" class="function">setAttribute</dd>
                <dd id="MainWindowShell.setAutoFillBackground" class="function">setAutoFillBackground</dd>
                <dd id="MainWindowShell.setBackgroundRole" class="function">setBackgroundRole</dd>
                <dd id="MainWindowShell.setBaseSize" class="function">setBaseSize</dd>
                <dd id="MainWindowShell.setContentsMargins" class="function">setContentsMargins</dd>
                <dd id="MainWindowShell.setContextMenuPolicy" class="function">setContextMenuPolicy</dd>
                <dd id="MainWindowShell.setCursor" class="function">setCursor</dd>
                <dd id="MainWindowShell.setDisabled" class="function">setDisabled</dd>
                <dd id="MainWindowShell.setEnabled" class="function">setEnabled</dd>
                <dd id="MainWindowShell.setFixedHeight" class="function">setFixedHeight</dd>
                <dd id="MainWindowShell.setFixedSize" class="function">setFixedSize</dd>
                <dd id="MainWindowShell.setFixedWidth" class="function">setFixedWidth</dd>
                <dd id="MainWindowShell.setFocus" class="function">setFocus</dd>
                <dd id="MainWindowShell.setFocusPolicy" class="function">setFocusPolicy</dd>
                <dd id="MainWindowShell.setFocusProxy" class="function">setFocusProxy</dd>
                <dd id="MainWindowShell.setFont" class="function">setFont</dd>
                <dd id="MainWindowShell.setForegroundRole" class="function">setForegroundRole</dd>
                <dd id="MainWindowShell.setGeometry" class="function">setGeometry</dd>
                <dd id="MainWindowShell.setGraphicsEffect" class="function">setGraphicsEffect</dd>
                <dd id="MainWindowShell.setHidden" class="function">setHidden</dd>
                <dd id="MainWindowShell.setInputMethodHints" class="function">setInputMethodHints</dd>
                <dd id="MainWindowShell.setLayout" class="function">setLayout</dd>
                <dd id="MainWindowShell.setLayoutDirection" class="function">setLayoutDirection</dd>
                <dd id="MainWindowShell.setLocale" class="function">setLocale</dd>
                <dd id="MainWindowShell.setMask" class="function">setMask</dd>
                <dd id="MainWindowShell.setMaximumHeight" class="function">setMaximumHeight</dd>
                <dd id="MainWindowShell.setMaximumSize" class="function">setMaximumSize</dd>
                <dd id="MainWindowShell.setMaximumWidth" class="function">setMaximumWidth</dd>
                <dd id="MainWindowShell.setMinimumHeight" class="function">setMinimumHeight</dd>
                <dd id="MainWindowShell.setMinimumSize" class="function">setMinimumSize</dd>
                <dd id="MainWindowShell.setMinimumWidth" class="function">setMinimumWidth</dd>
                <dd id="MainWindowShell.setMouseTracking" class="function">setMouseTracking</dd>
                <dd id="MainWindowShell.setPalette" class="function">setPalette</dd>
                <dd id="MainWindowShell.setParent" class="function">setParent</dd>
                <dd id="MainWindowShell.setShortcutAutoRepeat" class="function">setShortcutAutoRepeat</dd>
                <dd id="MainWindowShell.setShortcutEnabled" class="function">setShortcutEnabled</dd>
                <dd id="MainWindowShell.setSizeIncrement" class="function">setSizeIncrement</dd>
                <dd id="MainWindowShell.setSizePolicy" class="function">setSizePolicy</dd>
                <dd id="MainWindowShell.setStatusTip" class="function">setStatusTip</dd>
                <dd id="MainWindowShell.setStyle" class="function">setStyle</dd>
                <dd id="MainWindowShell.setStyleSheet" class="function">setStyleSheet</dd>
                <dd id="MainWindowShell.setTabOrder" class="function">setTabOrder</dd>
                <dd id="MainWindowShell.setTabletTracking" class="function">setTabletTracking</dd>
                <dd id="MainWindowShell.setToolTip" class="function">setToolTip</dd>
                <dd id="MainWindowShell.setToolTipDuration" class="function">setToolTipDuration</dd>
                <dd id="MainWindowShell.setUpdatesEnabled" class="function">setUpdatesEnabled</dd>
                <dd id="MainWindowShell.setVisible" class="function">setVisible</dd>
                <dd id="MainWindowShell.setWhatsThis" class="function">setWhatsThis</dd>
                <dd id="MainWindowShell.setWindowFilePath" class="function">setWindowFilePath</dd>
                <dd id="MainWindowShell.setWindowFlag" class="function">setWindowFlag</dd>
                <dd id="MainWindowShell.setWindowFlags" class="function">setWindowFlags</dd>
                <dd id="MainWindowShell.setWindowIcon" class="function">setWindowIcon</dd>
                <dd id="MainWindowShell.setWindowIconText" class="function">setWindowIconText</dd>
                <dd id="MainWindowShell.setWindowModality" class="function">setWindowModality</dd>
                <dd id="MainWindowShell.setWindowModified" class="function">setWindowModified</dd>
                <dd id="MainWindowShell.setWindowOpacity" class="function">setWindowOpacity</dd>
                <dd id="MainWindowShell.setWindowRole" class="function">setWindowRole</dd>
                <dd id="MainWindowShell.setWindowState" class="function">setWindowState</dd>
                <dd id="MainWindowShell.setWindowTitle" class="function">setWindowTitle</dd>
                <dd id="MainWindowShell.show" class="function">show</dd>
                <dd id="MainWindowShell.showFullScreen" class="function">showFullScreen</dd>
                <dd id="MainWindowShell.showMaximized" class="function">showMaximized</dd>
                <dd id="MainWindowShell.showMinimized" class="function">showMinimized</dd>
                <dd id="MainWindowShell.showNormal" class="function">showNormal</dd>
                <dd id="MainWindowShell.size" class="function">size</dd>
                <dd id="MainWindowShell.sizeHint" class="function">sizeHint</dd>
                <dd id="MainWindowShell.sizeIncrement" class="function">sizeIncrement</dd>
                <dd id="MainWindowShell.sizePolicy" class="function">sizePolicy</dd>
                <dd id="MainWindowShell.stackUnder" class="function">stackUnder</dd>
                <dd id="MainWindowShell.statusTip" class="function">statusTip</dd>
                <dd id="MainWindowShell.style" class="function">style</dd>
                <dd id="MainWindowShell.styleSheet" class="function">styleSheet</dd>
                <dd id="MainWindowShell.testAttribute" class="function">testAttribute</dd>
                <dd id="MainWindowShell.toolTip" class="function">toolTip</dd>
                <dd id="MainWindowShell.toolTipDuration" class="function">toolTipDuration</dd>
                <dd id="MainWindowShell.underMouse" class="function">underMouse</dd>
                <dd id="MainWindowShell.ungrabGesture" class="function">ungrabGesture</dd>
                <dd id="MainWindowShell.unsetCursor" class="function">unsetCursor</dd>
                <dd id="MainWindowShell.unsetLayoutDirection" class="function">unsetLayoutDirection</dd>
                <dd id="MainWindowShell.unsetLocale" class="function">unsetLocale</dd>
                <dd id="MainWindowShell.update" class="function">update</dd>
                <dd id="MainWindowShell.updateGeometry" class="function">updateGeometry</dd>
                <dd id="MainWindowShell.updatesEnabled" class="function">updatesEnabled</dd>
                <dd id="MainWindowShell.visibleRegion" class="function">visibleRegion</dd>
                <dd id="MainWindowShell.whatsThis" class="function">whatsThis</dd>
                <dd id="MainWindowShell.width" class="function">width</dd>
                <dd id="MainWindowShell.winId" class="function">winId</dd>
                <dd id="MainWindowShell.window" class="function">window</dd>
                <dd id="MainWindowShell.windowFilePath" class="function">windowFilePath</dd>
                <dd id="MainWindowShell.windowFlags" class="function">windowFlags</dd>
                <dd id="MainWindowShell.windowHandle" class="function">windowHandle</dd>
                <dd id="MainWindowShell.windowIcon" class="function">windowIcon</dd>
                <dd id="MainWindowShell.windowIconText" class="function">windowIconText</dd>
                <dd id="MainWindowShell.windowModality" class="function">windowModality</dd>
                <dd id="MainWindowShell.windowOpacity" class="function">windowOpacity</dd>
                <dd id="MainWindowShell.windowRole" class="function">windowRole</dd>
                <dd id="MainWindowShell.windowState" class="function">windowState</dd>
                <dd id="MainWindowShell.windowTitle" class="function">windowTitle</dd>
                <dd id="MainWindowShell.windowType" class="function">windowType</dd>
                <dd id="MainWindowShell.x" class="function">x</dd>
                <dd id="MainWindowShell.y" class="function">y</dd>
                <dd id="MainWindowShell.windowIconTextChanged" class="function">windowIconTextChanged</dd>
                <dd id="MainWindowShell.windowIconChanged" class="function">windowIconChanged</dd>
                <dd id="MainWindowShell.windowTitleChanged" class="function">windowTitleChanged</dd>
                <dd id="MainWindowShell.customContextMenuRequested" class="function">customContextMenuRequested</dd>

            </div>
            <div><dt>PyQt5.QtCore.QObject</dt>
                                <dd id="MainWindowShell.blockSignals" class="function">blockSignals</dd>
                <dd id="MainWindowShell.children" class="function">children</dd>
                <dd id="MainWindowShell.deleteLater" class="function">deleteLater</dd>
                <dd id="MainWindowShell.disconnect" class="function">disconnect</dd>
                <dd id="MainWindowShell.dumpObjectInfo" class="function">dumpObjectInfo</dd>
                <dd id="MainWindowShell.dumpObjectTree" class="function">dumpObjectTree</dd>
                <dd id="MainWindowShell.dynamicPropertyNames" class="function">dynamicPropertyNames</dd>
                <dd id="MainWindowShell.eventFilter" class="function">eventFilter</dd>
                <dd id="MainWindowShell.findChild" class="function">findChild</dd>
                <dd id="MainWindowShell.findChildren" class="function">findChildren</dd>
                <dd id="MainWindowShell.inherits" class="function">inherits</dd>
                <dd id="MainWindowShell.installEventFilter" class="function">installEventFilter</dd>
                <dd id="MainWindowShell.isWidgetType" class="function">isWidgetType</dd>
                <dd id="MainWindowShell.isWindowType" class="function">isWindowType</dd>
                <dd id="MainWindowShell.killTimer" class="function">killTimer</dd>
                <dd id="MainWindowShell.metaObject" class="function">metaObject</dd>
                <dd id="MainWindowShell.moveToThread" class="function">moveToThread</dd>
                <dd id="MainWindowShell.objectName" class="function">objectName</dd>
                <dd id="MainWindowShell.parent" class="function">parent</dd>
                <dd id="MainWindowShell.property" class="function">property</dd>
                <dd id="MainWindowShell.pyqtConfigure" class="function">pyqtConfigure</dd>
                <dd id="MainWindowShell.removeEventFilter" class="function">removeEventFilter</dd>
                <dd id="MainWindowShell.setObjectName" class="function">setObjectName</dd>
                <dd id="MainWindowShell.setProperty" class="function">setProperty</dd>
                <dd id="MainWindowShell.signalsBlocked" class="function">signalsBlocked</dd>
                <dd id="MainWindowShell.startTimer" class="function">startTimer</dd>
                <dd id="MainWindowShell.thread" class="function">thread</dd>
                <dd id="MainWindowShell.tr" class="function">tr</dd>
                <dd id="MainWindowShell.objectNameChanged" class="function">objectNameChanged</dd>
                <dd id="MainWindowShell.destroyed" class="function">destroyed</dd>

            </div>
            <div><dt>PyQt5.QtGui.QPaintDevice</dt>
                                <dd id="MainWindowShell.PaintDeviceMetric" class="class">PaintDeviceMetric</dd>
                <dd id="MainWindowShell.colorCount" class="function">colorCount</dd>
                <dd id="MainWindowShell.depth" class="function">depth</dd>
                <dd id="MainWindowShell.devicePixelRatio" class="function">devicePixelRatio</dd>
                <dd id="MainWindowShell.devicePixelRatioF" class="function">devicePixelRatioF</dd>
                <dd id="MainWindowShell.devicePixelRatioFScale" class="function">devicePixelRatioFScale</dd>
                <dd id="MainWindowShell.heightMM" class="function">heightMM</dd>
                <dd id="MainWindowShell.logicalDpiX" class="function">logicalDpiX</dd>
                <dd id="MainWindowShell.logicalDpiY" class="function">logicalDpiY</dd>
                <dd id="MainWindowShell.paintingActive" class="function">paintingActive</dd>
                <dd id="MainWindowShell.physicalDpiX" class="function">physicalDpiX</dd>
                <dd id="MainWindowShell.physicalDpiY" class="function">physicalDpiY</dd>
                <dd id="MainWindowShell.widthMM" class="function">widthMM</dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>